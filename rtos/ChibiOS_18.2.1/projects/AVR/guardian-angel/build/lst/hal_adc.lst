   1               		.file	"hal_adc.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.adcInit,"ax",@progbits
  11               	.global	adcInit
  13               	adcInit:
  14               	.LFB173:
  15               		.file 1 "../../../os/hal/src/hal_adc.c"
   1:../../../os/hal/src/hal_adc.c **** /*
   2:../../../os/hal/src/hal_adc.c ****     ChibiOS - Copyright (C) 2006..2018 Giovanni Di Sirio
   3:../../../os/hal/src/hal_adc.c **** 
   4:../../../os/hal/src/hal_adc.c ****     Licensed under the Apache License, Version 2.0 (the "License");
   5:../../../os/hal/src/hal_adc.c ****     you may not use this file except in compliance with the License.
   6:../../../os/hal/src/hal_adc.c ****     You may obtain a copy of the License at
   7:../../../os/hal/src/hal_adc.c **** 
   8:../../../os/hal/src/hal_adc.c ****         http://www.apache.org/licenses/LICENSE-2.0
   9:../../../os/hal/src/hal_adc.c **** 
  10:../../../os/hal/src/hal_adc.c ****     Unless required by applicable law or agreed to in writing, software
  11:../../../os/hal/src/hal_adc.c ****     distributed under the License is distributed on an "AS IS" BASIS,
  12:../../../os/hal/src/hal_adc.c ****     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  13:../../../os/hal/src/hal_adc.c ****     See the License for the specific language governing permissions and
  14:../../../os/hal/src/hal_adc.c ****     limitations under the License.
  15:../../../os/hal/src/hal_adc.c **** */
  16:../../../os/hal/src/hal_adc.c **** 
  17:../../../os/hal/src/hal_adc.c **** /**
  18:../../../os/hal/src/hal_adc.c ****  * @file    hal_adc.c
  19:../../../os/hal/src/hal_adc.c ****  * @brief   ADC Driver code.
  20:../../../os/hal/src/hal_adc.c ****  *
  21:../../../os/hal/src/hal_adc.c ****  * @addtogroup ADC
  22:../../../os/hal/src/hal_adc.c ****  * @{
  23:../../../os/hal/src/hal_adc.c ****  */
  24:../../../os/hal/src/hal_adc.c **** 
  25:../../../os/hal/src/hal_adc.c **** #include "hal.h"
  26:../../../os/hal/src/hal_adc.c **** 
  27:../../../os/hal/src/hal_adc.c **** #if (HAL_USE_ADC == TRUE) || defined(__DOXYGEN__)
  28:../../../os/hal/src/hal_adc.c **** 
  29:../../../os/hal/src/hal_adc.c **** /*===========================================================================*/
  30:../../../os/hal/src/hal_adc.c **** /* Driver local definitions.                                                 */
  31:../../../os/hal/src/hal_adc.c **** /*===========================================================================*/
  32:../../../os/hal/src/hal_adc.c **** 
  33:../../../os/hal/src/hal_adc.c **** /*===========================================================================*/
  34:../../../os/hal/src/hal_adc.c **** /* Driver exported variables.                                                */
  35:../../../os/hal/src/hal_adc.c **** /*===========================================================================*/
  36:../../../os/hal/src/hal_adc.c **** 
  37:../../../os/hal/src/hal_adc.c **** /*===========================================================================*/
  38:../../../os/hal/src/hal_adc.c **** /* Driver local variables and types.                                         */
  39:../../../os/hal/src/hal_adc.c **** /*===========================================================================*/
  40:../../../os/hal/src/hal_adc.c **** 
  41:../../../os/hal/src/hal_adc.c **** /*===========================================================================*/
  42:../../../os/hal/src/hal_adc.c **** /* Driver local functions.                                                   */
  43:../../../os/hal/src/hal_adc.c **** /*===========================================================================*/
  44:../../../os/hal/src/hal_adc.c **** 
  45:../../../os/hal/src/hal_adc.c **** /*===========================================================================*/
  46:../../../os/hal/src/hal_adc.c **** /* Driver exported functions.                                                */
  47:../../../os/hal/src/hal_adc.c **** /*===========================================================================*/
  48:../../../os/hal/src/hal_adc.c **** 
  49:../../../os/hal/src/hal_adc.c **** /**
  50:../../../os/hal/src/hal_adc.c ****  * @brief   ADC Driver initialization.
  51:../../../os/hal/src/hal_adc.c ****  * @note    This function is implicitly invoked by @p halInit(), there is
  52:../../../os/hal/src/hal_adc.c ****  *          no need to explicitly initialize the driver.
  53:../../../os/hal/src/hal_adc.c ****  *
  54:../../../os/hal/src/hal_adc.c ****  * @init
  55:../../../os/hal/src/hal_adc.c ****  */
  56:../../../os/hal/src/hal_adc.c **** void adcInit(void) {
  16               		.loc 1 56 20 view -0
  17               		.cfi_startproc
  18               	/* prologue: function */
  19               	/* frame size = 0 */
  20               	/* stack size = 0 */
  21               	.L__stack_usage = 0
  57:../../../os/hal/src/hal_adc.c **** 
  58:../../../os/hal/src/hal_adc.c ****   adc_lld_init();
  22               		.loc 1 58 3 view .LVU1
  23 0000 0C94 0000 		jmp adc_lld_init
  24               	.LVL0:
  25               		.cfi_endproc
  26               	.LFE173:
  28               		.section	.text.adcObjectInit,"ax",@progbits
  29               	.global	adcObjectInit
  31               	adcObjectInit:
  32               	.LVL1:
  33               	.LFB174:
  59:../../../os/hal/src/hal_adc.c **** }
  60:../../../os/hal/src/hal_adc.c **** 
  61:../../../os/hal/src/hal_adc.c **** /**
  62:../../../os/hal/src/hal_adc.c ****  * @brief   Initializes the standard part of a @p ADCDriver structure.
  63:../../../os/hal/src/hal_adc.c ****  *
  64:../../../os/hal/src/hal_adc.c ****  * @param[out] adcp     pointer to the @p ADCDriver object
  65:../../../os/hal/src/hal_adc.c ****  *
  66:../../../os/hal/src/hal_adc.c ****  * @init
  67:../../../os/hal/src/hal_adc.c ****  */
  68:../../../os/hal/src/hal_adc.c **** void adcObjectInit(ADCDriver *adcp) {
  34               		.loc 1 68 37 view -0
  35               		.cfi_startproc
  36               	/* prologue: function */
  37               	/* frame size = 0 */
  38               	/* stack size = 0 */
  39               	.L__stack_usage = 0
  40               		.loc 1 68 37 is_stmt 0 view .LVU3
  41 0000 FC01      		movw r30,r24
  69:../../../os/hal/src/hal_adc.c **** 
  70:../../../os/hal/src/hal_adc.c ****   adcp->state    = ADC_STOP;
  42               		.loc 1 70 3 is_stmt 1 view .LVU4
  43               		.loc 1 70 18 is_stmt 0 view .LVU5
  44 0002 81E0      		ldi r24,lo8(1)
  45               	.LVL2:
  46               		.loc 1 70 18 view .LVU6
  47 0004 8083      		st Z,r24
  71:../../../os/hal/src/hal_adc.c ****   adcp->config   = NULL;
  48               		.loc 1 71 3 is_stmt 1 view .LVU7
  49               		.loc 1 71 18 is_stmt 0 view .LVU8
  50 0006 1282      		std Z+2,__zero_reg__
  51 0008 1182      		std Z+1,__zero_reg__
  72:../../../os/hal/src/hal_adc.c ****   adcp->samples  = NULL;
  52               		.loc 1 72 3 is_stmt 1 view .LVU9
  53               		.loc 1 72 18 is_stmt 0 view .LVU10
  54 000a 1482      		std Z+4,__zero_reg__
  55 000c 1382      		std Z+3,__zero_reg__
  73:../../../os/hal/src/hal_adc.c ****   adcp->depth    = 0;
  56               		.loc 1 73 3 is_stmt 1 view .LVU11
  57               		.loc 1 73 18 is_stmt 0 view .LVU12
  58 000e 1682      		std Z+6,__zero_reg__
  59 0010 1582      		std Z+5,__zero_reg__
  74:../../../os/hal/src/hal_adc.c ****   adcp->grpp     = NULL;
  60               		.loc 1 74 3 is_stmt 1 view .LVU13
  61               		.loc 1 74 18 is_stmt 0 view .LVU14
  62 0012 1086      		std Z+8,__zero_reg__
  63 0014 1782      		std Z+7,__zero_reg__
  75:../../../os/hal/src/hal_adc.c **** #if ADC_USE_WAIT == TRUE
  76:../../../os/hal/src/hal_adc.c ****   adcp->thread   = NULL;
  64               		.loc 1 76 3 is_stmt 1 view .LVU15
  65               		.loc 1 76 18 is_stmt 0 view .LVU16
  66 0016 1286      		std Z+10,__zero_reg__
  67 0018 1186      		std Z+9,__zero_reg__
  77:../../../os/hal/src/hal_adc.c **** #endif
  78:../../../os/hal/src/hal_adc.c **** #if ADC_USE_MUTUAL_EXCLUSION == TRUE
  79:../../../os/hal/src/hal_adc.c ****   osalMutexObjectInit(&adcp->mutex);
  68               		.loc 1 79 3 is_stmt 1 view .LVU17
  69               	.LVL3:
  70               	.LBB85:
  71               	.LBI85:
  72               		.file 2 "../../../os/hal/osal/rt/osal.h"
   1:../../../os/hal/osal/rt/osal.h **** /*
   2:../../../os/hal/osal/rt/osal.h ****     ChibiOS - Copyright (C) 2006..2018 Giovanni Di Sirio
   3:../../../os/hal/osal/rt/osal.h **** 
   4:../../../os/hal/osal/rt/osal.h ****     Licensed under the Apache License, Version 2.0 (the "License");
   5:../../../os/hal/osal/rt/osal.h ****     you may not use this file except in compliance with the License.
   6:../../../os/hal/osal/rt/osal.h ****     You may obtain a copy of the License at
   7:../../../os/hal/osal/rt/osal.h **** 
   8:../../../os/hal/osal/rt/osal.h ****         http://www.apache.org/licenses/LICENSE-2.0
   9:../../../os/hal/osal/rt/osal.h **** 
  10:../../../os/hal/osal/rt/osal.h ****     Unless required by applicable law or agreed to in writing, software
  11:../../../os/hal/osal/rt/osal.h ****     distributed under the License is distributed on an "AS IS" BASIS,
  12:../../../os/hal/osal/rt/osal.h ****     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  13:../../../os/hal/osal/rt/osal.h ****     See the License for the specific language governing permissions and
  14:../../../os/hal/osal/rt/osal.h ****     limitations under the License.
  15:../../../os/hal/osal/rt/osal.h **** */
  16:../../../os/hal/osal/rt/osal.h **** 
  17:../../../os/hal/osal/rt/osal.h **** /**
  18:../../../os/hal/osal/rt/osal.h ****  * @file    osal.h
  19:../../../os/hal/osal/rt/osal.h ****  * @brief   OSAL module header.
  20:../../../os/hal/osal/rt/osal.h ****  *
  21:../../../os/hal/osal/rt/osal.h ****  * @addtogroup OSAL
  22:../../../os/hal/osal/rt/osal.h ****  * @{
  23:../../../os/hal/osal/rt/osal.h ****  */
  24:../../../os/hal/osal/rt/osal.h **** 
  25:../../../os/hal/osal/rt/osal.h **** #ifndef OSAL_H
  26:../../../os/hal/osal/rt/osal.h **** #define OSAL_H
  27:../../../os/hal/osal/rt/osal.h **** 
  28:../../../os/hal/osal/rt/osal.h **** #include <stddef.h>
  29:../../../os/hal/osal/rt/osal.h **** #include <stdint.h>
  30:../../../os/hal/osal/rt/osal.h **** #include <stdbool.h>
  31:../../../os/hal/osal/rt/osal.h **** 
  32:../../../os/hal/osal/rt/osal.h **** #include "ch.h"
  33:../../../os/hal/osal/rt/osal.h **** 
  34:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
  35:../../../os/hal/osal/rt/osal.h **** /* Module constants.                                                         */
  36:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
  37:../../../os/hal/osal/rt/osal.h **** 
  38:../../../os/hal/osal/rt/osal.h **** /**
  39:../../../os/hal/osal/rt/osal.h ****  * @name    Common constants
  40:../../../os/hal/osal/rt/osal.h ****  * @{
  41:../../../os/hal/osal/rt/osal.h ****  */
  42:../../../os/hal/osal/rt/osal.h **** #if !defined(FALSE) || defined(__DOXYGEN__)
  43:../../../os/hal/osal/rt/osal.h **** #define FALSE                               0
  44:../../../os/hal/osal/rt/osal.h **** #endif
  45:../../../os/hal/osal/rt/osal.h **** 
  46:../../../os/hal/osal/rt/osal.h **** #if !defined(TRUE) || defined(__DOXYGEN__)
  47:../../../os/hal/osal/rt/osal.h **** #define TRUE                                1
  48:../../../os/hal/osal/rt/osal.h **** #endif
  49:../../../os/hal/osal/rt/osal.h **** 
  50:../../../os/hal/osal/rt/osal.h **** #define OSAL_SUCCESS                        false
  51:../../../os/hal/osal/rt/osal.h **** #define OSAL_FAILED                         true
  52:../../../os/hal/osal/rt/osal.h **** /** @} */
  53:../../../os/hal/osal/rt/osal.h **** 
  54:../../../os/hal/osal/rt/osal.h **** #if 0
  55:../../../os/hal/osal/rt/osal.h **** /**
  56:../../../os/hal/osal/rt/osal.h ****  * @name    Messages
  57:../../../os/hal/osal/rt/osal.h ****  * @{
  58:../../../os/hal/osal/rt/osal.h ****  */
  59:../../../os/hal/osal/rt/osal.h **** #define MSG_OK                              (msg_t)0
  60:../../../os/hal/osal/rt/osal.h **** #define MSG_TIMEOUT                         (msg_t)-1
  61:../../../os/hal/osal/rt/osal.h **** #define MSG_RESET                           (msg_t)-2
  62:../../../os/hal/osal/rt/osal.h **** /** @} */
  63:../../../os/hal/osal/rt/osal.h **** #endif
  64:../../../os/hal/osal/rt/osal.h **** 
  65:../../../os/hal/osal/rt/osal.h **** #if 0
  66:../../../os/hal/osal/rt/osal.h **** /**
  67:../../../os/hal/osal/rt/osal.h ****  * @name    Special time constants
  68:../../../os/hal/osal/rt/osal.h ****  * @{
  69:../../../os/hal/osal/rt/osal.h ****  */
  70:../../../os/hal/osal/rt/osal.h **** #define TIME_IMMEDIATE                      ((sysinterval_t)0)
  71:../../../os/hal/osal/rt/osal.h **** #define TIME_INFINITE                       ((sysinterval_t)-1)
  72:../../../os/hal/osal/rt/osal.h **** /** @} */
  73:../../../os/hal/osal/rt/osal.h **** #endif
  74:../../../os/hal/osal/rt/osal.h **** 
  75:../../../os/hal/osal/rt/osal.h **** /**
  76:../../../os/hal/osal/rt/osal.h ****  * @name    Systick modes.
  77:../../../os/hal/osal/rt/osal.h ****  * @{
  78:../../../os/hal/osal/rt/osal.h ****  */
  79:../../../os/hal/osal/rt/osal.h **** #define OSAL_ST_MODE_NONE                   0
  80:../../../os/hal/osal/rt/osal.h **** #define OSAL_ST_MODE_PERIODIC               1
  81:../../../os/hal/osal/rt/osal.h **** #define OSAL_ST_MODE_FREERUNNING            2
  82:../../../os/hal/osal/rt/osal.h **** /** @} */
  83:../../../os/hal/osal/rt/osal.h **** 
  84:../../../os/hal/osal/rt/osal.h **** /**
  85:../../../os/hal/osal/rt/osal.h ****  * @name    Systick parameters.
  86:../../../os/hal/osal/rt/osal.h ****  * @{
  87:../../../os/hal/osal/rt/osal.h ****  */
  88:../../../os/hal/osal/rt/osal.h **** /**
  89:../../../os/hal/osal/rt/osal.h ****  * @brief   Size in bits of the @p systick_t type.
  90:../../../os/hal/osal/rt/osal.h ****  */
  91:../../../os/hal/osal/rt/osal.h **** #define OSAL_ST_RESOLUTION                  CH_CFG_ST_RESOLUTION
  92:../../../os/hal/osal/rt/osal.h **** 
  93:../../../os/hal/osal/rt/osal.h **** /**
  94:../../../os/hal/osal/rt/osal.h ****  * @brief   Required systick frequency or resolution.
  95:../../../os/hal/osal/rt/osal.h ****  */
  96:../../../os/hal/osal/rt/osal.h **** #define OSAL_ST_FREQUENCY                   CH_CFG_ST_FREQUENCY
  97:../../../os/hal/osal/rt/osal.h **** 
  98:../../../os/hal/osal/rt/osal.h **** /**
  99:../../../os/hal/osal/rt/osal.h ****  * @brief   Systick mode required by the underlying OS.
 100:../../../os/hal/osal/rt/osal.h ****  */
 101:../../../os/hal/osal/rt/osal.h **** #if (CH_CFG_ST_TIMEDELTA == 0) || defined(__DOXYGEN__)
 102:../../../os/hal/osal/rt/osal.h **** #define OSAL_ST_MODE                        OSAL_ST_MODE_PERIODIC
 103:../../../os/hal/osal/rt/osal.h **** #else
 104:../../../os/hal/osal/rt/osal.h **** #define OSAL_ST_MODE                        OSAL_ST_MODE_FREERUNNING
 105:../../../os/hal/osal/rt/osal.h **** #endif
 106:../../../os/hal/osal/rt/osal.h **** /** @} */
 107:../../../os/hal/osal/rt/osal.h **** 
 108:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
 109:../../../os/hal/osal/rt/osal.h **** /* Module pre-compile time settings.                                         */
 110:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
 111:../../../os/hal/osal/rt/osal.h **** 
 112:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
 113:../../../os/hal/osal/rt/osal.h **** /* Derived constants and error checks.                                       */
 114:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
 115:../../../os/hal/osal/rt/osal.h **** 
 116:../../../os/hal/osal/rt/osal.h **** #if !(OSAL_ST_MODE == OSAL_ST_MODE_NONE) &&                                 \
 117:../../../os/hal/osal/rt/osal.h ****     !(OSAL_ST_MODE == OSAL_ST_MODE_PERIODIC) &&                             \
 118:../../../os/hal/osal/rt/osal.h ****     !(OSAL_ST_MODE == OSAL_ST_MODE_FREERUNNING)
 119:../../../os/hal/osal/rt/osal.h **** #error "invalid OSAL_ST_MODE setting in osal.h"
 120:../../../os/hal/osal/rt/osal.h **** #endif
 121:../../../os/hal/osal/rt/osal.h **** 
 122:../../../os/hal/osal/rt/osal.h **** #if (OSAL_ST_RESOLUTION != 16) && (OSAL_ST_RESOLUTION != 32)
 123:../../../os/hal/osal/rt/osal.h **** #error "invalid OSAL_ST_RESOLUTION, must be 16 or 32"
 124:../../../os/hal/osal/rt/osal.h **** #endif
 125:../../../os/hal/osal/rt/osal.h **** 
 126:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
 127:../../../os/hal/osal/rt/osal.h **** /* Module data structures and types.                                         */
 128:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
 129:../../../os/hal/osal/rt/osal.h **** 
 130:../../../os/hal/osal/rt/osal.h **** #if 0
 131:../../../os/hal/osal/rt/osal.h **** /**
 132:../../../os/hal/osal/rt/osal.h ****  * @brief   Type of a system status word.
 133:../../../os/hal/osal/rt/osal.h ****  */
 134:../../../os/hal/osal/rt/osal.h **** typedef uint32_t syssts_t;
 135:../../../os/hal/osal/rt/osal.h **** #endif
 136:../../../os/hal/osal/rt/osal.h **** 
 137:../../../os/hal/osal/rt/osal.h **** #if 0
 138:../../../os/hal/osal/rt/osal.h **** /**
 139:../../../os/hal/osal/rt/osal.h ****  * @brief   Type of a message.
 140:../../../os/hal/osal/rt/osal.h ****  */
 141:../../../os/hal/osal/rt/osal.h **** typedef int32_t msg_t;
 142:../../../os/hal/osal/rt/osal.h **** #endif
 143:../../../os/hal/osal/rt/osal.h **** 
 144:../../../os/hal/osal/rt/osal.h **** #if 0
 145:../../../os/hal/osal/rt/osal.h **** /**
 146:../../../os/hal/osal/rt/osal.h ****  * @brief   Type of system time counter.
 147:../../../os/hal/osal/rt/osal.h ****  */
 148:../../../os/hal/osal/rt/osal.h **** typedef uint32_t systime_t;
 149:../../../os/hal/osal/rt/osal.h **** #endif
 150:../../../os/hal/osal/rt/osal.h **** 
 151:../../../os/hal/osal/rt/osal.h **** #if 0
 152:../../../os/hal/osal/rt/osal.h **** /**
 153:../../../os/hal/osal/rt/osal.h ****  * @brief   Type of system time interval.
 154:../../../os/hal/osal/rt/osal.h ****  */
 155:../../../os/hal/osal/rt/osal.h **** typedef uint32_t sysinterval_t;
 156:../../../os/hal/osal/rt/osal.h **** #endif
 157:../../../os/hal/osal/rt/osal.h **** 
 158:../../../os/hal/osal/rt/osal.h **** #if 0
 159:../../../os/hal/osal/rt/osal.h **** /**
 160:../../../os/hal/osal/rt/osal.h ****  * @brief   Type of realtime counter.
 161:../../../os/hal/osal/rt/osal.h ****  */
 162:../../../os/hal/osal/rt/osal.h **** typedef uint32_t rtcnt_t;
 163:../../../os/hal/osal/rt/osal.h **** #endif
 164:../../../os/hal/osal/rt/osal.h **** 
 165:../../../os/hal/osal/rt/osal.h **** #if 0
 166:../../../os/hal/osal/rt/osal.h **** /**
 167:../../../os/hal/osal/rt/osal.h ****  * @brief   Type of a thread reference.
 168:../../../os/hal/osal/rt/osal.h ****  */
 169:../../../os/hal/osal/rt/osal.h **** typedef thread_t * thread_reference_t;
 170:../../../os/hal/osal/rt/osal.h **** #endif
 171:../../../os/hal/osal/rt/osal.h **** 
 172:../../../os/hal/osal/rt/osal.h **** #if 0
 173:../../../os/hal/osal/rt/osal.h **** /**
 174:../../../os/hal/osal/rt/osal.h ****  * @brief   Type of an event flags mask.
 175:../../../os/hal/osal/rt/osal.h ****  */
 176:../../../os/hal/osal/rt/osal.h **** typedef uint32_t eventflags_t;
 177:../../../os/hal/osal/rt/osal.h **** #endif
 178:../../../os/hal/osal/rt/osal.h **** 
 179:../../../os/hal/osal/rt/osal.h **** #if (CH_CFG_USE_EVENTS == FALSE) || defined(__DOXYGEN__)
 180:../../../os/hal/osal/rt/osal.h **** /**
 181:../../../os/hal/osal/rt/osal.h ****  * @brief   Type of an event flags object.
 182:../../../os/hal/osal/rt/osal.h ****  * @note    The content of this structure is not part of the API and should
 183:../../../os/hal/osal/rt/osal.h ****  *          not be relied upon. Implementers may define this structure in
 184:../../../os/hal/osal/rt/osal.h ****  *          an entirely different way.
 185:../../../os/hal/osal/rt/osal.h ****  * @note    Retrieval and clearing of the flags are not defined in this
 186:../../../os/hal/osal/rt/osal.h ****  *          API and are implementation-dependent.
 187:../../../os/hal/osal/rt/osal.h ****  */
 188:../../../os/hal/osal/rt/osal.h **** typedef struct event_source event_source_t;
 189:../../../os/hal/osal/rt/osal.h **** 
 190:../../../os/hal/osal/rt/osal.h **** /**
 191:../../../os/hal/osal/rt/osal.h ****  * @brief   Type of an event source callback.
 192:../../../os/hal/osal/rt/osal.h ****  * @note    This type is not part of the OSAL API and is provided
 193:../../../os/hal/osal/rt/osal.h ****  *          exclusively as an example and for convenience.
 194:../../../os/hal/osal/rt/osal.h ****  */
 195:../../../os/hal/osal/rt/osal.h **** typedef void (*eventcallback_t)(event_source_t *esp);
 196:../../../os/hal/osal/rt/osal.h **** 
 197:../../../os/hal/osal/rt/osal.h **** /**
 198:../../../os/hal/osal/rt/osal.h ****  * @brief   Events source object.
 199:../../../os/hal/osal/rt/osal.h ****  * @note    The content of this structure is not part of the API and should
 200:../../../os/hal/osal/rt/osal.h ****  *          not be relied upon. Implementers may define this structure in
 201:../../../os/hal/osal/rt/osal.h ****  *          an entirely different way.
 202:../../../os/hal/osal/rt/osal.h ****  * @note    Retrieval and clearing of the flags are not defined in this
 203:../../../os/hal/osal/rt/osal.h ****  *          API and are implementation-dependent.
 204:../../../os/hal/osal/rt/osal.h ****  */
 205:../../../os/hal/osal/rt/osal.h **** struct event_source {
 206:../../../os/hal/osal/rt/osal.h ****   volatile eventflags_t flags;      /**< @brief Stored event flags.         */
 207:../../../os/hal/osal/rt/osal.h ****   eventcallback_t       cb;         /**< @brief Event source callback.      */
 208:../../../os/hal/osal/rt/osal.h ****   void                  *param;     /**< @brief User defined field.         */
 209:../../../os/hal/osal/rt/osal.h **** };
 210:../../../os/hal/osal/rt/osal.h **** #endif /* CH_CFG_USE_EVENTS == FALSE */
 211:../../../os/hal/osal/rt/osal.h **** 
 212:../../../os/hal/osal/rt/osal.h **** /**
 213:../../../os/hal/osal/rt/osal.h ****  * @brief   Type of a mutex.
 214:../../../os/hal/osal/rt/osal.h ****  * @note    If the OS does not support mutexes or there is no OS then the
 215:../../../os/hal/osal/rt/osal.h ****  *          mechanism can be simulated.
 216:../../../os/hal/osal/rt/osal.h ****  */
 217:../../../os/hal/osal/rt/osal.h **** #if CH_CFG_USE_MUTEXES || defined(__DOXYGEN__)
 218:../../../os/hal/osal/rt/osal.h **** #elif CH_CFG_USE_SEMAPHORES
 219:../../../os/hal/osal/rt/osal.h **** typedef semaphore_t mutex_t;
 220:../../../os/hal/osal/rt/osal.h **** #else
 221:../../../os/hal/osal/rt/osal.h **** typedef uint32_t mutex_t;
 222:../../../os/hal/osal/rt/osal.h **** #endif
 223:../../../os/hal/osal/rt/osal.h **** 
 224:../../../os/hal/osal/rt/osal.h **** #if 0
 225:../../../os/hal/osal/rt/osal.h **** /**
 226:../../../os/hal/osal/rt/osal.h ****  * @brief   Type of a thread queue.
 227:../../../os/hal/osal/rt/osal.h ****  * @details A thread queue is a queue of sleeping threads, queued threads
 228:../../../os/hal/osal/rt/osal.h ****  *          can be dequeued one at time or all together.
 229:../../../os/hal/osal/rt/osal.h ****  * @note    In this implementation it is implemented as a single reference
 230:../../../os/hal/osal/rt/osal.h ****  *          because there are no real threads.
 231:../../../os/hal/osal/rt/osal.h ****  */
 232:../../../os/hal/osal/rt/osal.h **** typedef struct {
 233:../../../os/hal/osal/rt/osal.h ****   thread_reference_t    tr;
 234:../../../os/hal/osal/rt/osal.h **** } threads_queue_t;
 235:../../../os/hal/osal/rt/osal.h **** #endif
 236:../../../os/hal/osal/rt/osal.h **** 
 237:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
 238:../../../os/hal/osal/rt/osal.h **** /* Module macros.                                                            */
 239:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
 240:../../../os/hal/osal/rt/osal.h **** 
 241:../../../os/hal/osal/rt/osal.h **** /**
 242:../../../os/hal/osal/rt/osal.h ****  * @name    Debug related macros
 243:../../../os/hal/osal/rt/osal.h ****  * @{
 244:../../../os/hal/osal/rt/osal.h ****  */
 245:../../../os/hal/osal/rt/osal.h **** /**
 246:../../../os/hal/osal/rt/osal.h ****  * @brief   Condition assertion.
 247:../../../os/hal/osal/rt/osal.h ****  * @details If the condition check fails then the OSAL panics with a
 248:../../../os/hal/osal/rt/osal.h ****  *          message and halts.
 249:../../../os/hal/osal/rt/osal.h ****  * @note    The condition is tested only if the @p OSAL_ENABLE_ASSERTIONS
 250:../../../os/hal/osal/rt/osal.h ****  *          switch is enabled.
 251:../../../os/hal/osal/rt/osal.h ****  * @note    The remark string is not currently used except for putting a
 252:../../../os/hal/osal/rt/osal.h ****  *          comment in the code about the assertion.
 253:../../../os/hal/osal/rt/osal.h ****  *
 254:../../../os/hal/osal/rt/osal.h ****  * @param[in] c         the condition to be verified to be true
 255:../../../os/hal/osal/rt/osal.h ****  * @param[in] remark    a remark string
 256:../../../os/hal/osal/rt/osal.h ****  *
 257:../../../os/hal/osal/rt/osal.h ****  * @api
 258:../../../os/hal/osal/rt/osal.h ****  */
 259:../../../os/hal/osal/rt/osal.h **** #define osalDbgAssert(c, remark) chDbgAssert(c, remark)
 260:../../../os/hal/osal/rt/osal.h **** 
 261:../../../os/hal/osal/rt/osal.h **** /**
 262:../../../os/hal/osal/rt/osal.h ****  * @brief   Function parameters check.
 263:../../../os/hal/osal/rt/osal.h ****  * @details If the condition check fails then the OSAL panics and halts.
 264:../../../os/hal/osal/rt/osal.h ****  * @note    The condition is tested only if the @p OSAL_ENABLE_CHECKS switch
 265:../../../os/hal/osal/rt/osal.h ****  *          is enabled.
 266:../../../os/hal/osal/rt/osal.h ****  *
 267:../../../os/hal/osal/rt/osal.h ****  * @param[in] c         the condition to be verified to be true
 268:../../../os/hal/osal/rt/osal.h ****  *
 269:../../../os/hal/osal/rt/osal.h ****  * @api
 270:../../../os/hal/osal/rt/osal.h ****  */
 271:../../../os/hal/osal/rt/osal.h **** #define osalDbgCheck(c) chDbgCheck(c)
 272:../../../os/hal/osal/rt/osal.h **** 
 273:../../../os/hal/osal/rt/osal.h **** /**
 274:../../../os/hal/osal/rt/osal.h ****  * @brief   I-Class state check.
 275:../../../os/hal/osal/rt/osal.h ****  * @note    Not implemented in this simplified OSAL.
 276:../../../os/hal/osal/rt/osal.h ****  */
 277:../../../os/hal/osal/rt/osal.h **** #define osalDbgCheckClassI() chDbgCheckClassI()
 278:../../../os/hal/osal/rt/osal.h **** 
 279:../../../os/hal/osal/rt/osal.h **** /**
 280:../../../os/hal/osal/rt/osal.h ****  * @brief   S-Class state check.
 281:../../../os/hal/osal/rt/osal.h ****  * @note    Not implemented in this simplified OSAL.
 282:../../../os/hal/osal/rt/osal.h ****  */
 283:../../../os/hal/osal/rt/osal.h **** #define osalDbgCheckClassS() chDbgCheckClassS()
 284:../../../os/hal/osal/rt/osal.h **** /** @} */
 285:../../../os/hal/osal/rt/osal.h **** 
 286:../../../os/hal/osal/rt/osal.h **** /**
 287:../../../os/hal/osal/rt/osal.h ****  * @name    IRQ service routines wrappers
 288:../../../os/hal/osal/rt/osal.h ****  * @{
 289:../../../os/hal/osal/rt/osal.h ****  */
 290:../../../os/hal/osal/rt/osal.h **** /**
 291:../../../os/hal/osal/rt/osal.h ****  * @brief   Priority level verification macro.
 292:../../../os/hal/osal/rt/osal.h ****  */
 293:../../../os/hal/osal/rt/osal.h **** #define OSAL_IRQ_IS_VALID_PRIORITY(n) CH_IRQ_IS_VALID_KERNEL_PRIORITY(n)
 294:../../../os/hal/osal/rt/osal.h **** 
 295:../../../os/hal/osal/rt/osal.h **** /**
 296:../../../os/hal/osal/rt/osal.h ****  * @brief   IRQ prologue code.
 297:../../../os/hal/osal/rt/osal.h ****  * @details This macro must be inserted at the start of all IRQ handlers.
 298:../../../os/hal/osal/rt/osal.h ****  */
 299:../../../os/hal/osal/rt/osal.h **** #define OSAL_IRQ_PROLOGUE() CH_IRQ_PROLOGUE()
 300:../../../os/hal/osal/rt/osal.h **** 
 301:../../../os/hal/osal/rt/osal.h **** /**
 302:../../../os/hal/osal/rt/osal.h ****  * @brief   IRQ epilogue code.
 303:../../../os/hal/osal/rt/osal.h ****  * @details This macro must be inserted at the end of all IRQ handlers.
 304:../../../os/hal/osal/rt/osal.h ****  */
 305:../../../os/hal/osal/rt/osal.h **** #define OSAL_IRQ_EPILOGUE() CH_IRQ_EPILOGUE()
 306:../../../os/hal/osal/rt/osal.h **** 
 307:../../../os/hal/osal/rt/osal.h **** /**
 308:../../../os/hal/osal/rt/osal.h ****  * @brief   IRQ handler function declaration.
 309:../../../os/hal/osal/rt/osal.h ****  * @details This macro hides the details of an ISR function declaration.
 310:../../../os/hal/osal/rt/osal.h ****  *
 311:../../../os/hal/osal/rt/osal.h ****  * @param[in] id        a vector name as defined in @p vectors.s
 312:../../../os/hal/osal/rt/osal.h ****  */
 313:../../../os/hal/osal/rt/osal.h **** #define OSAL_IRQ_HANDLER(id) CH_IRQ_HANDLER(id)
 314:../../../os/hal/osal/rt/osal.h **** /** @} */
 315:../../../os/hal/osal/rt/osal.h **** 
 316:../../../os/hal/osal/rt/osal.h **** /**
 317:../../../os/hal/osal/rt/osal.h ****  * @name    Time conversion utilities
 318:../../../os/hal/osal/rt/osal.h ****  * @{
 319:../../../os/hal/osal/rt/osal.h ****  */
 320:../../../os/hal/osal/rt/osal.h **** /**
 321:../../../os/hal/osal/rt/osal.h ****  * @brief   Seconds to system ticks.
 322:../../../os/hal/osal/rt/osal.h ****  * @details Converts from seconds to system ticks number.
 323:../../../os/hal/osal/rt/osal.h ****  * @note    The result is rounded upward to the next tick boundary.
 324:../../../os/hal/osal/rt/osal.h ****  *
 325:../../../os/hal/osal/rt/osal.h ****  * @param[in] secs      number of seconds
 326:../../../os/hal/osal/rt/osal.h ****  * @return              The number of ticks.
 327:../../../os/hal/osal/rt/osal.h ****  *
 328:../../../os/hal/osal/rt/osal.h ****  * @api
 329:../../../os/hal/osal/rt/osal.h ****  */
 330:../../../os/hal/osal/rt/osal.h **** #define OSAL_S2I(secs) TIME_S2I(secs)
 331:../../../os/hal/osal/rt/osal.h **** 
 332:../../../os/hal/osal/rt/osal.h **** /**
 333:../../../os/hal/osal/rt/osal.h ****  * @brief   Milliseconds to system ticks.
 334:../../../os/hal/osal/rt/osal.h ****  * @details Converts from milliseconds to system ticks number.
 335:../../../os/hal/osal/rt/osal.h ****  * @note    The result is rounded upward to the next tick boundary.
 336:../../../os/hal/osal/rt/osal.h ****  *
 337:../../../os/hal/osal/rt/osal.h ****  * @param[in] msecs     number of milliseconds
 338:../../../os/hal/osal/rt/osal.h ****  * @return              The number of ticks.
 339:../../../os/hal/osal/rt/osal.h ****  *
 340:../../../os/hal/osal/rt/osal.h ****  * @api
 341:../../../os/hal/osal/rt/osal.h ****  */
 342:../../../os/hal/osal/rt/osal.h **** #define OSAL_MS2I(msecs) TIME_MS2I(msecs)
 343:../../../os/hal/osal/rt/osal.h **** 
 344:../../../os/hal/osal/rt/osal.h **** /**
 345:../../../os/hal/osal/rt/osal.h ****  * @brief   Microseconds to system ticks.
 346:../../../os/hal/osal/rt/osal.h ****  * @details Converts from microseconds to system ticks number.
 347:../../../os/hal/osal/rt/osal.h ****  * @note    The result is rounded upward to the next tick boundary.
 348:../../../os/hal/osal/rt/osal.h ****  *
 349:../../../os/hal/osal/rt/osal.h ****  * @param[in] usecs     number of microseconds
 350:../../../os/hal/osal/rt/osal.h ****  * @return              The number of ticks.
 351:../../../os/hal/osal/rt/osal.h ****  *
 352:../../../os/hal/osal/rt/osal.h ****  * @api
 353:../../../os/hal/osal/rt/osal.h ****  */
 354:../../../os/hal/osal/rt/osal.h **** #define OSAL_US2I(usecs) TIME_US2I(usecs)
 355:../../../os/hal/osal/rt/osal.h **** /** @} */
 356:../../../os/hal/osal/rt/osal.h **** 
 357:../../../os/hal/osal/rt/osal.h **** /**
 358:../../../os/hal/osal/rt/osal.h ****  * @name    Time conversion utilities for the realtime counter
 359:../../../os/hal/osal/rt/osal.h ****  * @{
 360:../../../os/hal/osal/rt/osal.h ****  */
 361:../../../os/hal/osal/rt/osal.h **** /**
 362:../../../os/hal/osal/rt/osal.h ****  * @brief   Seconds to realtime counter.
 363:../../../os/hal/osal/rt/osal.h ****  * @details Converts from seconds to realtime counter cycles.
 364:../../../os/hal/osal/rt/osal.h ****  * @note    The macro assumes that @p freq >= @p 1.
 365:../../../os/hal/osal/rt/osal.h ****  *
 366:../../../os/hal/osal/rt/osal.h ****  * @param[in] freq      clock frequency, in Hz, of the realtime counter
 367:../../../os/hal/osal/rt/osal.h ****  * @param[in] sec       number of seconds
 368:../../../os/hal/osal/rt/osal.h ****  * @return              The number of cycles.
 369:../../../os/hal/osal/rt/osal.h ****  *
 370:../../../os/hal/osal/rt/osal.h ****  * @api
 371:../../../os/hal/osal/rt/osal.h ****  */
 372:../../../os/hal/osal/rt/osal.h **** #define OSAL_S2RTC(freq, sec) S2RTC(freq, sec)
 373:../../../os/hal/osal/rt/osal.h **** 
 374:../../../os/hal/osal/rt/osal.h **** /**
 375:../../../os/hal/osal/rt/osal.h ****  * @brief   Milliseconds to realtime counter.
 376:../../../os/hal/osal/rt/osal.h ****  * @details Converts from milliseconds to realtime counter cycles.
 377:../../../os/hal/osal/rt/osal.h ****  * @note    The result is rounded upward to the next millisecond boundary.
 378:../../../os/hal/osal/rt/osal.h ****  * @note    The macro assumes that @p freq >= @p 1000.
 379:../../../os/hal/osal/rt/osal.h ****  *
 380:../../../os/hal/osal/rt/osal.h ****  * @param[in] freq      clock frequency, in Hz, of the realtime counter
 381:../../../os/hal/osal/rt/osal.h ****  * @param[in] msec      number of milliseconds
 382:../../../os/hal/osal/rt/osal.h ****  * @return              The number of cycles.
 383:../../../os/hal/osal/rt/osal.h ****  *
 384:../../../os/hal/osal/rt/osal.h ****  * @api
 385:../../../os/hal/osal/rt/osal.h ****  */
 386:../../../os/hal/osal/rt/osal.h **** #define OSAL_MS2RTC(freq, msec) MS2RTC(freq, msec)
 387:../../../os/hal/osal/rt/osal.h **** 
 388:../../../os/hal/osal/rt/osal.h **** /**
 389:../../../os/hal/osal/rt/osal.h ****  * @brief   Microseconds to realtime counter.
 390:../../../os/hal/osal/rt/osal.h ****  * @details Converts from microseconds to realtime counter cycles.
 391:../../../os/hal/osal/rt/osal.h ****  * @note    The result is rounded upward to the next microsecond boundary.
 392:../../../os/hal/osal/rt/osal.h ****  * @note    The macro assumes that @p freq >= @p 1000000.
 393:../../../os/hal/osal/rt/osal.h ****  *
 394:../../../os/hal/osal/rt/osal.h ****  * @param[in] freq      clock frequency, in Hz, of the realtime counter
 395:../../../os/hal/osal/rt/osal.h ****  * @param[in] usec      number of microseconds
 396:../../../os/hal/osal/rt/osal.h ****  * @return              The number of cycles.
 397:../../../os/hal/osal/rt/osal.h ****  *
 398:../../../os/hal/osal/rt/osal.h ****  * @api
 399:../../../os/hal/osal/rt/osal.h ****  */
 400:../../../os/hal/osal/rt/osal.h **** #define OSAL_US2RTC(freq, usec) US2RTC(freq, usec)
 401:../../../os/hal/osal/rt/osal.h **** /** @} */
 402:../../../os/hal/osal/rt/osal.h **** 
 403:../../../os/hal/osal/rt/osal.h **** /**
 404:../../../os/hal/osal/rt/osal.h ****  * @name    Sleep macros using absolute time
 405:../../../os/hal/osal/rt/osal.h ****  * @{
 406:../../../os/hal/osal/rt/osal.h ****  */
 407:../../../os/hal/osal/rt/osal.h **** /**
 408:../../../os/hal/osal/rt/osal.h ****  * @brief   Delays the invoking thread for the specified number of seconds.
 409:../../../os/hal/osal/rt/osal.h ****  * @note    The specified time is rounded up to a value allowed by the real
 410:../../../os/hal/osal/rt/osal.h ****  *          system tick clock.
 411:../../../os/hal/osal/rt/osal.h ****  * @note    The maximum specifiable value is implementation dependent.
 412:../../../os/hal/osal/rt/osal.h ****  *
 413:../../../os/hal/osal/rt/osal.h ****  * @param[in] secs      time in seconds, must be different from zero
 414:../../../os/hal/osal/rt/osal.h ****  *
 415:../../../os/hal/osal/rt/osal.h ****  * @api
 416:../../../os/hal/osal/rt/osal.h ****  */
 417:../../../os/hal/osal/rt/osal.h **** #define osalThreadSleepSeconds(secs) osalThreadSleep(OSAL_S2I(secs))
 418:../../../os/hal/osal/rt/osal.h **** 
 419:../../../os/hal/osal/rt/osal.h **** /**
 420:../../../os/hal/osal/rt/osal.h ****  * @brief   Delays the invoking thread for the specified number of
 421:../../../os/hal/osal/rt/osal.h ****  *          milliseconds.
 422:../../../os/hal/osal/rt/osal.h ****  * @note    The specified time is rounded up to a value allowed by the real
 423:../../../os/hal/osal/rt/osal.h ****  *          system tick clock.
 424:../../../os/hal/osal/rt/osal.h ****  * @note    The maximum specifiable value is implementation dependent.
 425:../../../os/hal/osal/rt/osal.h ****  *
 426:../../../os/hal/osal/rt/osal.h ****  * @param[in] msecs     time in milliseconds, must be different from zero
 427:../../../os/hal/osal/rt/osal.h ****  *
 428:../../../os/hal/osal/rt/osal.h ****  * @api
 429:../../../os/hal/osal/rt/osal.h ****  */
 430:../../../os/hal/osal/rt/osal.h **** #define osalThreadSleepMilliseconds(msecs) osalThreadSleep(OSAL_MS2I(msecs))
 431:../../../os/hal/osal/rt/osal.h **** 
 432:../../../os/hal/osal/rt/osal.h **** /**
 433:../../../os/hal/osal/rt/osal.h ****  * @brief   Delays the invoking thread for the specified number of
 434:../../../os/hal/osal/rt/osal.h ****  *          microseconds.
 435:../../../os/hal/osal/rt/osal.h ****  * @note    The specified time is rounded up to a value allowed by the real
 436:../../../os/hal/osal/rt/osal.h ****  *          system tick clock.
 437:../../../os/hal/osal/rt/osal.h ****  * @note    The maximum specifiable value is implementation dependent.
 438:../../../os/hal/osal/rt/osal.h ****  *
 439:../../../os/hal/osal/rt/osal.h ****  * @param[in] usecs     time in microseconds, must be different from zero
 440:../../../os/hal/osal/rt/osal.h ****  *
 441:../../../os/hal/osal/rt/osal.h ****  * @api
 442:../../../os/hal/osal/rt/osal.h ****  */
 443:../../../os/hal/osal/rt/osal.h **** #define osalThreadSleepMicroseconds(usecs) osalThreadSleep(OSAL_US2I(usecs))
 444:../../../os/hal/osal/rt/osal.h **** /** @} */
 445:../../../os/hal/osal/rt/osal.h **** 
 446:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
 447:../../../os/hal/osal/rt/osal.h **** /* External declarations.                                                    */
 448:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
 449:../../../os/hal/osal/rt/osal.h **** 
 450:../../../os/hal/osal/rt/osal.h **** #ifdef __cplusplus
 451:../../../os/hal/osal/rt/osal.h **** extern "C" {
 452:../../../os/hal/osal/rt/osal.h **** #endif
 453:../../../os/hal/osal/rt/osal.h **** 
 454:../../../os/hal/osal/rt/osal.h **** #ifdef __cplusplus
 455:../../../os/hal/osal/rt/osal.h **** }
 456:../../../os/hal/osal/rt/osal.h **** #endif
 457:../../../os/hal/osal/rt/osal.h **** 
 458:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
 459:../../../os/hal/osal/rt/osal.h **** /* Module inline functions.                                                  */
 460:../../../os/hal/osal/rt/osal.h **** /*===========================================================================*/
 461:../../../os/hal/osal/rt/osal.h **** 
 462:../../../os/hal/osal/rt/osal.h **** /**
 463:../../../os/hal/osal/rt/osal.h ****  * @brief   OSAL module initialization.
 464:../../../os/hal/osal/rt/osal.h ****  *
 465:../../../os/hal/osal/rt/osal.h ****  * @api
 466:../../../os/hal/osal/rt/osal.h ****  */
 467:../../../os/hal/osal/rt/osal.h **** static inline void osalInit(void) {
 468:../../../os/hal/osal/rt/osal.h **** 
 469:../../../os/hal/osal/rt/osal.h **** }
 470:../../../os/hal/osal/rt/osal.h **** 
 471:../../../os/hal/osal/rt/osal.h **** /**
 472:../../../os/hal/osal/rt/osal.h ****  * @brief   System halt with error message.
 473:../../../os/hal/osal/rt/osal.h ****  *
 474:../../../os/hal/osal/rt/osal.h ****  * @param[in] reason    the halt message pointer
 475:../../../os/hal/osal/rt/osal.h ****  *
 476:../../../os/hal/osal/rt/osal.h ****  * @api
 477:../../../os/hal/osal/rt/osal.h ****  */
 478:../../../os/hal/osal/rt/osal.h **** static inline void osalSysHalt(const char *reason) {
 479:../../../os/hal/osal/rt/osal.h **** 
 480:../../../os/hal/osal/rt/osal.h ****   chSysHalt(reason);
 481:../../../os/hal/osal/rt/osal.h **** }
 482:../../../os/hal/osal/rt/osal.h **** 
 483:../../../os/hal/osal/rt/osal.h **** /**
 484:../../../os/hal/osal/rt/osal.h ****  * @brief   Disables interrupts globally.
 485:../../../os/hal/osal/rt/osal.h ****  *
 486:../../../os/hal/osal/rt/osal.h ****  * @special
 487:../../../os/hal/osal/rt/osal.h ****  */
 488:../../../os/hal/osal/rt/osal.h **** static inline void osalSysDisable(void) {
 489:../../../os/hal/osal/rt/osal.h **** 
 490:../../../os/hal/osal/rt/osal.h ****   chSysDisable();
 491:../../../os/hal/osal/rt/osal.h **** }
 492:../../../os/hal/osal/rt/osal.h **** 
 493:../../../os/hal/osal/rt/osal.h **** /**
 494:../../../os/hal/osal/rt/osal.h ****  * @brief   Enables interrupts globally.
 495:../../../os/hal/osal/rt/osal.h ****  *
 496:../../../os/hal/osal/rt/osal.h ****  * @special
 497:../../../os/hal/osal/rt/osal.h ****  */
 498:../../../os/hal/osal/rt/osal.h **** static inline void osalSysEnable(void) {
 499:../../../os/hal/osal/rt/osal.h **** 
 500:../../../os/hal/osal/rt/osal.h ****   chSysEnable();
 501:../../../os/hal/osal/rt/osal.h **** }
 502:../../../os/hal/osal/rt/osal.h **** 
 503:../../../os/hal/osal/rt/osal.h **** /**
 504:../../../os/hal/osal/rt/osal.h ****  * @brief   Enters a critical zone from thread context.
 505:../../../os/hal/osal/rt/osal.h ****  * @note    This function cannot be used for reentrant critical zones.
 506:../../../os/hal/osal/rt/osal.h ****  *
 507:../../../os/hal/osal/rt/osal.h ****  * @special
 508:../../../os/hal/osal/rt/osal.h ****  */
 509:../../../os/hal/osal/rt/osal.h **** static inline void osalSysLock(void) {
 510:../../../os/hal/osal/rt/osal.h **** 
 511:../../../os/hal/osal/rt/osal.h ****   chSysLock();
 512:../../../os/hal/osal/rt/osal.h **** }
 513:../../../os/hal/osal/rt/osal.h **** 
 514:../../../os/hal/osal/rt/osal.h **** /**
 515:../../../os/hal/osal/rt/osal.h ****  * @brief   Leaves a critical zone from thread context.
 516:../../../os/hal/osal/rt/osal.h ****  * @note    This function cannot be used for reentrant critical zones.
 517:../../../os/hal/osal/rt/osal.h ****  *
 518:../../../os/hal/osal/rt/osal.h ****  * @special
 519:../../../os/hal/osal/rt/osal.h ****  */
 520:../../../os/hal/osal/rt/osal.h **** static inline void osalSysUnlock(void) {
 521:../../../os/hal/osal/rt/osal.h **** 
 522:../../../os/hal/osal/rt/osal.h ****   chSysUnlock();
 523:../../../os/hal/osal/rt/osal.h **** }
 524:../../../os/hal/osal/rt/osal.h **** 
 525:../../../os/hal/osal/rt/osal.h **** /**
 526:../../../os/hal/osal/rt/osal.h ****  * @brief   Enters a critical zone from ISR context.
 527:../../../os/hal/osal/rt/osal.h ****  * @note    This function cannot be used for reentrant critical zones.
 528:../../../os/hal/osal/rt/osal.h ****  *
 529:../../../os/hal/osal/rt/osal.h ****  * @special
 530:../../../os/hal/osal/rt/osal.h ****  */
 531:../../../os/hal/osal/rt/osal.h **** static inline void osalSysLockFromISR(void) {
 532:../../../os/hal/osal/rt/osal.h **** 
 533:../../../os/hal/osal/rt/osal.h ****   chSysLockFromISR();
 534:../../../os/hal/osal/rt/osal.h **** }
 535:../../../os/hal/osal/rt/osal.h **** 
 536:../../../os/hal/osal/rt/osal.h **** /**
 537:../../../os/hal/osal/rt/osal.h ****  * @brief   Leaves a critical zone from ISR context.
 538:../../../os/hal/osal/rt/osal.h ****  * @note    This function cannot be used for reentrant critical zones.
 539:../../../os/hal/osal/rt/osal.h ****  *
 540:../../../os/hal/osal/rt/osal.h ****  * @special
 541:../../../os/hal/osal/rt/osal.h ****  */
 542:../../../os/hal/osal/rt/osal.h **** static inline void osalSysUnlockFromISR(void) {
 543:../../../os/hal/osal/rt/osal.h **** 
 544:../../../os/hal/osal/rt/osal.h ****   chSysUnlockFromISR();
 545:../../../os/hal/osal/rt/osal.h **** }
 546:../../../os/hal/osal/rt/osal.h **** 
 547:../../../os/hal/osal/rt/osal.h **** /**
 548:../../../os/hal/osal/rt/osal.h ****  * @brief   Returns the execution status and enters a critical zone.
 549:../../../os/hal/osal/rt/osal.h ****  * @details This functions enters into a critical zone and can be called
 550:../../../os/hal/osal/rt/osal.h ****  *          from any context. Because its flexibility it is less efficient
 551:../../../os/hal/osal/rt/osal.h ****  *          than @p chSysLock() which is preferable when the calling context
 552:../../../os/hal/osal/rt/osal.h ****  *          is known.
 553:../../../os/hal/osal/rt/osal.h ****  * @post    The system is in a critical zone.
 554:../../../os/hal/osal/rt/osal.h ****  *
 555:../../../os/hal/osal/rt/osal.h ****  * @return              The previous system status, the encoding of this
 556:../../../os/hal/osal/rt/osal.h ****  *                      status word is architecture-dependent and opaque.
 557:../../../os/hal/osal/rt/osal.h ****  *
 558:../../../os/hal/osal/rt/osal.h ****  * @xclass
 559:../../../os/hal/osal/rt/osal.h ****  */
 560:../../../os/hal/osal/rt/osal.h **** static inline syssts_t osalSysGetStatusAndLockX(void) {
 561:../../../os/hal/osal/rt/osal.h **** 
 562:../../../os/hal/osal/rt/osal.h ****   return chSysGetStatusAndLockX();
 563:../../../os/hal/osal/rt/osal.h **** }
 564:../../../os/hal/osal/rt/osal.h **** 
 565:../../../os/hal/osal/rt/osal.h **** /**
 566:../../../os/hal/osal/rt/osal.h ****  * @brief   Restores the specified execution status and leaves a critical zone.
 567:../../../os/hal/osal/rt/osal.h ****  * @note    A call to @p chSchRescheduleS() is automatically performed
 568:../../../os/hal/osal/rt/osal.h ****  *          if exiting the critical zone and if not in ISR context.
 569:../../../os/hal/osal/rt/osal.h ****  *
 570:../../../os/hal/osal/rt/osal.h ****  * @param[in] sts       the system status to be restored.
 571:../../../os/hal/osal/rt/osal.h ****  *
 572:../../../os/hal/osal/rt/osal.h ****  * @xclass
 573:../../../os/hal/osal/rt/osal.h ****  */
 574:../../../os/hal/osal/rt/osal.h **** static inline void osalSysRestoreStatusX(syssts_t sts) {
 575:../../../os/hal/osal/rt/osal.h **** 
 576:../../../os/hal/osal/rt/osal.h ****   chSysRestoreStatusX(sts);
 577:../../../os/hal/osal/rt/osal.h **** }
 578:../../../os/hal/osal/rt/osal.h **** 
 579:../../../os/hal/osal/rt/osal.h **** /**
 580:../../../os/hal/osal/rt/osal.h ****  * @brief   Polled delay.
 581:../../../os/hal/osal/rt/osal.h ****  * @note    The real delay is always few cycles in excess of the specified
 582:../../../os/hal/osal/rt/osal.h ****  *          value.
 583:../../../os/hal/osal/rt/osal.h ****  *
 584:../../../os/hal/osal/rt/osal.h ****  * @param[in] cycles    number of cycles
 585:../../../os/hal/osal/rt/osal.h ****  *
 586:../../../os/hal/osal/rt/osal.h ****  * @xclass
 587:../../../os/hal/osal/rt/osal.h ****  */
 588:../../../os/hal/osal/rt/osal.h **** #if (PORT_SUPPORTS_RT == TRUE) || defined(__DOXYGEN__)
 589:../../../os/hal/osal/rt/osal.h **** static inline void osalSysPolledDelayX(rtcnt_t cycles) {
 590:../../../os/hal/osal/rt/osal.h **** 
 591:../../../os/hal/osal/rt/osal.h ****   chSysPolledDelayX(cycles);
 592:../../../os/hal/osal/rt/osal.h **** }
 593:../../../os/hal/osal/rt/osal.h **** #endif
 594:../../../os/hal/osal/rt/osal.h **** 
 595:../../../os/hal/osal/rt/osal.h **** /**
 596:../../../os/hal/osal/rt/osal.h ****  * @brief   Systick callback for the underlying OS.
 597:../../../os/hal/osal/rt/osal.h ****  * @note    This callback is only defined if the OSAL requires such a
 598:../../../os/hal/osal/rt/osal.h ****  *          service from the HAL.
 599:../../../os/hal/osal/rt/osal.h ****  */
 600:../../../os/hal/osal/rt/osal.h **** #if (OSAL_ST_MODE != OSAL_ST_MODE_NONE) || defined(__DOXYGEN__)
 601:../../../os/hal/osal/rt/osal.h **** static inline void osalOsTimerHandlerI(void) {
 602:../../../os/hal/osal/rt/osal.h **** 
 603:../../../os/hal/osal/rt/osal.h ****   chSysTimerHandlerI();
 604:../../../os/hal/osal/rt/osal.h **** }
 605:../../../os/hal/osal/rt/osal.h **** #endif
 606:../../../os/hal/osal/rt/osal.h **** 
 607:../../../os/hal/osal/rt/osal.h **** /**
 608:../../../os/hal/osal/rt/osal.h ****  * @brief   Checks if a reschedule is required and performs it.
 609:../../../os/hal/osal/rt/osal.h ****  * @note    I-Class functions invoked from thread context must not reschedule
 610:../../../os/hal/osal/rt/osal.h ****  *          by themselves, an explicit reschedule using this function is
 611:../../../os/hal/osal/rt/osal.h ****  *          required in this scenario.
 612:../../../os/hal/osal/rt/osal.h ****  * @note    Not implemented in this simplified OSAL.
 613:../../../os/hal/osal/rt/osal.h ****  *
 614:../../../os/hal/osal/rt/osal.h ****  * @sclass
 615:../../../os/hal/osal/rt/osal.h ****  */
 616:../../../os/hal/osal/rt/osal.h **** static inline void osalOsRescheduleS(void) {
 617:../../../os/hal/osal/rt/osal.h **** 
 618:../../../os/hal/osal/rt/osal.h ****   chSchRescheduleS();
 619:../../../os/hal/osal/rt/osal.h **** }
 620:../../../os/hal/osal/rt/osal.h **** 
 621:../../../os/hal/osal/rt/osal.h **** /**
 622:../../../os/hal/osal/rt/osal.h ****  * @brief   Current system time.
 623:../../../os/hal/osal/rt/osal.h ****  * @details Returns the number of system ticks since the @p osalInit()
 624:../../../os/hal/osal/rt/osal.h ****  *          invocation.
 625:../../../os/hal/osal/rt/osal.h ****  * @note    The counter can reach its maximum and then restart from zero.
 626:../../../os/hal/osal/rt/osal.h ****  * @note    This function can be called from any context but its atomicity
 627:../../../os/hal/osal/rt/osal.h ****  *          is not guaranteed on architectures whose word size is less than
 628:../../../os/hal/osal/rt/osal.h ****  *          @p systime_t size.
 629:../../../os/hal/osal/rt/osal.h ****  *
 630:../../../os/hal/osal/rt/osal.h ****  * @return              The system time in ticks.
 631:../../../os/hal/osal/rt/osal.h ****  *
 632:../../../os/hal/osal/rt/osal.h ****  * @xclass
 633:../../../os/hal/osal/rt/osal.h ****  */
 634:../../../os/hal/osal/rt/osal.h **** static inline systime_t osalOsGetSystemTimeX(void) {
 635:../../../os/hal/osal/rt/osal.h **** 
 636:../../../os/hal/osal/rt/osal.h ****   return chVTGetSystemTimeX();
 637:../../../os/hal/osal/rt/osal.h **** }
 638:../../../os/hal/osal/rt/osal.h **** 
 639:../../../os/hal/osal/rt/osal.h **** /**
 640:../../../os/hal/osal/rt/osal.h ****  * @brief   Adds an interval to a system time returning a system time.
 641:../../../os/hal/osal/rt/osal.h ****  *
 642:../../../os/hal/osal/rt/osal.h ****  * @param[in] systime   base system time
 643:../../../os/hal/osal/rt/osal.h ****  * @param[in] interval  interval to be added
 644:../../../os/hal/osal/rt/osal.h ****  * @return              The new system time.
 645:../../../os/hal/osal/rt/osal.h ****  *
 646:../../../os/hal/osal/rt/osal.h ****  * @xclass
 647:../../../os/hal/osal/rt/osal.h ****  */
 648:../../../os/hal/osal/rt/osal.h **** static inline systime_t osalTimeAddX(systime_t systime,
 649:../../../os/hal/osal/rt/osal.h ****                                      sysinterval_t interval) {
 650:../../../os/hal/osal/rt/osal.h **** 
 651:../../../os/hal/osal/rt/osal.h ****   return chTimeAddX(systime, interval);
 652:../../../os/hal/osal/rt/osal.h **** }
 653:../../../os/hal/osal/rt/osal.h **** 
 654:../../../os/hal/osal/rt/osal.h **** /**
 655:../../../os/hal/osal/rt/osal.h ****  * @brief   Subtracts two system times returning an interval.
 656:../../../os/hal/osal/rt/osal.h ****  *
 657:../../../os/hal/osal/rt/osal.h ****  * @param[in] start     first system time
 658:../../../os/hal/osal/rt/osal.h ****  * @param[in] end       second system time
 659:../../../os/hal/osal/rt/osal.h ****  * @return              The interval representing the time difference.
 660:../../../os/hal/osal/rt/osal.h ****  *
 661:../../../os/hal/osal/rt/osal.h ****  * @xclass
 662:../../../os/hal/osal/rt/osal.h ****  */
 663:../../../os/hal/osal/rt/osal.h **** static inline sysinterval_t osalTimeDiffX(systime_t start, systime_t end) {
 664:../../../os/hal/osal/rt/osal.h **** 
 665:../../../os/hal/osal/rt/osal.h ****   return chTimeDiffX(start, end);
 666:../../../os/hal/osal/rt/osal.h **** }
 667:../../../os/hal/osal/rt/osal.h **** 
 668:../../../os/hal/osal/rt/osal.h **** /**
 669:../../../os/hal/osal/rt/osal.h ****  * @brief   Checks if the specified time is within the specified time window.
 670:../../../os/hal/osal/rt/osal.h ****  * @note    When start==end then the function returns always true because the
 671:../../../os/hal/osal/rt/osal.h ****  *          whole time range is specified.
 672:../../../os/hal/osal/rt/osal.h ****  * @note    This function can be called from any context.
 673:../../../os/hal/osal/rt/osal.h ****  *
 674:../../../os/hal/osal/rt/osal.h ****  * @param[in] time      the time to be verified
 675:../../../os/hal/osal/rt/osal.h ****  * @param[in] start     the start of the time window (inclusive)
 676:../../../os/hal/osal/rt/osal.h ****  * @param[in] end       the end of the time window (non inclusive)
 677:../../../os/hal/osal/rt/osal.h ****  * @retval true         current time within the specified time window.
 678:../../../os/hal/osal/rt/osal.h ****  * @retval false        current time not within the specified time window.
 679:../../../os/hal/osal/rt/osal.h ****  *
 680:../../../os/hal/osal/rt/osal.h ****  * @xclass
 681:../../../os/hal/osal/rt/osal.h ****  */
 682:../../../os/hal/osal/rt/osal.h **** static inline bool osalTimeIsInRangeX(systime_t time,
 683:../../../os/hal/osal/rt/osal.h ****                                       systime_t start,
 684:../../../os/hal/osal/rt/osal.h ****                                       systime_t end) {
 685:../../../os/hal/osal/rt/osal.h **** 
 686:../../../os/hal/osal/rt/osal.h ****   return chTimeIsInRangeX(time, start, end);
 687:../../../os/hal/osal/rt/osal.h **** }
 688:../../../os/hal/osal/rt/osal.h **** 
 689:../../../os/hal/osal/rt/osal.h **** /**
 690:../../../os/hal/osal/rt/osal.h ****  * @brief   Suspends the invoking thread for the specified time.
 691:../../../os/hal/osal/rt/osal.h ****  *
 692:../../../os/hal/osal/rt/osal.h ****  * @param[in] delay     the delay in system ticks, the special values are
 693:../../../os/hal/osal/rt/osal.h ****  *                      handled as follow:
 694:../../../os/hal/osal/rt/osal.h ****  *                      - @a TIME_INFINITE is allowed but interpreted as a
 695:../../../os/hal/osal/rt/osal.h ****  *                        normal time specification.
 696:../../../os/hal/osal/rt/osal.h ****  *                      - @a TIME_IMMEDIATE this value is not allowed.
 697:../../../os/hal/osal/rt/osal.h ****  *                      .
 698:../../../os/hal/osal/rt/osal.h ****  *
 699:../../../os/hal/osal/rt/osal.h ****  * @sclass
 700:../../../os/hal/osal/rt/osal.h ****  */
 701:../../../os/hal/osal/rt/osal.h **** static inline void osalThreadSleepS(sysinterval_t delay) {
 702:../../../os/hal/osal/rt/osal.h **** 
 703:../../../os/hal/osal/rt/osal.h ****   chThdSleepS(delay);
 704:../../../os/hal/osal/rt/osal.h **** }
 705:../../../os/hal/osal/rt/osal.h **** 
 706:../../../os/hal/osal/rt/osal.h **** /**
 707:../../../os/hal/osal/rt/osal.h ****  * @brief   Suspends the invoking thread for the specified time.
 708:../../../os/hal/osal/rt/osal.h ****  *
 709:../../../os/hal/osal/rt/osal.h ****  * @param[in] delay     the delay in system ticks, the special values are
 710:../../../os/hal/osal/rt/osal.h ****  *                      handled as follow:
 711:../../../os/hal/osal/rt/osal.h ****  *                      - @a TIME_INFINITE is allowed but interpreted as a
 712:../../../os/hal/osal/rt/osal.h ****  *                        normal time specification.
 713:../../../os/hal/osal/rt/osal.h ****  *                      - @a TIME_IMMEDIATE this value is not allowed.
 714:../../../os/hal/osal/rt/osal.h ****  *                      .
 715:../../../os/hal/osal/rt/osal.h ****  *
 716:../../../os/hal/osal/rt/osal.h ****  * @api
 717:../../../os/hal/osal/rt/osal.h ****  */
 718:../../../os/hal/osal/rt/osal.h **** static inline void osalThreadSleep(sysinterval_t delay) {
 719:../../../os/hal/osal/rt/osal.h **** 
 720:../../../os/hal/osal/rt/osal.h ****   chThdSleep(delay);
 721:../../../os/hal/osal/rt/osal.h **** }
 722:../../../os/hal/osal/rt/osal.h **** 
 723:../../../os/hal/osal/rt/osal.h **** /**
 724:../../../os/hal/osal/rt/osal.h ****  * @brief   Sends the current thread sleeping and sets a reference variable.
 725:../../../os/hal/osal/rt/osal.h ****  * @note    This function must reschedule, it can only be called from thread
 726:../../../os/hal/osal/rt/osal.h ****  *          context.
 727:../../../os/hal/osal/rt/osal.h ****  *
 728:../../../os/hal/osal/rt/osal.h ****  * @param[in] trp       a pointer to a thread reference object
 729:../../../os/hal/osal/rt/osal.h ****  * @return              The wake up message.
 730:../../../os/hal/osal/rt/osal.h ****  *
 731:../../../os/hal/osal/rt/osal.h ****  * @sclass
 732:../../../os/hal/osal/rt/osal.h ****  */
 733:../../../os/hal/osal/rt/osal.h **** static inline msg_t osalThreadSuspendS(thread_reference_t *trp) {
 734:../../../os/hal/osal/rt/osal.h **** 
 735:../../../os/hal/osal/rt/osal.h ****   return chThdSuspendTimeoutS(trp, TIME_INFINITE);
 736:../../../os/hal/osal/rt/osal.h **** }
 737:../../../os/hal/osal/rt/osal.h **** 
 738:../../../os/hal/osal/rt/osal.h **** /**
 739:../../../os/hal/osal/rt/osal.h ****  * @brief   Sends the current thread sleeping and sets a reference variable.
 740:../../../os/hal/osal/rt/osal.h ****  * @note    This function must reschedule, it can only be called from thread
 741:../../../os/hal/osal/rt/osal.h ****  *          context.
 742:../../../os/hal/osal/rt/osal.h ****  *
 743:../../../os/hal/osal/rt/osal.h ****  * @param[in] trp       a pointer to a thread reference object
 744:../../../os/hal/osal/rt/osal.h ****  * @param[in] timeout   the timeout in system ticks, the special values are
 745:../../../os/hal/osal/rt/osal.h ****  *                      handled as follow:
 746:../../../os/hal/osal/rt/osal.h ****  *                      - @a TIME_INFINITE the thread enters an infinite sleep
 747:../../../os/hal/osal/rt/osal.h ****  *                        state.
 748:../../../os/hal/osal/rt/osal.h ****  *                      - @a TIME_IMMEDIATE the thread is not enqueued and
 749:../../../os/hal/osal/rt/osal.h ****  *                        the function returns @p MSG_TIMEOUT as if a timeout
 750:../../../os/hal/osal/rt/osal.h ****  *                        occurred.
 751:../../../os/hal/osal/rt/osal.h ****  *                      .
 752:../../../os/hal/osal/rt/osal.h ****  * @return              The wake up message.
 753:../../../os/hal/osal/rt/osal.h ****  * @retval MSG_TIMEOUT  if the operation timed out.
 754:../../../os/hal/osal/rt/osal.h ****  *
 755:../../../os/hal/osal/rt/osal.h ****  * @sclass
 756:../../../os/hal/osal/rt/osal.h ****  */
 757:../../../os/hal/osal/rt/osal.h **** static inline msg_t osalThreadSuspendTimeoutS(thread_reference_t *trp,
 758:../../../os/hal/osal/rt/osal.h ****                                               sysinterval_t timeout) {
 759:../../../os/hal/osal/rt/osal.h **** 
 760:../../../os/hal/osal/rt/osal.h ****   return chThdSuspendTimeoutS(trp, timeout);
 761:../../../os/hal/osal/rt/osal.h **** }
 762:../../../os/hal/osal/rt/osal.h **** 
 763:../../../os/hal/osal/rt/osal.h **** /**
 764:../../../os/hal/osal/rt/osal.h ****  * @brief   Wakes up a thread waiting on a thread reference object.
 765:../../../os/hal/osal/rt/osal.h ****  * @note    This function must not reschedule because it can be called from
 766:../../../os/hal/osal/rt/osal.h ****  *          ISR context.
 767:../../../os/hal/osal/rt/osal.h ****  *
 768:../../../os/hal/osal/rt/osal.h ****  * @param[in] trp       a pointer to a thread reference object
 769:../../../os/hal/osal/rt/osal.h ****  * @param[in] msg       the message code
 770:../../../os/hal/osal/rt/osal.h ****  *
 771:../../../os/hal/osal/rt/osal.h ****  * @iclass
 772:../../../os/hal/osal/rt/osal.h ****  */
 773:../../../os/hal/osal/rt/osal.h **** static inline void osalThreadResumeI(thread_reference_t *trp, msg_t msg) {
 774:../../../os/hal/osal/rt/osal.h **** 
 775:../../../os/hal/osal/rt/osal.h ****   chThdResumeI(trp, msg);
 776:../../../os/hal/osal/rt/osal.h **** }
 777:../../../os/hal/osal/rt/osal.h **** 
 778:../../../os/hal/osal/rt/osal.h **** /**
 779:../../../os/hal/osal/rt/osal.h ****  * @brief   Wakes up a thread waiting on a thread reference object.
 780:../../../os/hal/osal/rt/osal.h ****  * @note    This function must reschedule, it can only be called from thread
 781:../../../os/hal/osal/rt/osal.h ****  *          context.
 782:../../../os/hal/osal/rt/osal.h ****  *
 783:../../../os/hal/osal/rt/osal.h ****  * @param[in] trp       a pointer to a thread reference object
 784:../../../os/hal/osal/rt/osal.h ****  * @param[in] msg       the message code
 785:../../../os/hal/osal/rt/osal.h ****  *
 786:../../../os/hal/osal/rt/osal.h ****  * @iclass
 787:../../../os/hal/osal/rt/osal.h ****  */
 788:../../../os/hal/osal/rt/osal.h **** static inline void osalThreadResumeS(thread_reference_t *trp, msg_t msg) {
 789:../../../os/hal/osal/rt/osal.h **** 
 790:../../../os/hal/osal/rt/osal.h ****   chThdResumeS(trp, msg);
 791:../../../os/hal/osal/rt/osal.h **** }
 792:../../../os/hal/osal/rt/osal.h **** 
 793:../../../os/hal/osal/rt/osal.h **** /**
 794:../../../os/hal/osal/rt/osal.h ****  * @brief   Initializes a threads queue object.
 795:../../../os/hal/osal/rt/osal.h ****  *
 796:../../../os/hal/osal/rt/osal.h ****  * @param[out] tqp      pointer to the threads queue object
 797:../../../os/hal/osal/rt/osal.h ****  *
 798:../../../os/hal/osal/rt/osal.h ****  * @init
 799:../../../os/hal/osal/rt/osal.h ****  */
 800:../../../os/hal/osal/rt/osal.h **** static inline void osalThreadQueueObjectInit(threads_queue_t *tqp) {
 801:../../../os/hal/osal/rt/osal.h **** 
 802:../../../os/hal/osal/rt/osal.h ****   chThdQueueObjectInit(tqp);
 803:../../../os/hal/osal/rt/osal.h **** }
 804:../../../os/hal/osal/rt/osal.h **** 
 805:../../../os/hal/osal/rt/osal.h **** /**
 806:../../../os/hal/osal/rt/osal.h ****  * @brief   Enqueues the caller thread.
 807:../../../os/hal/osal/rt/osal.h ****  * @details The caller thread is enqueued and put to sleep until it is
 808:../../../os/hal/osal/rt/osal.h ****  *          dequeued or the specified timeouts expires.
 809:../../../os/hal/osal/rt/osal.h ****  *
 810:../../../os/hal/osal/rt/osal.h ****  * @param[in] tqp       pointer to the threads queue object
 811:../../../os/hal/osal/rt/osal.h ****  * @param[in] timeout   the timeout in system ticks, the special values are
 812:../../../os/hal/osal/rt/osal.h ****  *                      handled as follow:
 813:../../../os/hal/osal/rt/osal.h ****  *                      - @a TIME_INFINITE the thread enters an infinite sleep
 814:../../../os/hal/osal/rt/osal.h ****  *                        state.
 815:../../../os/hal/osal/rt/osal.h ****  *                      - @a TIME_IMMEDIATE the thread is not enqueued and
 816:../../../os/hal/osal/rt/osal.h ****  *                        the function returns @p MSG_TIMEOUT as if a timeout
 817:../../../os/hal/osal/rt/osal.h ****  *                        occurred.
 818:../../../os/hal/osal/rt/osal.h ****  *                      .
 819:../../../os/hal/osal/rt/osal.h ****  * @return              The message from @p osalQueueWakeupOneI() or
 820:../../../os/hal/osal/rt/osal.h ****  *                      @p osalQueueWakeupAllI() functions.
 821:../../../os/hal/osal/rt/osal.h ****  * @retval MSG_TIMEOUT  if the thread has not been dequeued within the
 822:../../../os/hal/osal/rt/osal.h ****  *                      specified timeout or if the function has been
 823:../../../os/hal/osal/rt/osal.h ****  *                      invoked with @p TIME_IMMEDIATE as timeout
 824:../../../os/hal/osal/rt/osal.h ****  *                      specification.
 825:../../../os/hal/osal/rt/osal.h ****  *
 826:../../../os/hal/osal/rt/osal.h ****  * @sclass
 827:../../../os/hal/osal/rt/osal.h ****  */
 828:../../../os/hal/osal/rt/osal.h **** static inline msg_t osalThreadEnqueueTimeoutS(threads_queue_t *tqp,
 829:../../../os/hal/osal/rt/osal.h ****                                               sysinterval_t timeout) {
 830:../../../os/hal/osal/rt/osal.h **** 
 831:../../../os/hal/osal/rt/osal.h ****   return chThdEnqueueTimeoutS(tqp, timeout);
 832:../../../os/hal/osal/rt/osal.h **** }
 833:../../../os/hal/osal/rt/osal.h **** 
 834:../../../os/hal/osal/rt/osal.h **** /**
 835:../../../os/hal/osal/rt/osal.h ****  * @brief   Dequeues and wakes up one thread from the queue, if any.
 836:../../../os/hal/osal/rt/osal.h ****  *
 837:../../../os/hal/osal/rt/osal.h ****  * @param[in] tqp       pointer to the threads queue object
 838:../../../os/hal/osal/rt/osal.h ****  * @param[in] msg       the message code
 839:../../../os/hal/osal/rt/osal.h ****  *
 840:../../../os/hal/osal/rt/osal.h ****  * @iclass
 841:../../../os/hal/osal/rt/osal.h ****  */
 842:../../../os/hal/osal/rt/osal.h **** static inline void osalThreadDequeueNextI(threads_queue_t *tqp, msg_t msg) {
 843:../../../os/hal/osal/rt/osal.h **** 
 844:../../../os/hal/osal/rt/osal.h ****   chThdDequeueNextI(tqp, msg);
 845:../../../os/hal/osal/rt/osal.h **** }
 846:../../../os/hal/osal/rt/osal.h **** 
 847:../../../os/hal/osal/rt/osal.h **** /**
 848:../../../os/hal/osal/rt/osal.h ****  * @brief   Dequeues and wakes up all threads from the queue.
 849:../../../os/hal/osal/rt/osal.h ****  *
 850:../../../os/hal/osal/rt/osal.h ****  * @param[in] tqp       pointer to the threads queue object
 851:../../../os/hal/osal/rt/osal.h ****  * @param[in] msg       the message code
 852:../../../os/hal/osal/rt/osal.h ****  *
 853:../../../os/hal/osal/rt/osal.h ****  * @iclass
 854:../../../os/hal/osal/rt/osal.h ****  */
 855:../../../os/hal/osal/rt/osal.h **** static inline void osalThreadDequeueAllI(threads_queue_t *tqp, msg_t msg) {
 856:../../../os/hal/osal/rt/osal.h **** 
 857:../../../os/hal/osal/rt/osal.h ****   chThdDequeueAllI(tqp, msg);
 858:../../../os/hal/osal/rt/osal.h **** }
 859:../../../os/hal/osal/rt/osal.h **** 
 860:../../../os/hal/osal/rt/osal.h **** #if (CH_CFG_USE_EVENTS == TRUE) || defined(__DOXYGEN__)
 861:../../../os/hal/osal/rt/osal.h **** /**
 862:../../../os/hal/osal/rt/osal.h ****  * @brief   Initializes an event source object.
 863:../../../os/hal/osal/rt/osal.h ****  *
 864:../../../os/hal/osal/rt/osal.h ****  * @param[out] esp      pointer to the event source object
 865:../../../os/hal/osal/rt/osal.h ****  *
 866:../../../os/hal/osal/rt/osal.h ****  * @init
 867:../../../os/hal/osal/rt/osal.h ****  */
 868:../../../os/hal/osal/rt/osal.h **** static inline void osalEventObjectInit(event_source_t *esp) {
 869:../../../os/hal/osal/rt/osal.h **** 
 870:../../../os/hal/osal/rt/osal.h ****   chEvtObjectInit(esp);
 871:../../../os/hal/osal/rt/osal.h **** }
 872:../../../os/hal/osal/rt/osal.h **** #else
 873:../../../os/hal/osal/rt/osal.h **** static inline void osalEventObjectInit(event_source_t *esp) {
 874:../../../os/hal/osal/rt/osal.h **** 
 875:../../../os/hal/osal/rt/osal.h ****   osalDbgCheck(esp != NULL);
 876:../../../os/hal/osal/rt/osal.h **** 
 877:../../../os/hal/osal/rt/osal.h ****   esp->flags = (eventflags_t)0;
 878:../../../os/hal/osal/rt/osal.h ****   esp->cb    = NULL;
 879:../../../os/hal/osal/rt/osal.h ****   esp->param = NULL;
 880:../../../os/hal/osal/rt/osal.h **** }
 881:../../../os/hal/osal/rt/osal.h **** #endif
 882:../../../os/hal/osal/rt/osal.h **** 
 883:../../../os/hal/osal/rt/osal.h **** #if (CH_CFG_USE_EVENTS == TRUE) || defined(__DOXYGEN__)
 884:../../../os/hal/osal/rt/osal.h **** /**
 885:../../../os/hal/osal/rt/osal.h ****  * @brief   Add flags to an event source object.
 886:../../../os/hal/osal/rt/osal.h ****  *
 887:../../../os/hal/osal/rt/osal.h ****  * @param[in] esp       pointer to the event flags object
 888:../../../os/hal/osal/rt/osal.h ****  * @param[in] flags     flags to be ORed to the flags mask
 889:../../../os/hal/osal/rt/osal.h ****  *
 890:../../../os/hal/osal/rt/osal.h ****  * @iclass
 891:../../../os/hal/osal/rt/osal.h ****  */
 892:../../../os/hal/osal/rt/osal.h **** static inline void osalEventBroadcastFlagsI(event_source_t *esp,
 893:../../../os/hal/osal/rt/osal.h ****                                             eventflags_t flags) {
 894:../../../os/hal/osal/rt/osal.h **** 
 895:../../../os/hal/osal/rt/osal.h ****   chEvtBroadcastFlagsI(esp, flags);
 896:../../../os/hal/osal/rt/osal.h **** }
 897:../../../os/hal/osal/rt/osal.h **** #else
 898:../../../os/hal/osal/rt/osal.h **** static inline void osalEventBroadcastFlagsI(event_source_t *esp,
 899:../../../os/hal/osal/rt/osal.h ****                                             eventflags_t flags) {
 900:../../../os/hal/osal/rt/osal.h **** 
 901:../../../os/hal/osal/rt/osal.h ****   osalDbgCheck(esp != NULL);
 902:../../../os/hal/osal/rt/osal.h **** 
 903:../../../os/hal/osal/rt/osal.h ****   esp->flags |= flags;
 904:../../../os/hal/osal/rt/osal.h ****   if (esp->cb != NULL) {
 905:../../../os/hal/osal/rt/osal.h ****     esp->cb(esp);
 906:../../../os/hal/osal/rt/osal.h ****   }
 907:../../../os/hal/osal/rt/osal.h **** }
 908:../../../os/hal/osal/rt/osal.h **** #endif
 909:../../../os/hal/osal/rt/osal.h **** 
 910:../../../os/hal/osal/rt/osal.h **** #if (CH_CFG_USE_EVENTS == TRUE) || defined(__DOXYGEN__)
 911:../../../os/hal/osal/rt/osal.h **** /**
 912:../../../os/hal/osal/rt/osal.h ****  * @brief   Add flags to an event source object.
 913:../../../os/hal/osal/rt/osal.h ****  *
 914:../../../os/hal/osal/rt/osal.h ****  * @param[in] esp       pointer to the event flags object
 915:../../../os/hal/osal/rt/osal.h ****  * @param[in] flags     flags to be ORed to the flags mask
 916:../../../os/hal/osal/rt/osal.h ****  *
 917:../../../os/hal/osal/rt/osal.h ****  * @iclass
 918:../../../os/hal/osal/rt/osal.h ****  */
 919:../../../os/hal/osal/rt/osal.h **** static inline void osalEventBroadcastFlags(event_source_t *esp,
 920:../../../os/hal/osal/rt/osal.h ****                                            eventflags_t flags) {
 921:../../../os/hal/osal/rt/osal.h **** 
 922:../../../os/hal/osal/rt/osal.h ****   chEvtBroadcastFlags(esp, flags);
 923:../../../os/hal/osal/rt/osal.h **** }
 924:../../../os/hal/osal/rt/osal.h **** #else
 925:../../../os/hal/osal/rt/osal.h **** static inline void osalEventBroadcastFlags(event_source_t *esp,
 926:../../../os/hal/osal/rt/osal.h ****                                            eventflags_t flags) {
 927:../../../os/hal/osal/rt/osal.h **** 
 928:../../../os/hal/osal/rt/osal.h ****   osalDbgCheck(esp != NULL);
 929:../../../os/hal/osal/rt/osal.h **** 
 930:../../../os/hal/osal/rt/osal.h ****   osalSysLock();
 931:../../../os/hal/osal/rt/osal.h ****   esp->flags |= flags;
 932:../../../os/hal/osal/rt/osal.h ****   if (esp->cb != NULL) {
 933:../../../os/hal/osal/rt/osal.h ****     esp->cb(esp);
 934:../../../os/hal/osal/rt/osal.h ****   }
 935:../../../os/hal/osal/rt/osal.h ****   osalSysUnlock();
 936:../../../os/hal/osal/rt/osal.h **** }
 937:../../../os/hal/osal/rt/osal.h **** #endif
 938:../../../os/hal/osal/rt/osal.h **** 
 939:../../../os/hal/osal/rt/osal.h **** #if (CH_CFG_USE_EVENTS == FALSE) || defined(__DOXYGEN__)
 940:../../../os/hal/osal/rt/osal.h **** /**
 941:../../../os/hal/osal/rt/osal.h ****  * @brief   Event callback setup.
 942:../../../os/hal/osal/rt/osal.h ****  * @note    The callback is invoked from ISR context and can
 943:../../../os/hal/osal/rt/osal.h ****  *          only invoke I-Class functions. The callback is meant
 944:../../../os/hal/osal/rt/osal.h ****  *          to wakeup the task that will handle the event by
 945:../../../os/hal/osal/rt/osal.h ****  *          calling @p osalEventGetAndClearFlagsI().
 946:../../../os/hal/osal/rt/osal.h ****  *
 947:../../../os/hal/osal/rt/osal.h ****  * @param[in] esp       pointer to the event flags object
 948:../../../os/hal/osal/rt/osal.h ****  * @param[in] cb        pointer to the callback function
 949:../../../os/hal/osal/rt/osal.h ****  * @param[in] param     parameter to be passed to the callback function
 950:../../../os/hal/osal/rt/osal.h ****  *
 951:../../../os/hal/osal/rt/osal.h ****  * @api
 952:../../../os/hal/osal/rt/osal.h ****  */
 953:../../../os/hal/osal/rt/osal.h **** static inline void osalEventSetCallback(event_source_t *esp,
 954:../../../os/hal/osal/rt/osal.h ****                                         eventcallback_t cb,
 955:../../../os/hal/osal/rt/osal.h ****                                         void *param) {
 956:../../../os/hal/osal/rt/osal.h **** 
 957:../../../os/hal/osal/rt/osal.h ****   osalDbgCheck(esp != NULL);
 958:../../../os/hal/osal/rt/osal.h **** 
 959:../../../os/hal/osal/rt/osal.h ****   esp->cb    = cb;
 960:../../../os/hal/osal/rt/osal.h ****   esp->param = param;
 961:../../../os/hal/osal/rt/osal.h **** }
 962:../../../os/hal/osal/rt/osal.h **** #endif
 963:../../../os/hal/osal/rt/osal.h **** 
 964:../../../os/hal/osal/rt/osal.h **** /**
 965:../../../os/hal/osal/rt/osal.h ****  * @brief   Initializes s @p mutex_t object.
 966:../../../os/hal/osal/rt/osal.h ****  *
 967:../../../os/hal/osal/rt/osal.h ****  * @param[out] mp       pointer to the @p mutex_t object
 968:../../../os/hal/osal/rt/osal.h ****  *
 969:../../../os/hal/osal/rt/osal.h ****  * @init
 970:../../../os/hal/osal/rt/osal.h ****  */
 971:../../../os/hal/osal/rt/osal.h **** static inline void osalMutexObjectInit(mutex_t *mp) {
  73               		.loc 2 971 20 view .LVU18
  74               	.LBB86:
 972:../../../os/hal/osal/rt/osal.h **** 
 973:../../../os/hal/osal/rt/osal.h **** #if CH_CFG_USE_MUTEXES
 974:../../../os/hal/osal/rt/osal.h ****   chMtxObjectInit(mp);
  75               		.loc 2 974 3 view .LVU19
  76 001a CF01      		movw r24,r30
  77 001c 0B96      		adiw r24,11
  78               	.LVL4:
  79               		.loc 2 974 3 is_stmt 0 view .LVU20
  80 001e 0C94 0000 		jmp chMtxObjectInit
  81               	.LVL5:
  82               		.loc 2 974 3 view .LVU21
  83               	.LBE86:
  84               	.LBE85:
  85               		.cfi_endproc
  86               	.LFE174:
  88               		.section	.text.adcStart,"ax",@progbits
  89               	.global	adcStart
  91               	adcStart:
  92               	.LVL6:
  93               	.LFB175:
  80:../../../os/hal/src/hal_adc.c **** #endif
  81:../../../os/hal/src/hal_adc.c **** #if defined(ADC_DRIVER_EXT_INIT_HOOK)
  82:../../../os/hal/src/hal_adc.c ****   ADC_DRIVER_EXT_INIT_HOOK(adcp);
  83:../../../os/hal/src/hal_adc.c **** #endif
  84:../../../os/hal/src/hal_adc.c **** }
  85:../../../os/hal/src/hal_adc.c **** 
  86:../../../os/hal/src/hal_adc.c **** /**
  87:../../../os/hal/src/hal_adc.c ****  * @brief   Configures and activates the ADC peripheral.
  88:../../../os/hal/src/hal_adc.c ****  *
  89:../../../os/hal/src/hal_adc.c ****  * @param[in] adcp      pointer to the @p ADCDriver object
  90:../../../os/hal/src/hal_adc.c ****  * @param[in] config    pointer to the @p ADCConfig object. Depending on
  91:../../../os/hal/src/hal_adc.c ****  *                      the implementation the value can be @p NULL.
  92:../../../os/hal/src/hal_adc.c ****  *
  93:../../../os/hal/src/hal_adc.c ****  * @api
  94:../../../os/hal/src/hal_adc.c ****  */
  95:../../../os/hal/src/hal_adc.c **** void adcStart(ADCDriver *adcp, const ADCConfig *config) {
  94               		.loc 1 95 57 is_stmt 1 view -0
  95               		.cfi_startproc
  96               		.loc 1 95 57 is_stmt 0 view .LVU23
  97 0000 CF93      		push r28
  98               	.LCFI0:
  99               		.cfi_def_cfa_offset 3
 100               		.cfi_offset 28, -2
 101 0002 DF93      		push r29
 102               	.LCFI1:
 103               		.cfi_def_cfa_offset 4
 104               		.cfi_offset 29, -3
 105               	/* prologue: function */
 106               	/* frame size = 0 */
 107               	/* stack size = 2 */
 108               	.L__stack_usage = 2
 109 0004 EC01      		movw r28,r24
  96:../../../os/hal/src/hal_adc.c **** 
  97:../../../os/hal/src/hal_adc.c ****   osalDbgCheck(adcp != NULL);
 110               		.loc 1 97 3 is_stmt 1 view .LVU24
 111               		.loc 1 97 3 view .LVU25
  98:../../../os/hal/src/hal_adc.c **** 
  99:../../../os/hal/src/hal_adc.c ****   osalSysLock();
 112               		.loc 1 99 3 view .LVU26
 113               	.LBB87:
 114               	.LBI87:
 509:../../../os/hal/osal/rt/osal.h **** 
 115               		.loc 2 509 20 view .LVU27
 116               	.LBE87:
 511:../../../os/hal/osal/rt/osal.h **** }
 117               		.loc 2 511 3 view .LVU28
 118               	.LBB92:
 119               	.LBB88:
 120               	.LBI88:
 121               		.file 3 "../../../os/rt/include/chsys.h"
   1:../../../os/rt/include/chsys.h **** /*
   2:../../../os/rt/include/chsys.h ****     ChibiOS - Copyright (C) 2006..2018 Giovanni Di Sirio.
   3:../../../os/rt/include/chsys.h **** 
   4:../../../os/rt/include/chsys.h ****     This file is part of ChibiOS.
   5:../../../os/rt/include/chsys.h **** 
   6:../../../os/rt/include/chsys.h ****     ChibiOS is free software; you can redistribute it and/or modify
   7:../../../os/rt/include/chsys.h ****     it under the terms of the GNU General Public License as published by
   8:../../../os/rt/include/chsys.h ****     the Free Software Foundation; either version 3 of the License, or
   9:../../../os/rt/include/chsys.h ****     (at your option) any later version.
  10:../../../os/rt/include/chsys.h **** 
  11:../../../os/rt/include/chsys.h ****     ChibiOS is distributed in the hope that it will be useful,
  12:../../../os/rt/include/chsys.h ****     but WITHOUT ANY WARRANTY; without even the implied warranty of
  13:../../../os/rt/include/chsys.h ****     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  14:../../../os/rt/include/chsys.h ****     GNU General Public License for more details.
  15:../../../os/rt/include/chsys.h **** 
  16:../../../os/rt/include/chsys.h ****     You should have received a copy of the GNU General Public License
  17:../../../os/rt/include/chsys.h ****     along with this program.  If not, see <http://www.gnu.org/licenses/>.
  18:../../../os/rt/include/chsys.h **** */
  19:../../../os/rt/include/chsys.h **** 
  20:../../../os/rt/include/chsys.h **** /**
  21:../../../os/rt/include/chsys.h ****  * @file    chsys.h
  22:../../../os/rt/include/chsys.h ****  * @brief   System related macros and structures.
  23:../../../os/rt/include/chsys.h ****  *
  24:../../../os/rt/include/chsys.h ****  * @addtogroup system
  25:../../../os/rt/include/chsys.h ****  * @{
  26:../../../os/rt/include/chsys.h ****  */
  27:../../../os/rt/include/chsys.h **** 
  28:../../../os/rt/include/chsys.h **** #ifndef CHSYS_H
  29:../../../os/rt/include/chsys.h **** #define CHSYS_H
  30:../../../os/rt/include/chsys.h **** 
  31:../../../os/rt/include/chsys.h **** /*lint -sem(chSysHalt, r_no)*/
  32:../../../os/rt/include/chsys.h **** 
  33:../../../os/rt/include/chsys.h **** /*===========================================================================*/
  34:../../../os/rt/include/chsys.h **** /* Module constants.                                                         */
  35:../../../os/rt/include/chsys.h **** /*===========================================================================*/
  36:../../../os/rt/include/chsys.h **** 
  37:../../../os/rt/include/chsys.h **** /**
  38:../../../os/rt/include/chsys.h ****  * @name    Masks of executable integrity checks.
  39:../../../os/rt/include/chsys.h ****  * @{
  40:../../../os/rt/include/chsys.h ****  */
  41:../../../os/rt/include/chsys.h **** #define CH_INTEGRITY_RLIST                  1U
  42:../../../os/rt/include/chsys.h **** #define CH_INTEGRITY_VTLIST                 2U
  43:../../../os/rt/include/chsys.h **** #define CH_INTEGRITY_REGISTRY               4U
  44:../../../os/rt/include/chsys.h **** #define CH_INTEGRITY_PORT                   8U
  45:../../../os/rt/include/chsys.h **** /** @} */
  46:../../../os/rt/include/chsys.h **** 
  47:../../../os/rt/include/chsys.h **** /*===========================================================================*/
  48:../../../os/rt/include/chsys.h **** /* Module pre-compile time settings.                                         */
  49:../../../os/rt/include/chsys.h **** /*===========================================================================*/
  50:../../../os/rt/include/chsys.h **** 
  51:../../../os/rt/include/chsys.h **** /*===========================================================================*/
  52:../../../os/rt/include/chsys.h **** /* Derived constants and error checks.                                       */
  53:../../../os/rt/include/chsys.h **** /*===========================================================================*/
  54:../../../os/rt/include/chsys.h **** 
  55:../../../os/rt/include/chsys.h **** /*===========================================================================*/
  56:../../../os/rt/include/chsys.h **** /* Module data structures and types.                                         */
  57:../../../os/rt/include/chsys.h **** /*===========================================================================*/
  58:../../../os/rt/include/chsys.h **** 
  59:../../../os/rt/include/chsys.h **** /*===========================================================================*/
  60:../../../os/rt/include/chsys.h **** /* Module macros.                                                            */
  61:../../../os/rt/include/chsys.h **** /*===========================================================================*/
  62:../../../os/rt/include/chsys.h **** 
  63:../../../os/rt/include/chsys.h **** /**
  64:../../../os/rt/include/chsys.h ****  * @name    ISRs abstraction macros
  65:../../../os/rt/include/chsys.h ****  */
  66:../../../os/rt/include/chsys.h **** /**
  67:../../../os/rt/include/chsys.h ****  * @brief   Priority level validation macro.
  68:../../../os/rt/include/chsys.h ****  * @details This macro determines if the passed value is a valid priority
  69:../../../os/rt/include/chsys.h ****  *          level for the underlying architecture.
  70:../../../os/rt/include/chsys.h ****  *
  71:../../../os/rt/include/chsys.h ****  * @param[in] prio      the priority level
  72:../../../os/rt/include/chsys.h ****  * @return              Priority range result.
  73:../../../os/rt/include/chsys.h ****  * @retval false        if the priority is invalid or if the architecture
  74:../../../os/rt/include/chsys.h ****  *                      does not support priorities.
  75:../../../os/rt/include/chsys.h ****  * @retval true         if the priority is valid.
  76:../../../os/rt/include/chsys.h ****  */
  77:../../../os/rt/include/chsys.h **** #if defined(PORT_IRQ_IS_VALID_PRIORITY) || defined(__DOXYGEN__)
  78:../../../os/rt/include/chsys.h **** #define CH_IRQ_IS_VALID_PRIORITY(prio)                                      \
  79:../../../os/rt/include/chsys.h ****   PORT_IRQ_IS_VALID_PRIORITY(prio)
  80:../../../os/rt/include/chsys.h **** #else
  81:../../../os/rt/include/chsys.h **** #define CH_IRQ_IS_VALID_PRIORITY(prio) false
  82:../../../os/rt/include/chsys.h **** #endif
  83:../../../os/rt/include/chsys.h **** 
  84:../../../os/rt/include/chsys.h **** /**
  85:../../../os/rt/include/chsys.h ****  * @brief   Priority level validation macro.
  86:../../../os/rt/include/chsys.h ****  * @details This macro determines if the passed value is a valid priority
  87:../../../os/rt/include/chsys.h ****  *          level that cannot preempt the kernel critical zone.
  88:../../../os/rt/include/chsys.h ****  *
  89:../../../os/rt/include/chsys.h ****  * @param[in] prio      the priority level
  90:../../../os/rt/include/chsys.h ****  * @return              Priority range result.
  91:../../../os/rt/include/chsys.h ****  * @retval false        if the priority is invalid or if the architecture
  92:../../../os/rt/include/chsys.h ****  *                      does not support priorities.
  93:../../../os/rt/include/chsys.h ****  * @retval true         if the priority is valid.
  94:../../../os/rt/include/chsys.h ****  */
  95:../../../os/rt/include/chsys.h **** #if defined(PORT_IRQ_IS_VALID_KERNEL_PRIORITY) || defined(__DOXYGEN__)
  96:../../../os/rt/include/chsys.h **** #define CH_IRQ_IS_VALID_KERNEL_PRIORITY(prio)                               \
  97:../../../os/rt/include/chsys.h ****   PORT_IRQ_IS_VALID_KERNEL_PRIORITY(prio)
  98:../../../os/rt/include/chsys.h **** #else
  99:../../../os/rt/include/chsys.h **** #define CH_IRQ_IS_VALID_KERNEL_PRIORITY(prio) false
 100:../../../os/rt/include/chsys.h **** #endif
 101:../../../os/rt/include/chsys.h **** 
 102:../../../os/rt/include/chsys.h **** /**
 103:../../../os/rt/include/chsys.h ****  * @brief   IRQ handler enter code.
 104:../../../os/rt/include/chsys.h ****  * @note    Usually IRQ handlers functions are also declared naked.
 105:../../../os/rt/include/chsys.h ****  * @note    On some architectures this macro can be empty.
 106:../../../os/rt/include/chsys.h ****  *
 107:../../../os/rt/include/chsys.h ****  * @special
 108:../../../os/rt/include/chsys.h ****  */
 109:../../../os/rt/include/chsys.h **** #define CH_IRQ_PROLOGUE()                                                   \
 110:../../../os/rt/include/chsys.h ****   PORT_IRQ_PROLOGUE();                                                      \
 111:../../../os/rt/include/chsys.h ****   CH_CFG_IRQ_PROLOGUE_HOOK();                                               \
 112:../../../os/rt/include/chsys.h ****   _stats_increase_irq();                                                    \
 113:../../../os/rt/include/chsys.h ****   _trace_isr_enter(__func__);                                               \
 114:../../../os/rt/include/chsys.h ****   _dbg_check_enter_isr()
 115:../../../os/rt/include/chsys.h **** 
 116:../../../os/rt/include/chsys.h **** /**
 117:../../../os/rt/include/chsys.h ****  * @brief   IRQ handler exit code.
 118:../../../os/rt/include/chsys.h ****  * @note    Usually IRQ handlers function are also declared naked.
 119:../../../os/rt/include/chsys.h ****  * @note    This macro usually performs the final reschedule by using
 120:../../../os/rt/include/chsys.h ****  *          @p chSchIsPreemptionRequired() and @p chSchDoReschedule().
 121:../../../os/rt/include/chsys.h ****  *
 122:../../../os/rt/include/chsys.h ****  * @special
 123:../../../os/rt/include/chsys.h ****  */
 124:../../../os/rt/include/chsys.h **** #define CH_IRQ_EPILOGUE()                                                   \
 125:../../../os/rt/include/chsys.h ****   _dbg_check_leave_isr();                                                   \
 126:../../../os/rt/include/chsys.h ****   _trace_isr_leave(__func__);                                               \
 127:../../../os/rt/include/chsys.h ****   CH_CFG_IRQ_EPILOGUE_HOOK();                                               \
 128:../../../os/rt/include/chsys.h ****   PORT_IRQ_EPILOGUE()
 129:../../../os/rt/include/chsys.h **** 
 130:../../../os/rt/include/chsys.h **** /**
 131:../../../os/rt/include/chsys.h ****  * @brief   Standard normal IRQ handler declaration.
 132:../../../os/rt/include/chsys.h ****  * @note    @p id can be a function name or a vector number depending on the
 133:../../../os/rt/include/chsys.h ****  *          port implementation.
 134:../../../os/rt/include/chsys.h ****  *
 135:../../../os/rt/include/chsys.h ****  * @special
 136:../../../os/rt/include/chsys.h ****  */
 137:../../../os/rt/include/chsys.h **** #define CH_IRQ_HANDLER(id) PORT_IRQ_HANDLER(id)
 138:../../../os/rt/include/chsys.h **** /** @} */
 139:../../../os/rt/include/chsys.h **** 
 140:../../../os/rt/include/chsys.h **** /**
 141:../../../os/rt/include/chsys.h ****  * @name    Fast ISRs abstraction macros
 142:../../../os/rt/include/chsys.h ****  */
 143:../../../os/rt/include/chsys.h **** /**
 144:../../../os/rt/include/chsys.h ****  * @brief   Standard fast IRQ handler declaration.
 145:../../../os/rt/include/chsys.h ****  * @note    @p id can be a function name or a vector number depending on the
 146:../../../os/rt/include/chsys.h ****  *          port implementation.
 147:../../../os/rt/include/chsys.h ****  * @note    Not all architectures support fast interrupts.
 148:../../../os/rt/include/chsys.h ****  *
 149:../../../os/rt/include/chsys.h ****  * @special
 150:../../../os/rt/include/chsys.h ****  */
 151:../../../os/rt/include/chsys.h **** #define CH_FAST_IRQ_HANDLER(id) PORT_FAST_IRQ_HANDLER(id)
 152:../../../os/rt/include/chsys.h **** /** @} */
 153:../../../os/rt/include/chsys.h **** 
 154:../../../os/rt/include/chsys.h **** /**
 155:../../../os/rt/include/chsys.h ****  * @name    Time conversion utilities for the realtime counter
 156:../../../os/rt/include/chsys.h ****  * @{
 157:../../../os/rt/include/chsys.h ****  */
 158:../../../os/rt/include/chsys.h **** /**
 159:../../../os/rt/include/chsys.h ****  * @brief   Seconds to realtime counter.
 160:../../../os/rt/include/chsys.h ****  * @details Converts from seconds to realtime counter cycles.
 161:../../../os/rt/include/chsys.h ****  * @note    The macro assumes that @p freq >= @p 1.
 162:../../../os/rt/include/chsys.h ****  *
 163:../../../os/rt/include/chsys.h ****  * @param[in] freq      clock frequency, in Hz, of the realtime counter
 164:../../../os/rt/include/chsys.h ****  * @param[in] sec       number of seconds
 165:../../../os/rt/include/chsys.h ****  * @return              The number of cycles.
 166:../../../os/rt/include/chsys.h ****  *
 167:../../../os/rt/include/chsys.h ****  * @api
 168:../../../os/rt/include/chsys.h ****  */
 169:../../../os/rt/include/chsys.h **** #define S2RTC(freq, sec) ((freq) * (sec))
 170:../../../os/rt/include/chsys.h **** 
 171:../../../os/rt/include/chsys.h **** /**
 172:../../../os/rt/include/chsys.h ****  * @brief   Milliseconds to realtime counter.
 173:../../../os/rt/include/chsys.h ****  * @details Converts from milliseconds to realtime counter cycles.
 174:../../../os/rt/include/chsys.h ****  * @note    The result is rounded upward to the next millisecond boundary.
 175:../../../os/rt/include/chsys.h ****  * @note    The macro assumes that @p freq >= @p 1000.
 176:../../../os/rt/include/chsys.h ****  *
 177:../../../os/rt/include/chsys.h ****  * @param[in] freq      clock frequency, in Hz, of the realtime counter
 178:../../../os/rt/include/chsys.h ****  * @param[in] msec      number of milliseconds
 179:../../../os/rt/include/chsys.h ****  * @return              The number of cycles.
 180:../../../os/rt/include/chsys.h ****  *
 181:../../../os/rt/include/chsys.h ****  * @api
 182:../../../os/rt/include/chsys.h ****  */
 183:../../../os/rt/include/chsys.h **** #define MS2RTC(freq, msec) (rtcnt_t)((((freq) + 999UL) / 1000UL) * (msec))
 184:../../../os/rt/include/chsys.h **** 
 185:../../../os/rt/include/chsys.h **** /**
 186:../../../os/rt/include/chsys.h ****  * @brief   Microseconds to realtime counter.
 187:../../../os/rt/include/chsys.h ****  * @details Converts from microseconds to realtime counter cycles.
 188:../../../os/rt/include/chsys.h ****  * @note    The result is rounded upward to the next microsecond boundary.
 189:../../../os/rt/include/chsys.h ****  * @note    The macro assumes that @p freq >= @p 1000000.
 190:../../../os/rt/include/chsys.h ****  *
 191:../../../os/rt/include/chsys.h ****  * @param[in] freq      clock frequency, in Hz, of the realtime counter
 192:../../../os/rt/include/chsys.h ****  * @param[in] usec      number of microseconds
 193:../../../os/rt/include/chsys.h ****  * @return              The number of cycles.
 194:../../../os/rt/include/chsys.h ****  *
 195:../../../os/rt/include/chsys.h ****  * @api
 196:../../../os/rt/include/chsys.h ****  */
 197:../../../os/rt/include/chsys.h **** #define US2RTC(freq, usec) (rtcnt_t)((((freq) + 999999UL) / 1000000UL) * (usec))
 198:../../../os/rt/include/chsys.h **** 
 199:../../../os/rt/include/chsys.h **** /**
 200:../../../os/rt/include/chsys.h ****  * @brief   Realtime counter cycles to seconds.
 201:../../../os/rt/include/chsys.h ****  * @details Converts from realtime counter cycles number to seconds.
 202:../../../os/rt/include/chsys.h ****  * @note    The result is rounded up to the next second boundary.
 203:../../../os/rt/include/chsys.h ****  * @note    The macro assumes that @p freq >= @p 1.
 204:../../../os/rt/include/chsys.h ****  *
 205:../../../os/rt/include/chsys.h ****  * @param[in] freq      clock frequency, in Hz, of the realtime counter
 206:../../../os/rt/include/chsys.h ****  * @param[in] n         number of cycles
 207:../../../os/rt/include/chsys.h ****  * @return              The number of seconds.
 208:../../../os/rt/include/chsys.h ****  *
 209:../../../os/rt/include/chsys.h ****  * @api
 210:../../../os/rt/include/chsys.h ****  */
 211:../../../os/rt/include/chsys.h **** #define RTC2S(freq, n) ((((n) - 1UL) / (freq)) + 1UL)
 212:../../../os/rt/include/chsys.h **** 
 213:../../../os/rt/include/chsys.h **** /**
 214:../../../os/rt/include/chsys.h ****  * @brief   Realtime counter cycles to milliseconds.
 215:../../../os/rt/include/chsys.h ****  * @details Converts from realtime counter cycles number to milliseconds.
 216:../../../os/rt/include/chsys.h ****  * @note    The result is rounded up to the next millisecond boundary.
 217:../../../os/rt/include/chsys.h ****  * @note    The macro assumes that @p freq >= @p 1000.
 218:../../../os/rt/include/chsys.h ****  *
 219:../../../os/rt/include/chsys.h ****  * @param[in] freq      clock frequency, in Hz, of the realtime counter
 220:../../../os/rt/include/chsys.h ****  * @param[in] n         number of cycles
 221:../../../os/rt/include/chsys.h ****  * @return              The number of milliseconds.
 222:../../../os/rt/include/chsys.h ****  *
 223:../../../os/rt/include/chsys.h ****  * @api
 224:../../../os/rt/include/chsys.h ****  */
 225:../../../os/rt/include/chsys.h **** #define RTC2MS(freq, n) ((((n) - 1UL) / ((freq) / 1000UL)) + 1UL)
 226:../../../os/rt/include/chsys.h **** 
 227:../../../os/rt/include/chsys.h **** /**
 228:../../../os/rt/include/chsys.h ****  * @brief   Realtime counter cycles to microseconds.
 229:../../../os/rt/include/chsys.h ****  * @details Converts from realtime counter cycles number to microseconds.
 230:../../../os/rt/include/chsys.h ****  * @note    The result is rounded up to the next microsecond boundary.
 231:../../../os/rt/include/chsys.h ****  * @note    The macro assumes that @p freq >= @p 1000000.
 232:../../../os/rt/include/chsys.h ****  *
 233:../../../os/rt/include/chsys.h ****  * @param[in] freq      clock frequency, in Hz, of the realtime counter
 234:../../../os/rt/include/chsys.h ****  * @param[in] n         number of cycles
 235:../../../os/rt/include/chsys.h ****  * @return              The number of microseconds.
 236:../../../os/rt/include/chsys.h ****  *
 237:../../../os/rt/include/chsys.h ****  * @api
 238:../../../os/rt/include/chsys.h ****  */
 239:../../../os/rt/include/chsys.h **** #define RTC2US(freq, n) ((((n) - 1UL) / ((freq) / 1000000UL)) + 1UL)
 240:../../../os/rt/include/chsys.h **** /** @} */
 241:../../../os/rt/include/chsys.h **** 
 242:../../../os/rt/include/chsys.h **** /**
 243:../../../os/rt/include/chsys.h ****  * @brief   Returns the current value of the system real time counter.
 244:../../../os/rt/include/chsys.h ****  * @note    This function is only available if the port layer supports the
 245:../../../os/rt/include/chsys.h ****  *          option @p PORT_SUPPORTS_RT.
 246:../../../os/rt/include/chsys.h ****  *
 247:../../../os/rt/include/chsys.h ****  * @return              The value of the system realtime counter of
 248:../../../os/rt/include/chsys.h ****  *                      type rtcnt_t.
 249:../../../os/rt/include/chsys.h ****  *
 250:../../../os/rt/include/chsys.h ****  * @xclass
 251:../../../os/rt/include/chsys.h ****  */
 252:../../../os/rt/include/chsys.h **** #if (PORT_SUPPORTS_RT == TRUE) || defined(__DOXYGEN__)
 253:../../../os/rt/include/chsys.h **** #define chSysGetRealtimeCounterX() (rtcnt_t)port_rt_get_counter_value()
 254:../../../os/rt/include/chsys.h **** #endif
 255:../../../os/rt/include/chsys.h **** 
 256:../../../os/rt/include/chsys.h **** /**
 257:../../../os/rt/include/chsys.h ****  * @brief   Performs a context switch.
 258:../../../os/rt/include/chsys.h ****  * @note    Not a user function, it is meant to be invoked by the scheduler
 259:../../../os/rt/include/chsys.h ****  *          itself or from within the port layer.
 260:../../../os/rt/include/chsys.h ****  *
 261:../../../os/rt/include/chsys.h ****  * @param[in] ntp       the thread to be switched in
 262:../../../os/rt/include/chsys.h ****  * @param[in] otp       the thread to be switched out
 263:../../../os/rt/include/chsys.h ****  *
 264:../../../os/rt/include/chsys.h ****  * @special
 265:../../../os/rt/include/chsys.h ****  */
 266:../../../os/rt/include/chsys.h **** #define chSysSwitch(ntp, otp) {                                             \
 267:../../../os/rt/include/chsys.h ****                                                                             \
 268:../../../os/rt/include/chsys.h ****   _trace_switch(ntp, otp);                                                  \
 269:../../../os/rt/include/chsys.h ****   _stats_ctxswc(ntp, otp);                                                  \
 270:../../../os/rt/include/chsys.h ****   CH_CFG_CONTEXT_SWITCH_HOOK(ntp, otp);                                     \
 271:../../../os/rt/include/chsys.h ****   port_switch(ntp, otp);                                                    \
 272:../../../os/rt/include/chsys.h **** }
 273:../../../os/rt/include/chsys.h **** 
 274:../../../os/rt/include/chsys.h **** /*===========================================================================*/
 275:../../../os/rt/include/chsys.h **** /* External declarations.                                                    */
 276:../../../os/rt/include/chsys.h **** /*===========================================================================*/
 277:../../../os/rt/include/chsys.h **** 
 278:../../../os/rt/include/chsys.h **** #if !defined(__DOXYGEN__)
 279:../../../os/rt/include/chsys.h **** extern stkalign_t ch_idle_thread_wa[];
 280:../../../os/rt/include/chsys.h **** #endif
 281:../../../os/rt/include/chsys.h **** 
 282:../../../os/rt/include/chsys.h **** #ifdef __cplusplus
 283:../../../os/rt/include/chsys.h **** extern "C" {
 284:../../../os/rt/include/chsys.h **** #endif
 285:../../../os/rt/include/chsys.h ****   void chSysInit(void);
 286:../../../os/rt/include/chsys.h ****   bool chSysIntegrityCheckI(unsigned testmask);
 287:../../../os/rt/include/chsys.h ****   void chSysTimerHandlerI(void);
 288:../../../os/rt/include/chsys.h ****   syssts_t chSysGetStatusAndLockX(void);
 289:../../../os/rt/include/chsys.h ****   void chSysRestoreStatusX(syssts_t sts);
 290:../../../os/rt/include/chsys.h **** #if PORT_SUPPORTS_RT == TRUE
 291:../../../os/rt/include/chsys.h ****   bool chSysIsCounterWithinX(rtcnt_t cnt, rtcnt_t start, rtcnt_t end);
 292:../../../os/rt/include/chsys.h ****   void chSysPolledDelayX(rtcnt_t cycles);
 293:../../../os/rt/include/chsys.h **** #endif
 294:../../../os/rt/include/chsys.h **** #ifdef __cplusplus
 295:../../../os/rt/include/chsys.h **** }
 296:../../../os/rt/include/chsys.h **** #endif
 297:../../../os/rt/include/chsys.h **** 
 298:../../../os/rt/include/chsys.h **** /*===========================================================================*/
 299:../../../os/rt/include/chsys.h **** /* Module inline functions.                                                  */
 300:../../../os/rt/include/chsys.h **** /*===========================================================================*/
 301:../../../os/rt/include/chsys.h **** 
 302:../../../os/rt/include/chsys.h **** /**
 303:../../../os/rt/include/chsys.h ****  * @brief   Raises the system interrupt priority mask to the maximum level.
 304:../../../os/rt/include/chsys.h ****  * @details All the maskable interrupt sources are disabled regardless their
 305:../../../os/rt/include/chsys.h ****  *          hardware priority.
 306:../../../os/rt/include/chsys.h ****  * @note    Do not invoke this API from within a kernel lock.
 307:../../../os/rt/include/chsys.h ****  *
 308:../../../os/rt/include/chsys.h ****  * @special
 309:../../../os/rt/include/chsys.h ****  */
 310:../../../os/rt/include/chsys.h **** static inline void chSysDisable(void) {
 311:../../../os/rt/include/chsys.h **** 
 312:../../../os/rt/include/chsys.h ****   port_disable();
 313:../../../os/rt/include/chsys.h ****   _dbg_check_disable();
 314:../../../os/rt/include/chsys.h **** }
 315:../../../os/rt/include/chsys.h **** 
 316:../../../os/rt/include/chsys.h **** /**
 317:../../../os/rt/include/chsys.h ****  * @brief   Raises the system interrupt priority mask to system level.
 318:../../../os/rt/include/chsys.h ****  * @details The interrupt sources that should not be able to preempt the kernel
 319:../../../os/rt/include/chsys.h ****  *          are disabled, interrupt sources with higher priority are still
 320:../../../os/rt/include/chsys.h ****  *          enabled.
 321:../../../os/rt/include/chsys.h ****  * @note    Do not invoke this API from within a kernel lock.
 322:../../../os/rt/include/chsys.h ****  * @note    This API is no replacement for @p chSysLock(), the @p chSysLock()
 323:../../../os/rt/include/chsys.h ****  *          could do more than just disable the interrupts.
 324:../../../os/rt/include/chsys.h ****  *
 325:../../../os/rt/include/chsys.h ****  * @special
 326:../../../os/rt/include/chsys.h ****  */
 327:../../../os/rt/include/chsys.h **** static inline void chSysSuspend(void) {
 328:../../../os/rt/include/chsys.h **** 
 329:../../../os/rt/include/chsys.h ****   port_suspend();
 330:../../../os/rt/include/chsys.h ****   _dbg_check_suspend();
 331:../../../os/rt/include/chsys.h **** }
 332:../../../os/rt/include/chsys.h **** 
 333:../../../os/rt/include/chsys.h **** /**
 334:../../../os/rt/include/chsys.h ****  * @brief   Lowers the system interrupt priority mask to user level.
 335:../../../os/rt/include/chsys.h ****  * @details All the interrupt sources are enabled.
 336:../../../os/rt/include/chsys.h ****  * @note    Do not invoke this API from within a kernel lock.
 337:../../../os/rt/include/chsys.h ****  * @note    This API is no replacement for @p chSysUnlock(), the
 338:../../../os/rt/include/chsys.h ****  *          @p chSysUnlock() could do more than just enable the interrupts.
 339:../../../os/rt/include/chsys.h ****  *
 340:../../../os/rt/include/chsys.h ****  * @special
 341:../../../os/rt/include/chsys.h ****  */
 342:../../../os/rt/include/chsys.h **** static inline void chSysEnable(void) {
 343:../../../os/rt/include/chsys.h **** 
 344:../../../os/rt/include/chsys.h ****   _dbg_check_enable();
 345:../../../os/rt/include/chsys.h ****   port_enable();
 346:../../../os/rt/include/chsys.h **** }
 347:../../../os/rt/include/chsys.h **** 
 348:../../../os/rt/include/chsys.h **** /**
 349:../../../os/rt/include/chsys.h ****  * @brief   Enters the kernel lock state.
 350:../../../os/rt/include/chsys.h ****  *
 351:../../../os/rt/include/chsys.h ****  * @special
 352:../../../os/rt/include/chsys.h ****  */
 353:../../../os/rt/include/chsys.h **** static inline void chSysLock(void) {
 122               		.loc 3 353 20 view .LVU29
 123               	.LBE88:
 124               	.LBE92:
 354:../../../os/rt/include/chsys.h **** 
 355:../../../os/rt/include/chsys.h ****   port_lock();
 125               		.loc 3 355 3 view .LVU30
 126               	.LBB93:
 127               	.LBB91:
 128               	.LBB89:
 129               	.LBI89:
 130               		.file 4 "../../../os/common/ports/AVR/chcore.h"
   1:../../../os/common/ports/AVR/chcore.h **** /*
   2:../../../os/common/ports/AVR/chcore.h ****     ChibiOS - Copyright (C) 2006..2018 Giovanni Di Sirio.
   3:../../../os/common/ports/AVR/chcore.h **** 
   4:../../../os/common/ports/AVR/chcore.h ****     This file is part of ChibiOS.
   5:../../../os/common/ports/AVR/chcore.h **** 
   6:../../../os/common/ports/AVR/chcore.h ****     ChibiOS is free software; you can redistribute it and/or modify
   7:../../../os/common/ports/AVR/chcore.h ****     it under the terms of the GNU General Public License as published by
   8:../../../os/common/ports/AVR/chcore.h ****     the Free Software Foundation; either version 3 of the License, or
   9:../../../os/common/ports/AVR/chcore.h ****     (at your option) any later version.
  10:../../../os/common/ports/AVR/chcore.h **** 
  11:../../../os/common/ports/AVR/chcore.h ****     ChibiOS is distributed in the hope that it will be useful,
  12:../../../os/common/ports/AVR/chcore.h ****     but WITHOUT ANY WARRANTY; without even the implied warranty of
  13:../../../os/common/ports/AVR/chcore.h ****     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  14:../../../os/common/ports/AVR/chcore.h ****     GNU General Public License for more details.
  15:../../../os/common/ports/AVR/chcore.h **** 
  16:../../../os/common/ports/AVR/chcore.h ****     You should have received a copy of the GNU General Public License
  17:../../../os/common/ports/AVR/chcore.h ****     along with this program.  If not, see <http://www.gnu.org/licenses/>.
  18:../../../os/common/ports/AVR/chcore.h **** */
  19:../../../os/common/ports/AVR/chcore.h **** 
  20:../../../os/common/ports/AVR/chcore.h **** /**
  21:../../../os/common/ports/AVR/chcore.h ****  * @file    templates/chcore.h
  22:../../../os/common/ports/AVR/chcore.h ****  * @brief   Port related template macros and structures.
  23:../../../os/common/ports/AVR/chcore.h ****  * @details This file is a template of the system driver macros provided by
  24:../../../os/common/ports/AVR/chcore.h ****  *          a port.
  25:../../../os/common/ports/AVR/chcore.h ****  *
  26:../../../os/common/ports/AVR/chcore.h ****  * @addtogroup core
  27:../../../os/common/ports/AVR/chcore.h ****  * @{
  28:../../../os/common/ports/AVR/chcore.h ****  */
  29:../../../os/common/ports/AVR/chcore.h **** 
  30:../../../os/common/ports/AVR/chcore.h **** #ifndef CHCORE_H
  31:../../../os/common/ports/AVR/chcore.h **** #define CHCORE_H
  32:../../../os/common/ports/AVR/chcore.h **** 
  33:../../../os/common/ports/AVR/chcore.h **** #include <avr/io.h>
  34:../../../os/common/ports/AVR/chcore.h **** #include <avr/interrupt.h>
  35:../../../os/common/ports/AVR/chcore.h **** 
  36:../../../os/common/ports/AVR/chcore.h **** extern bool __avr_in_isr;
  37:../../../os/common/ports/AVR/chcore.h **** 
  38:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
  39:../../../os/common/ports/AVR/chcore.h **** /* Module constants.                                                         */
  40:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
  41:../../../os/common/ports/AVR/chcore.h **** 
  42:../../../os/common/ports/AVR/chcore.h **** /**
  43:../../../os/common/ports/AVR/chcore.h ****  * @name    Port Capabilities and Constants
  44:../../../os/common/ports/AVR/chcore.h ****  * @{
  45:../../../os/common/ports/AVR/chcore.h ****  */
  46:../../../os/common/ports/AVR/chcore.h **** /**
  47:../../../os/common/ports/AVR/chcore.h ****  * @brief   This port supports a realtime counter.
  48:../../../os/common/ports/AVR/chcore.h ****  */
  49:../../../os/common/ports/AVR/chcore.h **** #define PORT_SUPPORTS_RT                FALSE
  50:../../../os/common/ports/AVR/chcore.h **** 
  51:../../../os/common/ports/AVR/chcore.h **** /**
  52:../../../os/common/ports/AVR/chcore.h ****  * @brief   Natural alignment constant.
  53:../../../os/common/ports/AVR/chcore.h ****  * @note    It is the minimum alignment for pointer-size variables.
  54:../../../os/common/ports/AVR/chcore.h ****  */
  55:../../../os/common/ports/AVR/chcore.h **** #define PORT_NATURAL_ALIGN              1U
  56:../../../os/common/ports/AVR/chcore.h **** 
  57:../../../os/common/ports/AVR/chcore.h **** /**
  58:../../../os/common/ports/AVR/chcore.h ****  * @brief   Stack alignment constant.
  59:../../../os/common/ports/AVR/chcore.h ****  * @note    It is the alignement required for the stack pointer.
  60:../../../os/common/ports/AVR/chcore.h ****  */
  61:../../../os/common/ports/AVR/chcore.h **** #define PORT_STACK_ALIGN                1U
  62:../../../os/common/ports/AVR/chcore.h **** 
  63:../../../os/common/ports/AVR/chcore.h **** /**
  64:../../../os/common/ports/AVR/chcore.h ****  * @brief   Working Areas alignment constant.
  65:../../../os/common/ports/AVR/chcore.h ****  * @note    It is the alignment to be enforced for thread working areas.
  66:../../../os/common/ports/AVR/chcore.h ****  */
  67:../../../os/common/ports/AVR/chcore.h **** #define PORT_WORKING_AREA_ALIGN         1U
  68:../../../os/common/ports/AVR/chcore.h **** /** @} */
  69:../../../os/common/ports/AVR/chcore.h **** 
  70:../../../os/common/ports/AVR/chcore.h **** /**
  71:../../../os/common/ports/AVR/chcore.h ****  * @name    Architecture and Compiler
  72:../../../os/common/ports/AVR/chcore.h ****  * @{
  73:../../../os/common/ports/AVR/chcore.h ****  */
  74:../../../os/common/ports/AVR/chcore.h **** /**
  75:../../../os/common/ports/AVR/chcore.h ****  * @brief   Macro defining an AVR architecture.
  76:../../../os/common/ports/AVR/chcore.h ****  */
  77:../../../os/common/ports/AVR/chcore.h **** #define PORT_ARCHITECTURE_AVR
  78:../../../os/common/ports/AVR/chcore.h **** 
  79:../../../os/common/ports/AVR/chcore.h **** /**
  80:../../../os/common/ports/AVR/chcore.h ****  * @brief   Macro defining the specific AVR architecture.
  81:../../../os/common/ports/AVR/chcore.h ****  */
  82:../../../os/common/ports/AVR/chcore.h **** #define PORT_ARCHITECTURE_AVR_MEGAAVR
  83:../../../os/common/ports/AVR/chcore.h **** 
  84:../../../os/common/ports/AVR/chcore.h **** /**
  85:../../../os/common/ports/AVR/chcore.h ****  * @brief   Name of the implemented architecture.
  86:../../../os/common/ports/AVR/chcore.h ****  */
  87:../../../os/common/ports/AVR/chcore.h **** #define PORT_ARCHITECTURE_NAME          "MegaAVR"
  88:../../../os/common/ports/AVR/chcore.h **** 
  89:../../../os/common/ports/AVR/chcore.h **** /**
  90:../../../os/common/ports/AVR/chcore.h ****  * @brief   Compiler name and version.
  91:../../../os/common/ports/AVR/chcore.h ****  */
  92:../../../os/common/ports/AVR/chcore.h **** #if defined(__GNUC__) || defined(__DOXYGEN__)
  93:../../../os/common/ports/AVR/chcore.h **** #define PORT_COMPILER_NAME              "GCC " __VERSION__
  94:../../../os/common/ports/AVR/chcore.h **** 
  95:../../../os/common/ports/AVR/chcore.h **** #else
  96:../../../os/common/ports/AVR/chcore.h **** #error "unsupported compiler"
  97:../../../os/common/ports/AVR/chcore.h **** #endif
  98:../../../os/common/ports/AVR/chcore.h **** 
  99:../../../os/common/ports/AVR/chcore.h **** /**
 100:../../../os/common/ports/AVR/chcore.h ****  * @brief   Port-specific information string.
 101:../../../os/common/ports/AVR/chcore.h ****  */
 102:../../../os/common/ports/AVR/chcore.h **** #define PORT_INFO                       "None"
 103:../../../os/common/ports/AVR/chcore.h **** /** @} */
 104:../../../os/common/ports/AVR/chcore.h **** 
 105:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
 106:../../../os/common/ports/AVR/chcore.h **** /* Module pre-compile time settings.                                         */
 107:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
 108:../../../os/common/ports/AVR/chcore.h **** 
 109:../../../os/common/ports/AVR/chcore.h **** /**
 110:../../../os/common/ports/AVR/chcore.h ****  * @brief   Stack size for the system idle thread.
 111:../../../os/common/ports/AVR/chcore.h ****  * @details This size depends on the idle thread implementation, usually
 112:../../../os/common/ports/AVR/chcore.h ****  *          the idle thread should take no more space than those reserved
 113:../../../os/common/ports/AVR/chcore.h ****  *          by @p PORT_INT_REQUIRED_STACK.
 114:../../../os/common/ports/AVR/chcore.h ****  */
 115:../../../os/common/ports/AVR/chcore.h **** #if !defined(PORT_IDLE_THREAD_STACK_SIZE) || defined(__DOXYGEN__)
 116:../../../os/common/ports/AVR/chcore.h **** #define PORT_IDLE_THREAD_STACK_SIZE     8
 117:../../../os/common/ports/AVR/chcore.h **** #endif
 118:../../../os/common/ports/AVR/chcore.h **** 
 119:../../../os/common/ports/AVR/chcore.h **** /**
 120:../../../os/common/ports/AVR/chcore.h ****  * @brief   Per-thread stack overhead for interrupts servicing.
 121:../../../os/common/ports/AVR/chcore.h ****  * @details This constant is used in the calculation of the correct working
 122:../../../os/common/ports/AVR/chcore.h ****  *          area size.
 123:../../../os/common/ports/AVR/chcore.h ****  */
 124:../../../os/common/ports/AVR/chcore.h **** #if !defined(PORT_INT_REQUIRED_STACK) || defined(__DOXYGEN__)
 125:../../../os/common/ports/AVR/chcore.h **** #define PORT_INT_REQUIRED_STACK         32
 126:../../../os/common/ports/AVR/chcore.h **** #endif
 127:../../../os/common/ports/AVR/chcore.h **** 
 128:../../../os/common/ports/AVR/chcore.h **** /**
 129:../../../os/common/ports/AVR/chcore.h ****  * @brief   Enables an alternative timer implementation.
 130:../../../os/common/ports/AVR/chcore.h ****  * @details Usually the port uses a timer interface defined in the file
 131:../../../os/common/ports/AVR/chcore.h ****  *          @p chcore_timer.h, if this option is enabled then the file
 132:../../../os/common/ports/AVR/chcore.h ****  *          @p chcore_timer_alt.h is included instead.
 133:../../../os/common/ports/AVR/chcore.h ****  */
 134:../../../os/common/ports/AVR/chcore.h **** #if !defined(PORT_USE_ALT_TIMER) || defined(__DOXYGEN__)
 135:../../../os/common/ports/AVR/chcore.h **** #define PORT_USE_ALT_TIMER              FALSE
 136:../../../os/common/ports/AVR/chcore.h **** #endif
 137:../../../os/common/ports/AVR/chcore.h **** 
 138:../../../os/common/ports/AVR/chcore.h **** /**
 139:../../../os/common/ports/AVR/chcore.h ****  * @brief   Enables a "wait for interrupt" instruction in the idle loop.
 140:../../../os/common/ports/AVR/chcore.h ****  */
 141:../../../os/common/ports/AVR/chcore.h **** #if !defined(PORT_AVR_WFI_SLEEP_IDLE) || defined(__DOXYGEN__)
 142:../../../os/common/ports/AVR/chcore.h **** #define PORT_AVR_WFI_SLEEP_IDLE      FALSE
 143:../../../os/common/ports/AVR/chcore.h **** #endif
 144:../../../os/common/ports/AVR/chcore.h **** 
 145:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
 146:../../../os/common/ports/AVR/chcore.h **** /* Derived constants and error checks.                                       */
 147:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
 148:../../../os/common/ports/AVR/chcore.h **** 
 149:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
 150:../../../os/common/ports/AVR/chcore.h **** /* Module data structures and types.                                         */
 151:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
 152:../../../os/common/ports/AVR/chcore.h **** 
 153:../../../os/common/ports/AVR/chcore.h **** /* The following code is not processed when the file is included from an
 154:../../../os/common/ports/AVR/chcore.h ****    asm module.*/
 155:../../../os/common/ports/AVR/chcore.h **** #if !defined(_FROM_ASM_)
 156:../../../os/common/ports/AVR/chcore.h **** 
 157:../../../os/common/ports/AVR/chcore.h **** /**
 158:../../../os/common/ports/AVR/chcore.h ****  * @brief   Type of stack and memory alignment enforcement.
 159:../../../os/common/ports/AVR/chcore.h ****  * @note    In this architecture the stack alignment is enforced to 8 bits.
 160:../../../os/common/ports/AVR/chcore.h ****  */
 161:../../../os/common/ports/AVR/chcore.h **** typedef uint8_t stkalign_t;
 162:../../../os/common/ports/AVR/chcore.h **** 
 163:../../../os/common/ports/AVR/chcore.h **** /**
 164:../../../os/common/ports/AVR/chcore.h ****  * @brief   Interrupt saved context.
 165:../../../os/common/ports/AVR/chcore.h ****  * @details This structure represents the stack frame saved during a
 166:../../../os/common/ports/AVR/chcore.h ****  *          preemption-capable interrupt handler.
 167:../../../os/common/ports/AVR/chcore.h ****  * @note    R2 and R13 are not saved because those are assumed to be immutable
 168:../../../os/common/ports/AVR/chcore.h ****  *          during the system life cycle.
 169:../../../os/common/ports/AVR/chcore.h ****  */
 170:../../../os/common/ports/AVR/chcore.h **** struct port_extctx {
 171:../../../os/common/ports/AVR/chcore.h ****   uint8_t       _next;
 172:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r31;
 173:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r30;
 174:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r27;
 175:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r26;
 176:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r25;
 177:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r24;
 178:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r23;
 179:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r22;
 180:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r21;
 181:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r20;
 182:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r19;
 183:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r18;
 184:../../../os/common/ports/AVR/chcore.h ****   uint8_t       sr;
 185:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r1;
 186:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r0;
 187:../../../os/common/ports/AVR/chcore.h **** #if defined(__AVR_3_BYTE_PC__)
 188:../../../os/common/ports/AVR/chcore.h ****   uint8_t       pcx;
 189:../../../os/common/ports/AVR/chcore.h **** #endif
 190:../../../os/common/ports/AVR/chcore.h ****   uint16_t      pc;
 191:../../../os/common/ports/AVR/chcore.h **** };
 192:../../../os/common/ports/AVR/chcore.h **** 
 193:../../../os/common/ports/AVR/chcore.h **** /**
 194:../../../os/common/ports/AVR/chcore.h ****  * @brief   System saved context.
 195:../../../os/common/ports/AVR/chcore.h ****  * @details This structure represents the inner stack frame during a context
 196:../../../os/common/ports/AVR/chcore.h ****  *          switching.
 197:../../../os/common/ports/AVR/chcore.h ****  * @note    R2 and R13 are not saved because those are assumed to be immutable
 198:../../../os/common/ports/AVR/chcore.h ****  *          during the system life cycle.
 199:../../../os/common/ports/AVR/chcore.h ****  * @note    LR is stored in the caller context so it is not present in this
 200:../../../os/common/ports/AVR/chcore.h ****  *          structure.
 201:../../../os/common/ports/AVR/chcore.h ****  */
 202:../../../os/common/ports/AVR/chcore.h **** struct port_intctx {
 203:../../../os/common/ports/AVR/chcore.h ****   uint8_t       _next;
 204:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r29;
 205:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r28;
 206:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r17;
 207:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r16;
 208:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r15;
 209:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r14;
 210:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r13;
 211:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r12;
 212:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r11;
 213:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r10;
 214:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r9;
 215:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r8;
 216:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r7;
 217:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r6;
 218:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r5;
 219:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r4;
 220:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r3;
 221:../../../os/common/ports/AVR/chcore.h ****   uint8_t       r2;
 222:../../../os/common/ports/AVR/chcore.h **** #if defined(__AVR_3_BYTE_PC__)
 223:../../../os/common/ports/AVR/chcore.h ****   uint8_t       pcx;
 224:../../../os/common/ports/AVR/chcore.h **** #endif
 225:../../../os/common/ports/AVR/chcore.h ****   uint8_t       pcl;
 226:../../../os/common/ports/AVR/chcore.h ****   uint8_t       pch;
 227:../../../os/common/ports/AVR/chcore.h **** };
 228:../../../os/common/ports/AVR/chcore.h **** 
 229:../../../os/common/ports/AVR/chcore.h **** /**
 230:../../../os/common/ports/AVR/chcore.h ****  * @brief   Platform dependent part of the @p thread_t structure.
 231:../../../os/common/ports/AVR/chcore.h ****  * @details This structure usually contains just the saved stack pointer
 232:../../../os/common/ports/AVR/chcore.h ****  *          defined as a pointer to a @p port_intctx structure.
 233:../../../os/common/ports/AVR/chcore.h ****  */
 234:../../../os/common/ports/AVR/chcore.h **** struct port_context {
 235:../../../os/common/ports/AVR/chcore.h ****   struct port_intctx *sp;
 236:../../../os/common/ports/AVR/chcore.h **** };
 237:../../../os/common/ports/AVR/chcore.h **** 
 238:../../../os/common/ports/AVR/chcore.h **** #endif /* !defined(_FROM_ASM_) */
 239:../../../os/common/ports/AVR/chcore.h **** 
 240:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
 241:../../../os/common/ports/AVR/chcore.h **** /* Module macros.                                                            */
 242:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
 243:../../../os/common/ports/AVR/chcore.h **** 
 244:../../../os/common/ports/AVR/chcore.h **** /**
 245:../../../os/common/ports/AVR/chcore.h ****  * @brief   Platform dependent part of the @p chThdCreateI() API.
 246:../../../os/common/ports/AVR/chcore.h ****  * @details This code usually setup the context switching frame represented
 247:../../../os/common/ports/AVR/chcore.h ****  *          by an @p port_intctx structure.
 248:../../../os/common/ports/AVR/chcore.h ****  */
 249:../../../os/common/ports/AVR/chcore.h **** #if defined(__AVR_3_BYTE_PC__) || defined(__DOXYGEN__)
 250:../../../os/common/ports/AVR/chcore.h **** #define PORT_SETUP_CONTEXT(tp, wbase, wtop, pf, arg) {                      \
 251:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp = (struct port_intctx *)((uint8_t *)(wtop) -                   \
 252:../../../os/common/ports/AVR/chcore.h ****                                       sizeof(struct port_intctx));          \
 253:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->r2  = (uint8_t)(0xff & (uint16_t)pf);                         \
 254:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->r3  = (uint8_t)((uint16_t)(pf) >> 8);                         \
 255:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->r4  = (uint8_t)(0xff & (uint16_t)arg);                        \
 256:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->r5  = (uint8_t)((uint16_t)(arg) >> 8);                        \
 257:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->pcx = (uint8_t)0;                                             \
 258:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->pcl = (uint16_t)_port_thread_start >> 8;                      \
 259:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->pch = (uint8_t)(0xff & (uint16_t)_port_thread_start);         \
 260:../../../os/common/ports/AVR/chcore.h **** }
 261:../../../os/common/ports/AVR/chcore.h **** #else /* !__AVR_3_BYTE_PC__ */
 262:../../../os/common/ports/AVR/chcore.h **** #define PORT_SETUP_CONTEXT(tp, wbase, wtop, pf, arg) {                      \
 263:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp = (struct port_intctx *)((uint8_t *)(wtop) -                   \
 264:../../../os/common/ports/AVR/chcore.h ****                                       sizeof(struct port_intctx));          \
 265:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->r2  = (uint8_t)(0xff & (uint16_t)pf);                         \
 266:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->r3  = (uint8_t)((uint16_t)(pf) >> 8);                         \
 267:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->r4  = (uint8_t)(0xff & (uint16_t)arg);                        \
 268:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->r5  = (uint8_t)((uint16_t)(arg) >> 8);                        \
 269:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->pcl = (uint16_t)_port_thread_start >> 8;                      \
 270:../../../os/common/ports/AVR/chcore.h ****   tp->ctx.sp->pch = (uint8_t)(0xff & (uint16_t)_port_thread_start);         \
 271:../../../os/common/ports/AVR/chcore.h **** }
 272:../../../os/common/ports/AVR/chcore.h **** #endif /* !__AVR_3_BYTE_PC__ */
 273:../../../os/common/ports/AVR/chcore.h **** 
 274:../../../os/common/ports/AVR/chcore.h **** /**
 275:../../../os/common/ports/AVR/chcore.h ****  * @brief   Computes the thread working area global size.
 276:../../../os/common/ports/AVR/chcore.h ****  * @note    There is no need to perform alignments in this macro.
 277:../../../os/common/ports/AVR/chcore.h ****  */
 278:../../../os/common/ports/AVR/chcore.h **** #define PORT_WA_SIZE(n) ((sizeof(struct port_intctx) - 1) +                \
 279:../../../os/common/ports/AVR/chcore.h ****                          (sizeof(struct port_extctx) - 1) +                \
 280:../../../os/common/ports/AVR/chcore.h ****                          ((size_t)(n)) + ((size_t)(PORT_INT_REQUIRED_STACK)))
 281:../../../os/common/ports/AVR/chcore.h **** 
 282:../../../os/common/ports/AVR/chcore.h **** /**
 283:../../../os/common/ports/AVR/chcore.h ****  * @brief   Static working area allocation.
 284:../../../os/common/ports/AVR/chcore.h ****  * @details This macro is used to allocate a static thread working area
 285:../../../os/common/ports/AVR/chcore.h ****  *          aligned as both position and size.
 286:../../../os/common/ports/AVR/chcore.h ****  *
 287:../../../os/common/ports/AVR/chcore.h ****  * @param[in] s         the name to be assigned to the stack array
 288:../../../os/common/ports/AVR/chcore.h ****  * @param[in] n         the stack size to be assigned to the thread
 289:../../../os/common/ports/AVR/chcore.h ****  */
 290:../../../os/common/ports/AVR/chcore.h **** #define PORT_WORKING_AREA(s, n)                                             \
 291:../../../os/common/ports/AVR/chcore.h ****   stkalign_t s[THD_WORKING_AREA_SIZE(n) / sizeof (stkalign_t)]
 292:../../../os/common/ports/AVR/chcore.h **** 
 293:../../../os/common/ports/AVR/chcore.h **** /**
 294:../../../os/common/ports/AVR/chcore.h ****  * @brief   Priority level verification macro.
 295:../../../os/common/ports/AVR/chcore.h ****  */
 296:../../../os/common/ports/AVR/chcore.h **** #define PORT_IRQ_IS_VALID_PRIORITY(n) false
 297:../../../os/common/ports/AVR/chcore.h **** 
 298:../../../os/common/ports/AVR/chcore.h **** /**
 299:../../../os/common/ports/AVR/chcore.h ****  * @brief   Priority level verification macro.
 300:../../../os/common/ports/AVR/chcore.h ****  */
 301:../../../os/common/ports/AVR/chcore.h **** #define PORT_IRQ_IS_VALID_KERNEL_PRIORITY(n) false
 302:../../../os/common/ports/AVR/chcore.h **** 
 303:../../../os/common/ports/AVR/chcore.h **** /**
 304:../../../os/common/ports/AVR/chcore.h ****  * @brief   IRQ prologue code.
 305:../../../os/common/ports/AVR/chcore.h ****  * @details This macro must be inserted at the start of all IRQ handlers
 306:../../../os/common/ports/AVR/chcore.h ****  *          enabled to invoke system APIs.
 307:../../../os/common/ports/AVR/chcore.h ****  * @note    This code tricks the compiler to save all the specified registers
 308:../../../os/common/ports/AVR/chcore.h ****  *          by "touching" them.
 309:../../../os/common/ports/AVR/chcore.h ****  */
 310:../../../os/common/ports/AVR/chcore.h **** #define PORT_IRQ_PROLOGUE() {                                               \
 311:../../../os/common/ports/AVR/chcore.h ****   asm ("" : : : "r18", "r19", "r20", "r21", "r22", "r23", "r24",            \
 312:../../../os/common/ports/AVR/chcore.h ****                 "r25", "r26", "r27", "r30", "r31");                         \
 313:../../../os/common/ports/AVR/chcore.h ****   __avr_in_isr = true;                                                      \
 314:../../../os/common/ports/AVR/chcore.h **** }
 315:../../../os/common/ports/AVR/chcore.h **** 
 316:../../../os/common/ports/AVR/chcore.h **** /**
 317:../../../os/common/ports/AVR/chcore.h ****  * @brief   IRQ epilogue code.
 318:../../../os/common/ports/AVR/chcore.h ****  * @details This macro must be inserted at the end of all IRQ handlers
 319:../../../os/common/ports/AVR/chcore.h ****  *          enabled to invoke system APIs.
 320:../../../os/common/ports/AVR/chcore.h ****  */
 321:../../../os/common/ports/AVR/chcore.h **** #define PORT_IRQ_EPILOGUE() {                                               \
 322:../../../os/common/ports/AVR/chcore.h ****   __avr_in_isr = false;                                                     \
 323:../../../os/common/ports/AVR/chcore.h ****   _dbg_check_lock();                                                        \
 324:../../../os/common/ports/AVR/chcore.h ****   if (chSchIsPreemptionRequired())                                          \
 325:../../../os/common/ports/AVR/chcore.h ****     chSchDoReschedule();                                                    \
 326:../../../os/common/ports/AVR/chcore.h ****   _dbg_check_unlock();                                                      \
 327:../../../os/common/ports/AVR/chcore.h **** }
 328:../../../os/common/ports/AVR/chcore.h **** 
 329:../../../os/common/ports/AVR/chcore.h **** /**
 330:../../../os/common/ports/AVR/chcore.h ****  * @brief   IRQ handler function declaration.
 331:../../../os/common/ports/AVR/chcore.h ****  * @note    @p id can be a function name or a vector number depending on the
 332:../../../os/common/ports/AVR/chcore.h ****  *          port implementation.
 333:../../../os/common/ports/AVR/chcore.h ****  */
 334:../../../os/common/ports/AVR/chcore.h **** #define PORT_IRQ_HANDLER(id) ISR(id)
 335:../../../os/common/ports/AVR/chcore.h **** 
 336:../../../os/common/ports/AVR/chcore.h **** /**
 337:../../../os/common/ports/AVR/chcore.h ****  * @brief   Fast IRQ handler function declaration.
 338:../../../os/common/ports/AVR/chcore.h ****  * @note    @p id can be a function name or a vector number depending on the
 339:../../../os/common/ports/AVR/chcore.h ****  *          port implementation.
 340:../../../os/common/ports/AVR/chcore.h ****  */
 341:../../../os/common/ports/AVR/chcore.h **** #define PORT_FAST_IRQ_HANDLER(id) ISR(id)
 342:../../../os/common/ports/AVR/chcore.h **** 
 343:../../../os/common/ports/AVR/chcore.h **** /**
 344:../../../os/common/ports/AVR/chcore.h ****  * @brief   Performs a context switch between two threads.
 345:../../../os/common/ports/AVR/chcore.h ****  * @details This is the most critical code in any port, this function
 346:../../../os/common/ports/AVR/chcore.h ****  *          is responsible for the context switch between 2 threads.
 347:../../../os/common/ports/AVR/chcore.h ****  * @note    The implementation of this code affects <b>directly</b> the context
 348:../../../os/common/ports/AVR/chcore.h ****  *          switch performance so optimize here as much as you can.
 349:../../../os/common/ports/AVR/chcore.h ****  *
 350:../../../os/common/ports/AVR/chcore.h ****  * @param[in] ntp       the thread to be switched in
 351:../../../os/common/ports/AVR/chcore.h ****  * @param[in] otp       the thread to be switched out
 352:../../../os/common/ports/AVR/chcore.h ****  */
 353:../../../os/common/ports/AVR/chcore.h **** #define port_switch(ntp, otp) {                                             \
 354:../../../os/common/ports/AVR/chcore.h ****   _port_switch(ntp, otp);                                                   \
 355:../../../os/common/ports/AVR/chcore.h ****   asm volatile ("" : : : "memory");                                         \
 356:../../../os/common/ports/AVR/chcore.h **** }
 357:../../../os/common/ports/AVR/chcore.h **** 
 358:../../../os/common/ports/AVR/chcore.h **** 
 359:../../../os/common/ports/AVR/chcore.h **** /**
 360:../../../os/common/ports/AVR/chcore.h ****  * @brief   Port-related initialization code.
 361:../../../os/common/ports/AVR/chcore.h ****  * @note    This function is empty in this port.
 362:../../../os/common/ports/AVR/chcore.h ****  */
 363:../../../os/common/ports/AVR/chcore.h **** #define port_init() {                                                       \
 364:../../../os/common/ports/AVR/chcore.h ****   __avr_in_isr = true;                                                      \
 365:../../../os/common/ports/AVR/chcore.h **** }
 366:../../../os/common/ports/AVR/chcore.h **** 
 367:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
 368:../../../os/common/ports/AVR/chcore.h **** /* External declarations.                                                    */
 369:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
 370:../../../os/common/ports/AVR/chcore.h **** 
 371:../../../os/common/ports/AVR/chcore.h **** /* The following code is not processed when the file is included from an
 372:../../../os/common/ports/AVR/chcore.h ****    asm module.*/
 373:../../../os/common/ports/AVR/chcore.h **** #if !defined(_FROM_ASM_)
 374:../../../os/common/ports/AVR/chcore.h **** 
 375:../../../os/common/ports/AVR/chcore.h **** #ifdef __cplusplus
 376:../../../os/common/ports/AVR/chcore.h **** extern "C" {
 377:../../../os/common/ports/AVR/chcore.h **** #endif
 378:../../../os/common/ports/AVR/chcore.h ****   void _port_switch(thread_t *ntp, thread_t *otp);
 379:../../../os/common/ports/AVR/chcore.h ****   void _port_thread_start(void);
 380:../../../os/common/ports/AVR/chcore.h **** #ifdef __cplusplus
 381:../../../os/common/ports/AVR/chcore.h **** }
 382:../../../os/common/ports/AVR/chcore.h **** #endif
 383:../../../os/common/ports/AVR/chcore.h **** 
 384:../../../os/common/ports/AVR/chcore.h **** #endif /* !defined(_FROM_ASM_) */
 385:../../../os/common/ports/AVR/chcore.h **** 
 386:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
 387:../../../os/common/ports/AVR/chcore.h **** /* Module inline functions.                                                  */
 388:../../../os/common/ports/AVR/chcore.h **** /*===========================================================================*/
 389:../../../os/common/ports/AVR/chcore.h **** 
 390:../../../os/common/ports/AVR/chcore.h **** /* The following code is not processed when the file is included from an
 391:../../../os/common/ports/AVR/chcore.h ****    asm module.*/
 392:../../../os/common/ports/AVR/chcore.h **** #if !defined(_FROM_ASM_)
 393:../../../os/common/ports/AVR/chcore.h **** 
 394:../../../os/common/ports/AVR/chcore.h **** /**
 395:../../../os/common/ports/AVR/chcore.h ****  * @brief   Returns a word encoding the current interrupts status.
 396:../../../os/common/ports/AVR/chcore.h ****  *
 397:../../../os/common/ports/AVR/chcore.h ****  * @return              The interrupts status.
 398:../../../os/common/ports/AVR/chcore.h ****  */
 399:../../../os/common/ports/AVR/chcore.h **** static inline syssts_t port_get_irq_status(void) {
 400:../../../os/common/ports/AVR/chcore.h **** 
 401:../../../os/common/ports/AVR/chcore.h ****   return SREG;
 402:../../../os/common/ports/AVR/chcore.h **** }
 403:../../../os/common/ports/AVR/chcore.h **** 
 404:../../../os/common/ports/AVR/chcore.h **** /**
 405:../../../os/common/ports/AVR/chcore.h ****  * @brief   Checks the interrupt status.
 406:../../../os/common/ports/AVR/chcore.h ****  *
 407:../../../os/common/ports/AVR/chcore.h ****  * @param[in] sts       the interrupt status word
 408:../../../os/common/ports/AVR/chcore.h ****  *
 409:../../../os/common/ports/AVR/chcore.h ****  * @return              The interrupt status.
 410:../../../os/common/ports/AVR/chcore.h ****  * @retval false        the word specified a disabled interrupts status.
 411:../../../os/common/ports/AVR/chcore.h ****  * @retval true         the word specified an enabled interrupts status.
 412:../../../os/common/ports/AVR/chcore.h ****  */
 413:../../../os/common/ports/AVR/chcore.h **** static inline bool port_irq_enabled(syssts_t sts) {
 414:../../../os/common/ports/AVR/chcore.h **** 
 415:../../../os/common/ports/AVR/chcore.h ****   return (bool)((sts & 0x80) != 0);
 416:../../../os/common/ports/AVR/chcore.h **** }
 417:../../../os/common/ports/AVR/chcore.h **** 
 418:../../../os/common/ports/AVR/chcore.h **** /**
 419:../../../os/common/ports/AVR/chcore.h ****  * @brief   Determines the current execution context.
 420:../../../os/common/ports/AVR/chcore.h ****  *
 421:../../../os/common/ports/AVR/chcore.h ****  * @return              The execution context.
 422:../../../os/common/ports/AVR/chcore.h ****  * @retval false        not running in ISR mode.
 423:../../../os/common/ports/AVR/chcore.h ****  * @retval true         running in ISR mode.
 424:../../../os/common/ports/AVR/chcore.h ****  */
 425:../../../os/common/ports/AVR/chcore.h **** static inline bool port_is_isr_context(void) {
 426:../../../os/common/ports/AVR/chcore.h **** 
 427:../../../os/common/ports/AVR/chcore.h ****   return __avr_in_isr;
 428:../../../os/common/ports/AVR/chcore.h **** }
 429:../../../os/common/ports/AVR/chcore.h **** 
 430:../../../os/common/ports/AVR/chcore.h **** /**
 431:../../../os/common/ports/AVR/chcore.h ****  * @brief   Kernel-lock action.
 432:../../../os/common/ports/AVR/chcore.h ****  * @details Usually this function just disables interrupts but may perform more
 433:../../../os/common/ports/AVR/chcore.h ****  *          actions.
 434:../../../os/common/ports/AVR/chcore.h ****  */
 435:../../../os/common/ports/AVR/chcore.h **** static inline void port_lock(void) {
 131               		.loc 4 435 20 view .LVU31
 132               	.LBB90:
 436:../../../os/common/ports/AVR/chcore.h **** 
 437:../../../os/common/ports/AVR/chcore.h ****   asm volatile ("cli" : : : "memory");
 133               		.loc 4 437 3 view .LVU32
 134               	/* #APP */
 135               	 ;  437 "../../../os/common/ports/AVR/chcore.h" 1
 136 0006 F894      		cli
 137               	 ;  0 "" 2
 138               	/* #NOAPP */
 139               	.LBE90:
 140               	.LBE89:
 141               	.LBE91:
 142               	.LBE93:
 356:../../../os/rt/include/chsys.h ****   _stats_start_measure_crit_thd();
 143               		.loc 3 356 34 view .LVU33
 357:../../../os/rt/include/chsys.h ****   _dbg_check_lock();
 144               		.loc 3 357 20 view .LVU34
 100:../../../os/hal/src/hal_adc.c ****   osalDbgAssert((adcp->state == ADC_STOP) || (adcp->state == ADC_READY),
 145               		.loc 1 100 3 view .LVU35
 146               		.loc 1 100 3 view .LVU36
 101:../../../os/hal/src/hal_adc.c ****                 "invalid state");
 102:../../../os/hal/src/hal_adc.c ****   adcp->config = config;
 147               		.loc 1 102 3 view .LVU37
 148               		.loc 1 102 16 is_stmt 0 view .LVU38
 149 0008 7A83      		std Y+2,r23
 150 000a 6983      		std Y+1,r22
 103:../../../os/hal/src/hal_adc.c ****   adc_lld_start(adcp);
 151               		.loc 1 103 3 is_stmt 1 view .LVU39
 152 000c 0E94 0000 		call adc_lld_start
 153               	.LVL7:
 104:../../../os/hal/src/hal_adc.c ****   adcp->state = ADC_READY;
 154               		.loc 1 104 3 view .LVU40
 155               		.loc 1 104 15 is_stmt 0 view .LVU41
 156 0010 82E0      		ldi r24,lo8(2)
 157 0012 8883      		st Y,r24
 105:../../../os/hal/src/hal_adc.c ****   osalSysUnlock();
 158               		.loc 1 105 3 is_stmt 1 view .LVU42
 159               	.LBB94:
 160               	.LBI94:
 520:../../../os/hal/osal/rt/osal.h **** 
 161               		.loc 2 520 20 view .LVU43
 162               	.LBE94:
 522:../../../os/hal/osal/rt/osal.h **** }
 163               		.loc 2 522 3 view .LVU44
 164               	.LBB99:
 165               	.LBB95:
 166               	.LBI95:
 358:../../../os/rt/include/chsys.h **** }
 359:../../../os/rt/include/chsys.h **** 
 360:../../../os/rt/include/chsys.h **** /**
 361:../../../os/rt/include/chsys.h ****  * @brief   Leaves the kernel lock state.
 362:../../../os/rt/include/chsys.h ****  *
 363:../../../os/rt/include/chsys.h ****  * @special
 364:../../../os/rt/include/chsys.h ****  */
 365:../../../os/rt/include/chsys.h **** static inline void chSysUnlock(void) {
 167               		.loc 3 365 20 view .LVU45
 168               	.LBB96:
 366:../../../os/rt/include/chsys.h **** 
 367:../../../os/rt/include/chsys.h ****   _dbg_check_unlock();
 169               		.loc 3 367 22 view .LVU46
 368:../../../os/rt/include/chsys.h ****   _stats_stop_measure_crit_thd();
 170               		.loc 3 368 33 view .LVU47
 369:../../../os/rt/include/chsys.h **** 
 370:../../../os/rt/include/chsys.h ****   /* The following condition can be triggered by the use of i-class functions
 371:../../../os/rt/include/chsys.h ****      in a critical section not followed by a chSchResceduleS(), this means
 372:../../../os/rt/include/chsys.h ****      that the current thread has a lower priority than the next thread in
 373:../../../os/rt/include/chsys.h ****      the ready list.*/
 374:../../../os/rt/include/chsys.h ****   chDbgAssert((ch.rlist.queue.next == (thread_t *)&ch.rlist.queue) ||
 171               		.loc 3 374 3 view .LVU48
 172               		.loc 3 374 3 view .LVU49
 375:../../../os/rt/include/chsys.h ****               (ch.rlist.current->prio >= ch.rlist.queue.next->prio),
 376:../../../os/rt/include/chsys.h ****               "priority order violation");
 377:../../../os/rt/include/chsys.h **** 
 378:../../../os/rt/include/chsys.h ****   port_unlock();
 173               		.loc 3 378 3 view .LVU50
 174               	.LBB97:
 175               	.LBI97:
 438:../../../os/common/ports/AVR/chcore.h **** }
 439:../../../os/common/ports/AVR/chcore.h **** 
 440:../../../os/common/ports/AVR/chcore.h **** /**
 441:../../../os/common/ports/AVR/chcore.h ****  * @brief   Kernel-unlock action.
 442:../../../os/common/ports/AVR/chcore.h ****  * @details Usually this function just enables interrupts but may perform more
 443:../../../os/common/ports/AVR/chcore.h ****  *          actions.
 444:../../../os/common/ports/AVR/chcore.h ****  */
 445:../../../os/common/ports/AVR/chcore.h **** static inline void port_unlock(void) {
 176               		.loc 4 445 20 view .LVU51
 177               	.LBB98:
 446:../../../os/common/ports/AVR/chcore.h **** 
 447:../../../os/common/ports/AVR/chcore.h ****   asm volatile ("sei" : : : "memory");
 178               		.loc 4 447 3 view .LVU52
 179               	/* #APP */
 180               	 ;  447 "../../../os/common/ports/AVR/chcore.h" 1
 181 0014 7894      		sei
 182               	 ;  0 "" 2
 183               	/* #NOAPP */
 184               	/* epilogue start */
 185               	.LBE98:
 186               	.LBE97:
 187               	.LBE96:
 188               	.LBE95:
 189               	.LBE99:
 106:../../../os/hal/src/hal_adc.c **** }
 190               		.loc 1 106 1 is_stmt 0 view .LVU53
 191 0016 DF91      		pop r29
 192 0018 CF91      		pop r28
 193               	.LVL8:
 194               		.loc 1 106 1 view .LVU54
 195 001a 0895      		ret
 196               		.cfi_endproc
 197               	.LFE175:
 199               		.section	.text.adcStop,"ax",@progbits
 200               	.global	adcStop
 202               	adcStop:
 203               	.LVL9:
 204               	.LFB176:
 107:../../../os/hal/src/hal_adc.c **** 
 108:../../../os/hal/src/hal_adc.c **** /**
 109:../../../os/hal/src/hal_adc.c ****  * @brief   Deactivates the ADC peripheral.
 110:../../../os/hal/src/hal_adc.c ****  *
 111:../../../os/hal/src/hal_adc.c ****  * @param[in] adcp      pointer to the @p ADCDriver object
 112:../../../os/hal/src/hal_adc.c ****  *
 113:../../../os/hal/src/hal_adc.c ****  * @api
 114:../../../os/hal/src/hal_adc.c ****  */
 115:../../../os/hal/src/hal_adc.c **** void adcStop(ADCDriver *adcp) {
 205               		.loc 1 115 31 is_stmt 1 view -0
 206               		.cfi_startproc
 207               		.loc 1 115 31 is_stmt 0 view .LVU56
 208 0000 CF93      		push r28
 209               	.LCFI2:
 210               		.cfi_def_cfa_offset 3
 211               		.cfi_offset 28, -2
 212 0002 DF93      		push r29
 213               	.LCFI3:
 214               		.cfi_def_cfa_offset 4
 215               		.cfi_offset 29, -3
 216               	/* prologue: function */
 217               	/* frame size = 0 */
 218               	/* stack size = 2 */
 219               	.L__stack_usage = 2
 220 0004 EC01      		movw r28,r24
 116:../../../os/hal/src/hal_adc.c **** 
 117:../../../os/hal/src/hal_adc.c ****   osalDbgCheck(adcp != NULL);
 221               		.loc 1 117 3 is_stmt 1 view .LVU57
 222               		.loc 1 117 3 view .LVU58
 118:../../../os/hal/src/hal_adc.c **** 
 119:../../../os/hal/src/hal_adc.c ****   osalSysLock();
 223               		.loc 1 119 3 view .LVU59
 224               	.LBB100:
 225               	.LBI100:
 509:../../../os/hal/osal/rt/osal.h **** 
 226               		.loc 2 509 20 view .LVU60
 227               	.LBE100:
 511:../../../os/hal/osal/rt/osal.h **** }
 228               		.loc 2 511 3 view .LVU61
 229               	.LBB105:
 230               	.LBB101:
 231               	.LBI101:
 353:../../../os/rt/include/chsys.h **** 
 232               		.loc 3 353 20 view .LVU62
 233               	.LBE101:
 234               	.LBE105:
 355:../../../os/rt/include/chsys.h ****   _stats_start_measure_crit_thd();
 235               		.loc 3 355 3 view .LVU63
 236               	.LBB106:
 237               	.LBB104:
 238               	.LBB102:
 239               	.LBI102:
 435:../../../os/common/ports/AVR/chcore.h **** 
 240               		.loc 4 435 20 view .LVU64
 241               	.LBB103:
 437:../../../os/common/ports/AVR/chcore.h **** }
 242               		.loc 4 437 3 view .LVU65
 243               	/* #APP */
 244               	 ;  437 "../../../os/common/ports/AVR/chcore.h" 1
 245 0006 F894      		cli
 246               	 ;  0 "" 2
 247               	/* #NOAPP */
 248               	.LBE103:
 249               	.LBE102:
 250               	.LBE104:
 251               	.LBE106:
 356:../../../os/rt/include/chsys.h ****   _dbg_check_lock();
 252               		.loc 3 356 34 view .LVU66
 357:../../../os/rt/include/chsys.h **** }
 253               		.loc 3 357 20 view .LVU67
 120:../../../os/hal/src/hal_adc.c **** 
 121:../../../os/hal/src/hal_adc.c ****   osalDbgAssert((adcp->state == ADC_STOP) || (adcp->state == ADC_READY),
 254               		.loc 1 121 3 view .LVU68
 255               		.loc 1 121 3 view .LVU69
 122:../../../os/hal/src/hal_adc.c ****                 "invalid state");
 123:../../../os/hal/src/hal_adc.c **** 
 124:../../../os/hal/src/hal_adc.c ****   adc_lld_stop(adcp);
 256               		.loc 1 124 3 view .LVU70
 257 0008 0E94 0000 		call adc_lld_stop
 258               	.LVL10:
 125:../../../os/hal/src/hal_adc.c ****   adcp->config = NULL;
 259               		.loc 1 125 3 view .LVU71
 260               		.loc 1 125 16 is_stmt 0 view .LVU72
 261 000c 1A82      		std Y+2,__zero_reg__
 262 000e 1982      		std Y+1,__zero_reg__
 126:../../../os/hal/src/hal_adc.c ****   adcp->state  = ADC_STOP;
 263               		.loc 1 126 3 is_stmt 1 view .LVU73
 264               		.loc 1 126 16 is_stmt 0 view .LVU74
 265 0010 81E0      		ldi r24,lo8(1)
 266 0012 8883      		st Y,r24
 127:../../../os/hal/src/hal_adc.c **** 
 128:../../../os/hal/src/hal_adc.c ****   osalSysUnlock();
 267               		.loc 1 128 3 is_stmt 1 view .LVU75
 268               	.LBB107:
 269               	.LBI107:
 520:../../../os/hal/osal/rt/osal.h **** 
 270               		.loc 2 520 20 view .LVU76
 271               	.LBE107:
 522:../../../os/hal/osal/rt/osal.h **** }
 272               		.loc 2 522 3 view .LVU77
 273               	.LBB112:
 274               	.LBB108:
 275               	.LBI108:
 365:../../../os/rt/include/chsys.h **** 
 276               		.loc 3 365 20 view .LVU78
 277               	.LBB109:
 367:../../../os/rt/include/chsys.h ****   _stats_stop_measure_crit_thd();
 278               		.loc 3 367 22 view .LVU79
 368:../../../os/rt/include/chsys.h **** 
 279               		.loc 3 368 33 view .LVU80
 374:../../../os/rt/include/chsys.h ****               (ch.rlist.current->prio >= ch.rlist.queue.next->prio),
 280               		.loc 3 374 3 view .LVU81
 374:../../../os/rt/include/chsys.h ****               (ch.rlist.current->prio >= ch.rlist.queue.next->prio),
 281               		.loc 3 374 3 view .LVU82
 282               		.loc 3 378 3 view .LVU83
 283               	.LBB110:
 284               	.LBI110:
 445:../../../os/common/ports/AVR/chcore.h **** 
 285               		.loc 4 445 20 view .LVU84
 286               	.LBB111:
 287               		.loc 4 447 3 view .LVU85
 288               	/* #APP */
 289               	 ;  447 "../../../os/common/ports/AVR/chcore.h" 1
 290 0014 7894      		sei
 291               	 ;  0 "" 2
 292               	/* #NOAPP */
 293               	/* epilogue start */
 294               	.LBE111:
 295               	.LBE110:
 296               	.LBE109:
 297               	.LBE108:
 298               	.LBE112:
 129:../../../os/hal/src/hal_adc.c **** }
 299               		.loc 1 129 1 is_stmt 0 view .LVU86
 300 0016 DF91      		pop r29
 301 0018 CF91      		pop r28
 302               	.LVL11:
 303               		.loc 1 129 1 view .LVU87
 304 001a 0895      		ret
 305               		.cfi_endproc
 306               	.LFE176:
 308               		.section	.text.adcStartConversion,"ax",@progbits
 309               	.global	adcStartConversion
 311               	adcStartConversion:
 312               	.LVL12:
 313               	.LFB177:
 130:../../../os/hal/src/hal_adc.c **** 
 131:../../../os/hal/src/hal_adc.c **** /**
 132:../../../os/hal/src/hal_adc.c ****  * @brief   Starts an ADC conversion.
 133:../../../os/hal/src/hal_adc.c ****  * @details Starts an asynchronous conversion operation.
 134:../../../os/hal/src/hal_adc.c ****  * @note    The buffer is organized as a matrix of M*N elements where M is the
 135:../../../os/hal/src/hal_adc.c ****  *          channels number configured into the conversion group and N is the
 136:../../../os/hal/src/hal_adc.c ****  *          buffer depth. The samples are sequentially written into the buffer
 137:../../../os/hal/src/hal_adc.c ****  *          with no gaps.
 138:../../../os/hal/src/hal_adc.c ****  *
 139:../../../os/hal/src/hal_adc.c ****  * @param[in] adcp      pointer to the @p ADCDriver object
 140:../../../os/hal/src/hal_adc.c ****  * @param[in] grpp      pointer to a @p ADCConversionGroup object
 141:../../../os/hal/src/hal_adc.c ****  * @param[out] samples  pointer to the samples buffer
 142:../../../os/hal/src/hal_adc.c ****  * @param[in] depth     buffer depth (matrix rows number). The buffer depth
 143:../../../os/hal/src/hal_adc.c ****  *                      must be one or an even number.
 144:../../../os/hal/src/hal_adc.c ****  *
 145:../../../os/hal/src/hal_adc.c ****  * @api
 146:../../../os/hal/src/hal_adc.c ****  */
 147:../../../os/hal/src/hal_adc.c **** void adcStartConversion(ADCDriver *adcp,
 148:../../../os/hal/src/hal_adc.c ****                         const ADCConversionGroup *grpp,
 149:../../../os/hal/src/hal_adc.c ****                         adcsample_t *samples,
 150:../../../os/hal/src/hal_adc.c ****                         size_t depth) {
 314               		.loc 1 150 39 is_stmt 1 view -0
 315               		.cfi_startproc
 316               	/* prologue: function */
 317               	/* frame size = 0 */
 318               	/* stack size = 0 */
 319               	.L__stack_usage = 0
 151:../../../os/hal/src/hal_adc.c **** 
 152:../../../os/hal/src/hal_adc.c ****   osalSysLock();
 320               		.loc 1 152 3 view .LVU89
 321               	.LBB113:
 322               	.LBI113:
 509:../../../os/hal/osal/rt/osal.h **** 
 323               		.loc 2 509 20 view .LVU90
 324               	.LBE113:
 511:../../../os/hal/osal/rt/osal.h **** }
 325               		.loc 2 511 3 view .LVU91
 326               	.LBB118:
 327               	.LBB114:
 328               	.LBI114:
 353:../../../os/rt/include/chsys.h **** 
 329               		.loc 3 353 20 view .LVU92
 330               	.LBE114:
 331               	.LBE118:
 355:../../../os/rt/include/chsys.h ****   _stats_start_measure_crit_thd();
 332               		.loc 3 355 3 view .LVU93
 333               	.LBB119:
 334               	.LBB117:
 335               	.LBB115:
 336               	.LBI115:
 435:../../../os/common/ports/AVR/chcore.h **** 
 337               		.loc 4 435 20 view .LVU94
 338               	.LBB116:
 437:../../../os/common/ports/AVR/chcore.h **** }
 339               		.loc 4 437 3 view .LVU95
 340               	/* #APP */
 341               	 ;  437 "../../../os/common/ports/AVR/chcore.h" 1
 342 0000 F894      		cli
 343               	 ;  0 "" 2
 344               	/* #NOAPP */
 345               	.LBE116:
 346               	.LBE115:
 347               	.LBE117:
 348               	.LBE119:
 356:../../../os/rt/include/chsys.h ****   _dbg_check_lock();
 349               		.loc 3 356 34 view .LVU96
 357:../../../os/rt/include/chsys.h **** }
 350               		.loc 3 357 20 view .LVU97
 153:../../../os/hal/src/hal_adc.c ****   adcStartConversionI(adcp, grpp, samples, depth);
 351               		.loc 1 153 3 view .LVU98
 352               	.LVL13:
 353               	.LBB120:
 354               	.LBI120:
 154:../../../os/hal/src/hal_adc.c ****   osalSysUnlock();
 155:../../../os/hal/src/hal_adc.c **** }
 156:../../../os/hal/src/hal_adc.c **** 
 157:../../../os/hal/src/hal_adc.c **** /**
 158:../../../os/hal/src/hal_adc.c ****  * @brief   Starts an ADC conversion.
 159:../../../os/hal/src/hal_adc.c ****  * @details Starts an asynchronous conversion operation.
 160:../../../os/hal/src/hal_adc.c ****  * @post    The callbacks associated to the conversion group will be invoked
 161:../../../os/hal/src/hal_adc.c ****  *          on buffer fill and error events.
 162:../../../os/hal/src/hal_adc.c ****  * @note    The buffer is organized as a matrix of M*N elements where M is the
 163:../../../os/hal/src/hal_adc.c ****  *          channels number configured into the conversion group and N is the
 164:../../../os/hal/src/hal_adc.c ****  *          buffer depth. The samples are sequentially written into the buffer
 165:../../../os/hal/src/hal_adc.c ****  *          with no gaps.
 166:../../../os/hal/src/hal_adc.c ****  *
 167:../../../os/hal/src/hal_adc.c ****  * @param[in] adcp      pointer to the @p ADCDriver object
 168:../../../os/hal/src/hal_adc.c ****  * @param[in] grpp      pointer to a @p ADCConversionGroup object
 169:../../../os/hal/src/hal_adc.c ****  * @param[out] samples  pointer to the samples buffer
 170:../../../os/hal/src/hal_adc.c ****  * @param[in] depth     buffer depth (matrix rows number). The buffer depth
 171:../../../os/hal/src/hal_adc.c ****  *                      must be one or an even number.
 172:../../../os/hal/src/hal_adc.c ****  *
 173:../../../os/hal/src/hal_adc.c ****  * @iclass
 174:../../../os/hal/src/hal_adc.c ****  */
 175:../../../os/hal/src/hal_adc.c **** void adcStartConversionI(ADCDriver *adcp,
 355               		.loc 1 175 6 view .LVU99
 356               	.LBB121:
 176:../../../os/hal/src/hal_adc.c ****                          const ADCConversionGroup *grpp,
 177:../../../os/hal/src/hal_adc.c ****                          adcsample_t *samples,
 178:../../../os/hal/src/hal_adc.c ****                          size_t depth) {
 179:../../../os/hal/src/hal_adc.c **** 
 180:../../../os/hal/src/hal_adc.c ****   osalDbgCheckClassI();
 357               		.loc 1 180 23 view .LVU100
 181:../../../os/hal/src/hal_adc.c ****   osalDbgCheck((adcp != NULL) && (grpp != NULL) && (samples != NULL) &&
 358               		.loc 1 181 3 view .LVU101
 359               		.loc 1 181 3 view .LVU102
 182:../../../os/hal/src/hal_adc.c ****                (depth > 0U) && ((depth == 1U) || ((depth & 1U) == 0U)));
 183:../../../os/hal/src/hal_adc.c ****   osalDbgAssert((adcp->state == ADC_READY) ||
 360               		.loc 1 183 3 view .LVU103
 361               		.loc 1 183 3 view .LVU104
 184:../../../os/hal/src/hal_adc.c ****                 (adcp->state == ADC_COMPLETE) ||
 185:../../../os/hal/src/hal_adc.c ****                 (adcp->state == ADC_ERROR),
 186:../../../os/hal/src/hal_adc.c ****                 "not ready");
 187:../../../os/hal/src/hal_adc.c **** 
 188:../../../os/hal/src/hal_adc.c ****   adcp->samples  = samples;
 362               		.loc 1 188 3 view .LVU105
 363               		.loc 1 188 18 is_stmt 0 view .LVU106
 364 0002 FC01      		movw r30,r24
 365 0004 5483      		std Z+4,r21
 366 0006 4383      		std Z+3,r20
 189:../../../os/hal/src/hal_adc.c ****   adcp->depth    = depth;
 367               		.loc 1 189 3 is_stmt 1 view .LVU107
 368               		.loc 1 189 18 is_stmt 0 view .LVU108
 369 0008 3683      		std Z+6,r19
 370 000a 2583      		std Z+5,r18
 190:../../../os/hal/src/hal_adc.c ****   adcp->grpp     = grpp;
 371               		.loc 1 190 3 is_stmt 1 view .LVU109
 372               		.loc 1 190 18 is_stmt 0 view .LVU110
 373 000c 7087      		std Z+8,r23
 374 000e 6783      		std Z+7,r22
 191:../../../os/hal/src/hal_adc.c ****   adcp->state    = ADC_ACTIVE;
 375               		.loc 1 191 3 is_stmt 1 view .LVU111
 376               		.loc 1 191 18 is_stmt 0 view .LVU112
 377 0010 23E0      		ldi r18,lo8(3)
 378               	.LVL14:
 379               		.loc 1 191 18 view .LVU113
 380 0012 2083      		st Z,r18
 192:../../../os/hal/src/hal_adc.c ****   adc_lld_start_conversion(adcp);
 381               		.loc 1 192 3 is_stmt 1 view .LVU114
 382 0014 0E94 0000 		call adc_lld_start_conversion
 383               	.LVL15:
 384               		.loc 1 192 3 is_stmt 0 view .LVU115
 385               	.LBE121:
 386               	.LBE120:
 154:../../../os/hal/src/hal_adc.c **** }
 387               		.loc 1 154 3 is_stmt 1 view .LVU116
 388               	.LBB122:
 389               	.LBI122:
 520:../../../os/hal/osal/rt/osal.h **** 
 390               		.loc 2 520 20 view .LVU117
 391               	.LBE122:
 522:../../../os/hal/osal/rt/osal.h **** }
 392               		.loc 2 522 3 view .LVU118
 393               	.LBB127:
 394               	.LBB123:
 395               	.LBI123:
 365:../../../os/rt/include/chsys.h **** 
 396               		.loc 3 365 20 view .LVU119
 397               	.LBB124:
 367:../../../os/rt/include/chsys.h ****   _stats_stop_measure_crit_thd();
 398               		.loc 3 367 22 view .LVU120
 368:../../../os/rt/include/chsys.h **** 
 399               		.loc 3 368 33 view .LVU121
 374:../../../os/rt/include/chsys.h ****               (ch.rlist.current->prio >= ch.rlist.queue.next->prio),
 400               		.loc 3 374 3 view .LVU122
 374:../../../os/rt/include/chsys.h ****               (ch.rlist.current->prio >= ch.rlist.queue.next->prio),
 401               		.loc 3 374 3 view .LVU123
 402               		.loc 3 378 3 view .LVU124
 403               	.LBB125:
 404               	.LBI125:
 445:../../../os/common/ports/AVR/chcore.h **** 
 405               		.loc 4 445 20 view .LVU125
 406               	.LBB126:
 407               		.loc 4 447 3 view .LVU126
 408               	/* #APP */
 409               	 ;  447 "../../../os/common/ports/AVR/chcore.h" 1
 410 0018 7894      		sei
 411               	 ;  0 "" 2
 412               	/* #NOAPP */
 413               	/* epilogue start */
 414               	.LBE126:
 415               	.LBE125:
 416               	.LBE124:
 417               	.LBE123:
 418               	.LBE127:
 155:../../../os/hal/src/hal_adc.c **** 
 419               		.loc 1 155 1 is_stmt 0 view .LVU127
 420 001a 0895      		ret
 421               		.cfi_endproc
 422               	.LFE177:
 424               		.section	.text.adcStartConversionI,"ax",@progbits
 425               	.global	adcStartConversionI
 427               	adcStartConversionI:
 428               	.LVL16:
 429               	.LFB178:
 178:../../../os/hal/src/hal_adc.c **** 
 430               		.loc 1 178 40 is_stmt 1 view -0
 431               		.cfi_startproc
 432               	/* prologue: function */
 433               	/* frame size = 0 */
 434               	/* stack size = 0 */
 435               	.L__stack_usage = 0
 180:../../../os/hal/src/hal_adc.c ****   osalDbgCheck((adcp != NULL) && (grpp != NULL) && (samples != NULL) &&
 436               		.loc 1 180 23 view .LVU129
 181:../../../os/hal/src/hal_adc.c ****                (depth > 0U) && ((depth == 1U) || ((depth & 1U) == 0U)));
 437               		.loc 1 181 3 view .LVU130
 181:../../../os/hal/src/hal_adc.c ****                (depth > 0U) && ((depth == 1U) || ((depth & 1U) == 0U)));
 438               		.loc 1 181 3 view .LVU131
 183:../../../os/hal/src/hal_adc.c ****                 (adcp->state == ADC_COMPLETE) ||
 439               		.loc 1 183 3 view .LVU132
 183:../../../os/hal/src/hal_adc.c ****                 (adcp->state == ADC_COMPLETE) ||
 440               		.loc 1 183 3 view .LVU133
 188:../../../os/hal/src/hal_adc.c ****   adcp->depth    = depth;
 441               		.loc 1 188 3 view .LVU134
 188:../../../os/hal/src/hal_adc.c ****   adcp->depth    = depth;
 442               		.loc 1 188 18 is_stmt 0 view .LVU135
 443 0000 FC01      		movw r30,r24
 444 0002 5483      		std Z+4,r21
 445 0004 4383      		std Z+3,r20
 189:../../../os/hal/src/hal_adc.c ****   adcp->grpp     = grpp;
 446               		.loc 1 189 3 is_stmt 1 view .LVU136
 189:../../../os/hal/src/hal_adc.c ****   adcp->grpp     = grpp;
 447               		.loc 1 189 18 is_stmt 0 view .LVU137
 448 0006 3683      		std Z+6,r19
 449 0008 2583      		std Z+5,r18
 190:../../../os/hal/src/hal_adc.c ****   adcp->state    = ADC_ACTIVE;
 450               		.loc 1 190 3 is_stmt 1 view .LVU138
 190:../../../os/hal/src/hal_adc.c ****   adcp->state    = ADC_ACTIVE;
 451               		.loc 1 190 18 is_stmt 0 view .LVU139
 452 000a 7087      		std Z+8,r23
 453 000c 6783      		std Z+7,r22
 191:../../../os/hal/src/hal_adc.c ****   adc_lld_start_conversion(adcp);
 454               		.loc 1 191 3 is_stmt 1 view .LVU140
 191:../../../os/hal/src/hal_adc.c ****   adc_lld_start_conversion(adcp);
 455               		.loc 1 191 18 is_stmt 0 view .LVU141
 456 000e 23E0      		ldi r18,lo8(3)
 457               	.LVL17:
 191:../../../os/hal/src/hal_adc.c ****   adc_lld_start_conversion(adcp);
 458               		.loc 1 191 18 view .LVU142
 459 0010 2083      		st Z,r18
 460               		.loc 1 192 3 is_stmt 1 view .LVU143
 461 0012 0C94 0000 		jmp adc_lld_start_conversion
 462               	.LVL18:
 463               		.loc 1 192 3 is_stmt 0 view .LVU144
 464               		.cfi_endproc
 465               	.LFE178:
 467               		.section	.text.adcStopConversion,"ax",@progbits
 468               	.global	adcStopConversion
 470               	adcStopConversion:
 471               	.LVL19:
 472               	.LFB179:
 193:../../../os/hal/src/hal_adc.c **** }
 194:../../../os/hal/src/hal_adc.c **** 
 195:../../../os/hal/src/hal_adc.c **** /**
 196:../../../os/hal/src/hal_adc.c ****  * @brief   Stops an ongoing conversion.
 197:../../../os/hal/src/hal_adc.c ****  * @details This function stops the currently ongoing conversion and returns
 198:../../../os/hal/src/hal_adc.c ****  *          the driver in the @p ADC_READY state. If there was no conversion
 199:../../../os/hal/src/hal_adc.c ****  *          being processed then the function does nothing.
 200:../../../os/hal/src/hal_adc.c ****  *
 201:../../../os/hal/src/hal_adc.c ****  * @param[in] adcp      pointer to the @p ADCDriver object
 202:../../../os/hal/src/hal_adc.c ****  *
 203:../../../os/hal/src/hal_adc.c ****  * @api
 204:../../../os/hal/src/hal_adc.c ****  */
 205:../../../os/hal/src/hal_adc.c **** void adcStopConversion(ADCDriver *adcp) {
 473               		.loc 1 205 41 is_stmt 1 view -0
 474               		.cfi_startproc
 475               		.loc 1 205 41 is_stmt 0 view .LVU146
 476 0000 CF93      		push r28
 477               	.LCFI4:
 478               		.cfi_def_cfa_offset 3
 479               		.cfi_offset 28, -2
 480 0002 DF93      		push r29
 481               	.LCFI5:
 482               		.cfi_def_cfa_offset 4
 483               		.cfi_offset 29, -3
 484               	/* prologue: function */
 485               	/* frame size = 0 */
 486               	/* stack size = 2 */
 487               	.L__stack_usage = 2
 488 0004 EC01      		movw r28,r24
 206:../../../os/hal/src/hal_adc.c **** 
 207:../../../os/hal/src/hal_adc.c ****   osalDbgCheck(adcp != NULL);
 489               		.loc 1 207 3 is_stmt 1 view .LVU147
 490               		.loc 1 207 3 view .LVU148
 208:../../../os/hal/src/hal_adc.c **** 
 209:../../../os/hal/src/hal_adc.c ****   osalSysLock();
 491               		.loc 1 209 3 view .LVU149
 492               	.LBB128:
 493               	.LBI128:
 509:../../../os/hal/osal/rt/osal.h **** 
 494               		.loc 2 509 20 view .LVU150
 495               	.LBE128:
 511:../../../os/hal/osal/rt/osal.h **** }
 496               		.loc 2 511 3 view .LVU151
 497               	.LBB133:
 498               	.LBB129:
 499               	.LBI129:
 353:../../../os/rt/include/chsys.h **** 
 500               		.loc 3 353 20 view .LVU152
 501               	.LBE129:
 502               	.LBE133:
 355:../../../os/rt/include/chsys.h ****   _stats_start_measure_crit_thd();
 503               		.loc 3 355 3 view .LVU153
 504               	.LBB134:
 505               	.LBB132:
 506               	.LBB130:
 507               	.LBI130:
 435:../../../os/common/ports/AVR/chcore.h **** 
 508               		.loc 4 435 20 view .LVU154
 509               	.LBB131:
 437:../../../os/common/ports/AVR/chcore.h **** }
 510               		.loc 4 437 3 view .LVU155
 511               	/* #APP */
 512               	 ;  437 "../../../os/common/ports/AVR/chcore.h" 1
 513 0006 F894      		cli
 514               	 ;  0 "" 2
 515               	/* #NOAPP */
 516               	.LBE131:
 517               	.LBE130:
 518               	.LBE132:
 519               	.LBE134:
 356:../../../os/rt/include/chsys.h ****   _dbg_check_lock();
 520               		.loc 3 356 34 view .LVU156
 357:../../../os/rt/include/chsys.h **** }
 521               		.loc 3 357 20 view .LVU157
 210:../../../os/hal/src/hal_adc.c ****   osalDbgAssert((adcp->state == ADC_READY) || (adcp->state == ADC_ACTIVE),
 522               		.loc 1 210 3 view .LVU158
 523               		.loc 1 210 3 view .LVU159
 211:../../../os/hal/src/hal_adc.c ****                 "invalid state");
 212:../../../os/hal/src/hal_adc.c ****   if (adcp->state != ADC_READY) {
 524               		.loc 1 212 3 view .LVU160
 525               		.loc 1 212 6 is_stmt 0 view .LVU161
 526 0008 8881      		ld r24,Y
 527               	.LVL20:
 528               		.loc 1 212 6 view .LVU162
 529 000a 8230      		cpi r24,lo8(2)
 530 000c 01F0      		breq .L9
 213:../../../os/hal/src/hal_adc.c ****     adc_lld_stop_conversion(adcp);
 531               		.loc 1 213 5 is_stmt 1 view .LVU163
 532 000e CE01      		movw r24,r28
 533 0010 0E94 0000 		call adc_lld_stop_conversion
 534               	.LVL21:
 214:../../../os/hal/src/hal_adc.c ****     adcp->grpp  = NULL;
 535               		.loc 1 214 5 view .LVU164
 536               		.loc 1 214 17 is_stmt 0 view .LVU165
 537 0014 1886      		std Y+8,__zero_reg__
 538 0016 1F82      		std Y+7,__zero_reg__
 215:../../../os/hal/src/hal_adc.c ****     adcp->state = ADC_READY;
 539               		.loc 1 215 5 is_stmt 1 view .LVU166
 540               		.loc 1 215 17 is_stmt 0 view .LVU167
 541 0018 82E0      		ldi r24,lo8(2)
 542 001a 8883      		st Y,r24
 216:../../../os/hal/src/hal_adc.c ****     _adc_reset_s(adcp);
 543               		.loc 1 216 5 is_stmt 1 view .LVU168
 544               	.LVL22:
 545               	.LBB135:
 546               	.LBI135:
 788:../../../os/hal/osal/rt/osal.h **** 
 547               		.loc 2 788 20 view .LVU169
 548               	.LBB136:
 790:../../../os/hal/osal/rt/osal.h **** }
 549               		.loc 2 790 3 view .LVU170
 550 001c 6EEF      		ldi r22,lo8(-2)
 551 001e 7FEF      		ldi r23,lo8(-1)
 552 0020 CE01      		movw r24,r28
 553 0022 0996      		adiw r24,9
 554               	.LVL23:
 790:../../../os/hal/osal/rt/osal.h **** }
 555               		.loc 2 790 3 is_stmt 0 view .LVU171
 556 0024 0E94 0000 		call chThdResumeS
 557               	.LVL24:
 558               	.L9:
 790:../../../os/hal/osal/rt/osal.h **** }
 559               		.loc 2 790 3 view .LVU172
 560               	.LBE136:
 561               	.LBE135:
 217:../../../os/hal/src/hal_adc.c ****   }
 218:../../../os/hal/src/hal_adc.c ****   osalSysUnlock();
 562               		.loc 1 218 3 is_stmt 1 view .LVU173
 563               	.LBB137:
 564               	.LBI137:
 520:../../../os/hal/osal/rt/osal.h **** 
 565               		.loc 2 520 20 view .LVU174
 566               	.LBE137:
 522:../../../os/hal/osal/rt/osal.h **** }
 567               		.loc 2 522 3 view .LVU175
 568               	.LBB142:
 569               	.LBB138:
 570               	.LBI138:
 365:../../../os/rt/include/chsys.h **** 
 571               		.loc 3 365 20 view .LVU176
 572               	.LBB139:
 367:../../../os/rt/include/chsys.h ****   _stats_stop_measure_crit_thd();
 573               		.loc 3 367 22 view .LVU177
 368:../../../os/rt/include/chsys.h **** 
 574               		.loc 3 368 33 view .LVU178
 374:../../../os/rt/include/chsys.h ****               (ch.rlist.current->prio >= ch.rlist.queue.next->prio),
 575               		.loc 3 374 3 view .LVU179
 374:../../../os/rt/include/chsys.h ****               (ch.rlist.current->prio >= ch.rlist.queue.next->prio),
 576               		.loc 3 374 3 view .LVU180
 577               		.loc 3 378 3 view .LVU181
 578               	.LBB140:
 579               	.LBI140:
 445:../../../os/common/ports/AVR/chcore.h **** 
 580               		.loc 4 445 20 view .LVU182
 581               	.LBB141:
 582               		.loc 4 447 3 view .LVU183
 583               	/* #APP */
 584               	 ;  447 "../../../os/common/ports/AVR/chcore.h" 1
 585 0028 7894      		sei
 586               	 ;  0 "" 2
 587               	/* #NOAPP */
 588               	/* epilogue start */
 589               	.LBE141:
 590               	.LBE140:
 591               	.LBE139:
 592               	.LBE138:
 593               	.LBE142:
 219:../../../os/hal/src/hal_adc.c **** }
 594               		.loc 1 219 1 is_stmt 0 view .LVU184
 595 002a DF91      		pop r29
 596 002c CF91      		pop r28
 597               	.LVL25:
 598               		.loc 1 219 1 view .LVU185
 599 002e 0895      		ret
 600               		.cfi_endproc
 601               	.LFE179:
 603               		.section	.text.adcStopConversionI,"ax",@progbits
 604               	.global	adcStopConversionI
 606               	adcStopConversionI:
 607               	.LVL26:
 608               	.LFB180:
 220:../../../os/hal/src/hal_adc.c **** 
 221:../../../os/hal/src/hal_adc.c **** /**
 222:../../../os/hal/src/hal_adc.c ****  * @brief   Stops an ongoing conversion.
 223:../../../os/hal/src/hal_adc.c ****  * @details This function stops the currently ongoing conversion and returns
 224:../../../os/hal/src/hal_adc.c ****  *          the driver in the @p ADC_READY state. If there was no conversion
 225:../../../os/hal/src/hal_adc.c ****  *          being processed then the function does nothing.
 226:../../../os/hal/src/hal_adc.c ****  *
 227:../../../os/hal/src/hal_adc.c ****  * @param[in] adcp      pointer to the @p ADCDriver object
 228:../../../os/hal/src/hal_adc.c ****  *
 229:../../../os/hal/src/hal_adc.c ****  * @iclass
 230:../../../os/hal/src/hal_adc.c ****  */
 231:../../../os/hal/src/hal_adc.c **** void adcStopConversionI(ADCDriver *adcp) {
 609               		.loc 1 231 42 is_stmt 1 view -0
 610               		.cfi_startproc
 611               		.loc 1 231 42 is_stmt 0 view .LVU187
 612 0000 CF93      		push r28
 613               	.LCFI6:
 614               		.cfi_def_cfa_offset 3
 615               		.cfi_offset 28, -2
 616 0002 DF93      		push r29
 617               	.LCFI7:
 618               		.cfi_def_cfa_offset 4
 619               		.cfi_offset 29, -3
 620               	/* prologue: function */
 621               	/* frame size = 0 */
 622               	/* stack size = 2 */
 623               	.L__stack_usage = 2
 624 0004 EC01      		movw r28,r24
 232:../../../os/hal/src/hal_adc.c **** 
 233:../../../os/hal/src/hal_adc.c ****   osalDbgCheckClassI();
 625               		.loc 1 233 23 is_stmt 1 view .LVU188
 234:../../../os/hal/src/hal_adc.c ****   osalDbgCheck(adcp != NULL);
 626               		.loc 1 234 3 view .LVU189
 627               		.loc 1 234 3 view .LVU190
 235:../../../os/hal/src/hal_adc.c ****   osalDbgAssert((adcp->state == ADC_READY) ||
 628               		.loc 1 235 3 view .LVU191
 629               		.loc 1 235 3 view .LVU192
 236:../../../os/hal/src/hal_adc.c ****                 (adcp->state == ADC_ACTIVE) ||
 237:../../../os/hal/src/hal_adc.c ****                 (adcp->state == ADC_COMPLETE),
 238:../../../os/hal/src/hal_adc.c ****                 "invalid state");
 239:../../../os/hal/src/hal_adc.c **** 
 240:../../../os/hal/src/hal_adc.c ****   if (adcp->state != ADC_READY) {
 630               		.loc 1 240 3 view .LVU193
 631               		.loc 1 240 6 is_stmt 0 view .LVU194
 632 0006 8881      		ld r24,Y
 633               	.LVL27:
 634               		.loc 1 240 6 view .LVU195
 635 0008 8230      		cpi r24,lo8(2)
 636 000a 01F4      		brne .L15
 637               	/* epilogue start */
 241:../../../os/hal/src/hal_adc.c ****     adc_lld_stop_conversion(adcp);
 242:../../../os/hal/src/hal_adc.c ****     adcp->grpp  = NULL;
 243:../../../os/hal/src/hal_adc.c ****     adcp->state = ADC_READY;
 244:../../../os/hal/src/hal_adc.c ****     _adc_reset_i(adcp);
 245:../../../os/hal/src/hal_adc.c ****   }
 246:../../../os/hal/src/hal_adc.c **** }
 638               		.loc 1 246 1 view .LVU196
 639 000c DF91      		pop r29
 640 000e CF91      		pop r28
 641               	.LVL28:
 642               		.loc 1 246 1 view .LVU197
 643 0010 0895      		ret
 644               	.LVL29:
 645               	.L15:
 241:../../../os/hal/src/hal_adc.c ****     adc_lld_stop_conversion(adcp);
 646               		.loc 1 241 5 is_stmt 1 view .LVU198
 647 0012 CE01      		movw r24,r28
 648 0014 0E94 0000 		call adc_lld_stop_conversion
 649               	.LVL30:
 242:../../../os/hal/src/hal_adc.c ****     adcp->state = ADC_READY;
 650               		.loc 1 242 5 view .LVU199
 242:../../../os/hal/src/hal_adc.c ****     adcp->state = ADC_READY;
 651               		.loc 1 242 17 is_stmt 0 view .LVU200
 652 0018 1886      		std Y+8,__zero_reg__
 653 001a 1F82      		std Y+7,__zero_reg__
 243:../../../os/hal/src/hal_adc.c ****     _adc_reset_i(adcp);
 654               		.loc 1 243 5 is_stmt 1 view .LVU201
 243:../../../os/hal/src/hal_adc.c ****     _adc_reset_i(adcp);
 655               		.loc 1 243 17 is_stmt 0 view .LVU202
 656 001c 82E0      		ldi r24,lo8(2)
 657 001e 8883      		st Y,r24
 244:../../../os/hal/src/hal_adc.c ****   }
 658               		.loc 1 244 5 is_stmt 1 view .LVU203
 659               	.LVL31:
 660               	.LBB143:
 661               	.LBI143:
 773:../../../os/hal/osal/rt/osal.h **** 
 662               		.loc 2 773 20 view .LVU204
 663               	.LBB144:
 775:../../../os/hal/osal/rt/osal.h **** }
 664               		.loc 2 775 3 view .LVU205
 665 0020 6EEF      		ldi r22,lo8(-2)
 666 0022 7FEF      		ldi r23,lo8(-1)
 667 0024 CE01      		movw r24,r28
 668 0026 0996      		adiw r24,9
 669               	.LVL32:
 670               	/* epilogue start */
 775:../../../os/hal/osal/rt/osal.h **** }
 671               		.loc 2 775 3 is_stmt 0 view .LVU206
 672               	.LBE144:
 673               	.LBE143:
 674               		.loc 1 246 1 view .LVU207
 675 0028 DF91      		pop r29
 676 002a CF91      		pop r28
 677               	.LVL33:
 678               	.LBB146:
 679               	.LBB145:
 775:../../../os/hal/osal/rt/osal.h **** }
 680               		.loc 2 775 3 view .LVU208
 681 002c 0C94 0000 		jmp chThdResumeI
 682               	.LVL34:
 775:../../../os/hal/osal/rt/osal.h **** }
 683               		.loc 2 775 3 view .LVU209
 684               	.LBE145:
 685               	.LBE146:
 686               		.cfi_endproc
 687               	.LFE180:
 689               		.section	.text.adcConvert,"ax",@progbits
 690               	.global	adcConvert
 692               	adcConvert:
 693               	.LVL35:
 694               	.LFB181:
 247:../../../os/hal/src/hal_adc.c **** 
 248:../../../os/hal/src/hal_adc.c **** #if (ADC_USE_WAIT == TRUE) || defined(__DOXYGEN__)
 249:../../../os/hal/src/hal_adc.c **** /**
 250:../../../os/hal/src/hal_adc.c ****  * @brief   Performs an ADC conversion.
 251:../../../os/hal/src/hal_adc.c ****  * @details Performs a synchronous conversion operation.
 252:../../../os/hal/src/hal_adc.c ****  * @note    The buffer is organized as a matrix of M*N elements where M is the
 253:../../../os/hal/src/hal_adc.c ****  *          channels number configured into the conversion group and N is the
 254:../../../os/hal/src/hal_adc.c ****  *          buffer depth. The samples are sequentially written into the buffer
 255:../../../os/hal/src/hal_adc.c ****  *          with no gaps.
 256:../../../os/hal/src/hal_adc.c ****  *
 257:../../../os/hal/src/hal_adc.c ****  * @param[in] adcp      pointer to the @p ADCDriver object
 258:../../../os/hal/src/hal_adc.c ****  * @param[in] grpp      pointer to a @p ADCConversionGroup object
 259:../../../os/hal/src/hal_adc.c ****  * @param[out] samples  pointer to the samples buffer
 260:../../../os/hal/src/hal_adc.c ****  * @param[in] depth     buffer depth (matrix rows number). The buffer depth
 261:../../../os/hal/src/hal_adc.c ****  *                      must be one or an even number.
 262:../../../os/hal/src/hal_adc.c ****  * @return              The operation result.
 263:../../../os/hal/src/hal_adc.c ****  * @retval MSG_OK       Conversion finished.
 264:../../../os/hal/src/hal_adc.c ****  * @retval MSG_RESET    The conversion has been stopped using
 265:../../../os/hal/src/hal_adc.c ****  *                      @p acdStopConversion() or @p acdStopConversionI(),
 266:../../../os/hal/src/hal_adc.c ****  *                      the result buffer may contain incorrect data.
 267:../../../os/hal/src/hal_adc.c ****  * @retval MSG_TIMEOUT  The conversion has been stopped because an hardware
 268:../../../os/hal/src/hal_adc.c ****  *                      error.
 269:../../../os/hal/src/hal_adc.c ****  *
 270:../../../os/hal/src/hal_adc.c ****  * @api
 271:../../../os/hal/src/hal_adc.c ****  */
 272:../../../os/hal/src/hal_adc.c **** msg_t adcConvert(ADCDriver *adcp,
 273:../../../os/hal/src/hal_adc.c ****                  const ADCConversionGroup *grpp,
 274:../../../os/hal/src/hal_adc.c ****                  adcsample_t *samples,
 275:../../../os/hal/src/hal_adc.c ****                  size_t depth) {
 695               		.loc 1 275 32 is_stmt 1 view -0
 696               		.cfi_startproc
 697               		.loc 1 275 32 is_stmt 0 view .LVU211
 698 0000 CF93      		push r28
 699               	.LCFI8:
 700               		.cfi_def_cfa_offset 3
 701               		.cfi_offset 28, -2
 702 0002 DF93      		push r29
 703               	.LCFI9:
 704               		.cfi_def_cfa_offset 4
 705               		.cfi_offset 29, -3
 706               	/* prologue: function */
 707               	/* frame size = 0 */
 708               	/* stack size = 2 */
 709               	.L__stack_usage = 2
 710 0004 EC01      		movw r28,r24
 276:../../../os/hal/src/hal_adc.c ****   msg_t msg;
 711               		.loc 1 276 3 is_stmt 1 view .LVU212
 277:../../../os/hal/src/hal_adc.c **** 
 278:../../../os/hal/src/hal_adc.c ****   osalSysLock();
 712               		.loc 1 278 3 view .LVU213
 713               	.LBB147:
 714               	.LBI147:
 509:../../../os/hal/osal/rt/osal.h **** 
 715               		.loc 2 509 20 view .LVU214
 716               	.LBE147:
 511:../../../os/hal/osal/rt/osal.h **** }
 717               		.loc 2 511 3 view .LVU215
 718               	.LBB152:
 719               	.LBB148:
 720               	.LBI148:
 353:../../../os/rt/include/chsys.h **** 
 721               		.loc 3 353 20 view .LVU216
 722               	.LBE148:
 723               	.LBE152:
 355:../../../os/rt/include/chsys.h ****   _stats_start_measure_crit_thd();
 724               		.loc 3 355 3 view .LVU217
 725               	.LBB153:
 726               	.LBB151:
 727               	.LBB149:
 728               	.LBI149:
 435:../../../os/common/ports/AVR/chcore.h **** 
 729               		.loc 4 435 20 view .LVU218
 730               	.LBB150:
 437:../../../os/common/ports/AVR/chcore.h **** }
 731               		.loc 4 437 3 view .LVU219
 732               	/* #APP */
 733               	 ;  437 "../../../os/common/ports/AVR/chcore.h" 1
 734 0006 F894      		cli
 735               	 ;  0 "" 2
 736               	/* #NOAPP */
 737               	.LBE150:
 738               	.LBE149:
 739               	.LBE151:
 740               	.LBE153:
 356:../../../os/rt/include/chsys.h ****   _dbg_check_lock();
 741               		.loc 3 356 34 view .LVU220
 357:../../../os/rt/include/chsys.h **** }
 742               		.loc 3 357 20 view .LVU221
 279:../../../os/hal/src/hal_adc.c ****   osalDbgAssert(adcp->thread == NULL, "already waiting");
 743               		.loc 1 279 3 view .LVU222
 744               		.loc 1 279 3 view .LVU223
 280:../../../os/hal/src/hal_adc.c ****   adcStartConversionI(adcp, grpp, samples, depth);
 745               		.loc 1 280 3 view .LVU224
 746               	.LVL36:
 747               	.LBB154:
 748               	.LBI154:
 175:../../../os/hal/src/hal_adc.c ****                          const ADCConversionGroup *grpp,
 749               		.loc 1 175 6 view .LVU225
 750               	.LBB155:
 180:../../../os/hal/src/hal_adc.c ****   osalDbgCheck((adcp != NULL) && (grpp != NULL) && (samples != NULL) &&
 751               		.loc 1 180 23 view .LVU226
 181:../../../os/hal/src/hal_adc.c ****                (depth > 0U) && ((depth == 1U) || ((depth & 1U) == 0U)));
 752               		.loc 1 181 3 view .LVU227
 181:../../../os/hal/src/hal_adc.c ****                (depth > 0U) && ((depth == 1U) || ((depth & 1U) == 0U)));
 753               		.loc 1 181 3 view .LVU228
 183:../../../os/hal/src/hal_adc.c ****                 (adcp->state == ADC_COMPLETE) ||
 754               		.loc 1 183 3 view .LVU229
 183:../../../os/hal/src/hal_adc.c ****                 (adcp->state == ADC_COMPLETE) ||
 755               		.loc 1 183 3 view .LVU230
 188:../../../os/hal/src/hal_adc.c ****   adcp->depth    = depth;
 756               		.loc 1 188 3 view .LVU231
 188:../../../os/hal/src/hal_adc.c ****   adcp->depth    = depth;
 757               		.loc 1 188 18 is_stmt 0 view .LVU232
 758 0008 5C83      		std Y+4,r21
 759 000a 4B83      		std Y+3,r20
 189:../../../os/hal/src/hal_adc.c ****   adcp->grpp     = grpp;
 760               		.loc 1 189 3 is_stmt 1 view .LVU233
 189:../../../os/hal/src/hal_adc.c ****   adcp->grpp     = grpp;
 761               		.loc 1 189 18 is_stmt 0 view .LVU234
 762 000c 3E83      		std Y+6,r19
 763 000e 2D83      		std Y+5,r18
 190:../../../os/hal/src/hal_adc.c ****   adcp->state    = ADC_ACTIVE;
 764               		.loc 1 190 3 is_stmt 1 view .LVU235
 190:../../../os/hal/src/hal_adc.c ****   adcp->state    = ADC_ACTIVE;
 765               		.loc 1 190 18 is_stmt 0 view .LVU236
 766 0010 7887      		std Y+8,r23
 767 0012 6F83      		std Y+7,r22
 191:../../../os/hal/src/hal_adc.c ****   adc_lld_start_conversion(adcp);
 768               		.loc 1 191 3 is_stmt 1 view .LVU237
 191:../../../os/hal/src/hal_adc.c ****   adc_lld_start_conversion(adcp);
 769               		.loc 1 191 18 is_stmt 0 view .LVU238
 770 0014 83E0      		ldi r24,lo8(3)
 771               	.LVL37:
 191:../../../os/hal/src/hal_adc.c ****   adc_lld_start_conversion(adcp);
 772               		.loc 1 191 18 view .LVU239
 773 0016 8883      		st Y,r24
 192:../../../os/hal/src/hal_adc.c **** }
 774               		.loc 1 192 3 is_stmt 1 view .LVU240
 775 0018 CE01      		movw r24,r28
 776 001a 0E94 0000 		call adc_lld_start_conversion
 777               	.LVL38:
 192:../../../os/hal/src/hal_adc.c **** }
 778               		.loc 1 192 3 is_stmt 0 view .LVU241
 779               	.LBE155:
 780               	.LBE154:
 281:../../../os/hal/src/hal_adc.c ****   msg = osalThreadSuspendS(&adcp->thread);
 781               		.loc 1 281 3 is_stmt 1 view .LVU242
 782               	.LBB156:
 783               	.LBI156:
 733:../../../os/hal/osal/rt/osal.h **** 
 784               		.loc 2 733 21 view .LVU243
 785               	.LBB157:
 735:../../../os/hal/osal/rt/osal.h **** }
 786               		.loc 2 735 3 view .LVU244
 735:../../../os/hal/osal/rt/osal.h **** }
 787               		.loc 2 735 10 is_stmt 0 view .LVU245
 788 001e 6FEF      		ldi r22,lo8(-1)
 789 0020 7FEF      		ldi r23,lo8(-1)
 790 0022 CE01      		movw r24,r28
 791 0024 0996      		adiw r24,9
 792               	.LVL39:
 735:../../../os/hal/osal/rt/osal.h **** }
 793               		.loc 2 735 10 view .LVU246
 794 0026 0E94 0000 		call chThdSuspendTimeoutS
 795               	.LVL40:
 735:../../../os/hal/osal/rt/osal.h **** }
 796               		.loc 2 735 10 view .LVU247
 797               	.LBE157:
 798               	.LBE156:
 282:../../../os/hal/src/hal_adc.c ****   osalSysUnlock();
 799               		.loc 1 282 3 is_stmt 1 view .LVU248
 800               	.LBB158:
 801               	.LBI158:
 520:../../../os/hal/osal/rt/osal.h **** 
 802               		.loc 2 520 20 view .LVU249
 803               	.LBE158:
 522:../../../os/hal/osal/rt/osal.h **** }
 804               		.loc 2 522 3 view .LVU250
 805               	.LBB163:
 806               	.LBB159:
 807               	.LBI159:
 365:../../../os/rt/include/chsys.h **** 
 808               		.loc 3 365 20 view .LVU251
 809               	.LBB160:
 367:../../../os/rt/include/chsys.h ****   _stats_stop_measure_crit_thd();
 810               		.loc 3 367 22 view .LVU252
 368:../../../os/rt/include/chsys.h **** 
 811               		.loc 3 368 33 view .LVU253
 374:../../../os/rt/include/chsys.h ****               (ch.rlist.current->prio >= ch.rlist.queue.next->prio),
 812               		.loc 3 374 3 view .LVU254
 374:../../../os/rt/include/chsys.h ****               (ch.rlist.current->prio >= ch.rlist.queue.next->prio),
 813               		.loc 3 374 3 view .LVU255
 814               		.loc 3 378 3 view .LVU256
 815               	.LBB161:
 816               	.LBI161:
 445:../../../os/common/ports/AVR/chcore.h **** 
 817               		.loc 4 445 20 view .LVU257
 818               	.LBB162:
 819               		.loc 4 447 3 view .LVU258
 820               	/* #APP */
 821               	 ;  447 "../../../os/common/ports/AVR/chcore.h" 1
 822 002a 7894      		sei
 823               	 ;  0 "" 2
 824               	/* #NOAPP */
 825               	.LBE162:
 826               	.LBE161:
 827               	.LBE160:
 828               	.LBE159:
 829               	.LBE163:
 283:../../../os/hal/src/hal_adc.c ****   return msg;
 830               		.loc 1 283 3 view .LVU259
 831               	/* epilogue start */
 284:../../../os/hal/src/hal_adc.c **** }
 832               		.loc 1 284 1 is_stmt 0 view .LVU260
 833 002c DF91      		pop r29
 834 002e CF91      		pop r28
 835               	.LVL41:
 836               		.loc 1 284 1 view .LVU261
 837 0030 0895      		ret
 838               		.cfi_endproc
 839               	.LFE181:
 841               		.section	.text.adcAcquireBus,"ax",@progbits
 842               	.global	adcAcquireBus
 844               	adcAcquireBus:
 845               	.LVL42:
 846               	.LFB182:
 285:../../../os/hal/src/hal_adc.c **** #endif /* ADC_USE_WAIT == TRUE */
 286:../../../os/hal/src/hal_adc.c **** 
 287:../../../os/hal/src/hal_adc.c **** #if (ADC_USE_MUTUAL_EXCLUSION == TRUE) || defined(__DOXYGEN__)
 288:../../../os/hal/src/hal_adc.c **** /**
 289:../../../os/hal/src/hal_adc.c ****  * @brief   Gains exclusive access to the ADC peripheral.
 290:../../../os/hal/src/hal_adc.c ****  * @details This function tries to gain ownership to the ADC bus, if the bus
 291:../../../os/hal/src/hal_adc.c ****  *          is already being used then the invoking thread is queued.
 292:../../../os/hal/src/hal_adc.c ****  * @pre     In order to use this function the option
 293:../../../os/hal/src/hal_adc.c ****  *          @p ADC_USE_MUTUAL_EXCLUSION must be enabled.
 294:../../../os/hal/src/hal_adc.c ****  *
 295:../../../os/hal/src/hal_adc.c ****  * @param[in] adcp      pointer to the @p ADCDriver object
 296:../../../os/hal/src/hal_adc.c ****  *
 297:../../../os/hal/src/hal_adc.c ****  * @api
 298:../../../os/hal/src/hal_adc.c ****  */
 299:../../../os/hal/src/hal_adc.c **** void adcAcquireBus(ADCDriver *adcp) {
 847               		.loc 1 299 37 is_stmt 1 view -0
 848               		.cfi_startproc
 849               	/* prologue: function */
 850               	/* frame size = 0 */
 851               	/* stack size = 0 */
 852               	.L__stack_usage = 0
 300:../../../os/hal/src/hal_adc.c **** 
 301:../../../os/hal/src/hal_adc.c ****   osalDbgCheck(adcp != NULL);
 853               		.loc 1 301 3 view .LVU263
 854               		.loc 1 301 3 view .LVU264
 302:../../../os/hal/src/hal_adc.c **** 
 303:../../../os/hal/src/hal_adc.c ****   osalMutexLock(&adcp->mutex);
 855               		.loc 1 303 3 view .LVU265
 856               	.LBB164:
 857               	.LBI164:
 975:../../../os/hal/osal/rt/osal.h **** #elif CH_CFG_USE_SEMAPHORES
 976:../../../os/hal/osal/rt/osal.h ****   chSemObjectInit((semaphore_t *)mp, 1);
 977:../../../os/hal/osal/rt/osal.h **** #else
 978:../../../os/hal/osal/rt/osal.h ****  *mp = 0;
 979:../../../os/hal/osal/rt/osal.h **** #endif
 980:../../../os/hal/osal/rt/osal.h **** }
 981:../../../os/hal/osal/rt/osal.h **** 
 982:../../../os/hal/osal/rt/osal.h **** /**
 983:../../../os/hal/osal/rt/osal.h ****  * @brief   Locks the specified mutex.
 984:../../../os/hal/osal/rt/osal.h ****  * @post    The mutex is locked and inserted in the per-thread stack of owned
 985:../../../os/hal/osal/rt/osal.h ****  *          mutexes.
 986:../../../os/hal/osal/rt/osal.h ****  *
 987:../../../os/hal/osal/rt/osal.h ****  * @param[in,out] mp    pointer to the @p mutex_t object
 988:../../../os/hal/osal/rt/osal.h ****  *
 989:../../../os/hal/osal/rt/osal.h ****  * @api
 990:../../../os/hal/osal/rt/osal.h ****  */
 991:../../../os/hal/osal/rt/osal.h **** static inline void osalMutexLock(mutex_t *mp) {
 858               		.loc 2 991 20 view .LVU266
 859               	.LBB165:
 992:../../../os/hal/osal/rt/osal.h **** 
 993:../../../os/hal/osal/rt/osal.h **** #if CH_CFG_USE_MUTEXES
 994:../../../os/hal/osal/rt/osal.h ****   chMtxLock(mp);
 860               		.loc 2 994 3 view .LVU267
 861 0000 0B96      		adiw r24,11
 862               	.LVL43:
 863               		.loc 2 994 3 is_stmt 0 view .LVU268
 864 0002 0C94 0000 		jmp chMtxLock
 865               	.LVL44:
 866               		.loc 2 994 3 view .LVU269
 867               	.LBE165:
 868               	.LBE164:
 869               		.cfi_endproc
 870               	.LFE182:
 872               		.section	.text.adcReleaseBus,"ax",@progbits
 873               	.global	adcReleaseBus
 875               	adcReleaseBus:
 876               	.LVL45:
 877               	.LFB183:
 304:../../../os/hal/src/hal_adc.c **** }
 305:../../../os/hal/src/hal_adc.c **** 
 306:../../../os/hal/src/hal_adc.c **** /**
 307:../../../os/hal/src/hal_adc.c ****  * @brief   Releases exclusive access to the ADC peripheral.
 308:../../../os/hal/src/hal_adc.c ****  * @pre     In order to use this function the option
 309:../../../os/hal/src/hal_adc.c ****  *          @p ADC_USE_MUTUAL_EXCLUSION must be enabled.
 310:../../../os/hal/src/hal_adc.c ****  *
 311:../../../os/hal/src/hal_adc.c ****  * @param[in] adcp      pointer to the @p ADCDriver object
 312:../../../os/hal/src/hal_adc.c ****  *
 313:../../../os/hal/src/hal_adc.c ****  * @api
 314:../../../os/hal/src/hal_adc.c ****  */
 315:../../../os/hal/src/hal_adc.c **** void adcReleaseBus(ADCDriver *adcp) {
 878               		.loc 1 315 37 is_stmt 1 view -0
 879               		.cfi_startproc
 880               	/* prologue: function */
 881               	/* frame size = 0 */
 882               	/* stack size = 0 */
 883               	.L__stack_usage = 0
 316:../../../os/hal/src/hal_adc.c **** 
 317:../../../os/hal/src/hal_adc.c ****   osalDbgCheck(adcp != NULL);
 884               		.loc 1 317 3 view .LVU271
 885               		.loc 1 317 3 view .LVU272
 318:../../../os/hal/src/hal_adc.c **** 
 319:../../../os/hal/src/hal_adc.c ****   osalMutexUnlock(&adcp->mutex);
 886               		.loc 1 319 3 view .LVU273
 887               	.LBB166:
 888               	.LBI166:
 995:../../../os/hal/osal/rt/osal.h **** #elif CH_CFG_USE_SEMAPHORES
 996:../../../os/hal/osal/rt/osal.h ****   chSemWait((semaphore_t *)mp);
 997:../../../os/hal/osal/rt/osal.h **** #else
 998:../../../os/hal/osal/rt/osal.h ****   *mp = 1;
 999:../../../os/hal/osal/rt/osal.h **** #endif
1000:../../../os/hal/osal/rt/osal.h **** }
1001:../../../os/hal/osal/rt/osal.h **** 
1002:../../../os/hal/osal/rt/osal.h **** /**
1003:../../../os/hal/osal/rt/osal.h ****  * @brief   Unlocks the specified mutex.
1004:../../../os/hal/osal/rt/osal.h ****  * @note    The HAL guarantees to release mutex in reverse lock order. The
1005:../../../os/hal/osal/rt/osal.h ****  *          mutex being unlocked is guaranteed to be the last locked mutex
1006:../../../os/hal/osal/rt/osal.h ****  *          by the invoking thread.
1007:../../../os/hal/osal/rt/osal.h ****  *          The implementation can rely on this behavior and eventually
1008:../../../os/hal/osal/rt/osal.h ****  *          ignore the @p mp parameter which is supplied in order to support
1009:../../../os/hal/osal/rt/osal.h ****  *          those OSes not supporting a stack of the owned mutexes.
1010:../../../os/hal/osal/rt/osal.h ****  *
1011:../../../os/hal/osal/rt/osal.h ****  * @param[in,out] mp    pointer to the @p mutex_t object
1012:../../../os/hal/osal/rt/osal.h ****  *
1013:../../../os/hal/osal/rt/osal.h ****  * @api
1014:../../../os/hal/osal/rt/osal.h ****  */
1015:../../../os/hal/osal/rt/osal.h **** static inline void osalMutexUnlock(mutex_t *mp) {
 889               		.loc 2 1015 20 view .LVU274
 890               	.LBB167:
1016:../../../os/hal/osal/rt/osal.h **** 
1017:../../../os/hal/osal/rt/osal.h **** #if CH_CFG_USE_MUTEXES
1018:../../../os/hal/osal/rt/osal.h ****   chMtxUnlock(mp);
 891               		.loc 2 1018 3 view .LVU275
 892 0000 0B96      		adiw r24,11
 893               	.LVL46:
 894               		.loc 2 1018 3 is_stmt 0 view .LVU276
 895 0002 0C94 0000 		jmp chMtxUnlock
 896               	.LVL47:
 897               		.loc 2 1018 3 view .LVU277
 898               	.LBE167:
 899               	.LBE166:
 900               		.cfi_endproc
 901               	.LFE183:
 903               		.text
 904               	.Letext0:
 905               		.file 5 "/usr/local/Cellar/avr-gcc/8.2.0/lib/avr-gcc/8/gcc/avr/8.2.0/include/stddef.h"
 906               		.file 6 "/usr/local/Cellar/avr-gcc/8.2.0/avr/include/stdint.h"
 907               		.file 7 "../../../os/common/ports/AVR/compilers/GCC/chtypes.h"
 908               		.file 8 "../../../os/rt/include/chsystypes.h"
 909               		.file 9 "../../../os/rt/include/chschd.h"
 910               		.file 10 "../../../os/rt/include/chtime.h"
 911               		.file 11 "../../../os/rt/include/chsem.h"
 912               		.file 12 "../../../os/rt/include/chmtx.h"
 913               		.file 13 "../../../os/rt/include/chregistry.h"
 914               		.file 14 "../../../os/rt/include/chevents.h"
 915               		.file 15 "../../../os/common/oslib/include/chmemcore.h"
 916               		.file 16 "../../../os/hal/include/hal_queues.h"
 917               		.file 17 "../../../os/hal/include/hal_pal.h"
 918               		.file 18 "../../../os/hal/ports/AVR/MEGA/LLD/GPIOv1/hal_pal_lld.h"
 919               		.file 19 "../../../os/hal/include/hal_adc.h"
 920               		.file 20 "../../../os/hal/ports/AVR/MEGA/LLD/ADCv1/hal_adc_lld.h"
 921               		.file 21 "../../../os/hal/include/hal_serial.h"
 922               		.file 22 "../../../os/hal/ports/AVR/MEGA/LLD/USARTv1/hal_serial_lld.h"
 923               		.file 23 "../../../os/rt/include/chthreads.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 hal_adc.c
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:2      *ABS*:000000000000003e __SP_H__
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:3      *ABS*:000000000000003d __SP_L__
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:4      *ABS*:000000000000003f __SREG__
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:5      *ABS*:0000000000000000 __tmp_reg__
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:6      *ABS*:0000000000000001 __zero_reg__
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:13     .text.adcInit:0000000000000000 adcInit
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:31     .text.adcObjectInit:0000000000000000 adcObjectInit
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:91     .text.adcStart:0000000000000000 adcStart
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:202    .text.adcStop:0000000000000000 adcStop
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:311    .text.adcStartConversion:0000000000000000 adcStartConversion
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:427    .text.adcStartConversionI:0000000000000000 adcStartConversionI
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:470    .text.adcStopConversion:0000000000000000 adcStopConversion
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:606    .text.adcStopConversionI:0000000000000000 adcStopConversionI
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:692    .text.adcConvert:0000000000000000 adcConvert
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:844    .text.adcAcquireBus:0000000000000000 adcAcquireBus
/var/folders/sg/tltzpcsx3k34y_dkw5w40_s40000gn/T//cccRGNLS.s:875    .text.adcReleaseBus:0000000000000000 adcReleaseBus

UNDEFINED SYMBOLS
adc_lld_init
chMtxObjectInit
adc_lld_start
adc_lld_stop
adc_lld_start_conversion
adc_lld_stop_conversion
chThdResumeS
chThdResumeI
chThdSuspendTimeoutS
chMtxLock
chMtxUnlock
